<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="../_static/favicon-32x32.png" sizes="32x32" rel="icon" type="image/png"><link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="Pulling on a carbon nanotube" href="../tutorial2/breaking-a-carbon-nanotube.html"><link rel="prev" title="Contact" href="../non-tutorials/contact.html">
        <link rel="prefetch" href="../_static/logo.png" as="image">

    <!-- Generated with Sphinx 7.4.7 and Furo 2025.09.25 -->
        <title>Lennard-Jones fluid - </title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=b1e702db" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">    </div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">    </span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../non-tutorials/scope.html">Scope</a></li>
<li class="toctree-l1"><a class="reference internal" href="../non-tutorials/prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../non-tutorials/contact.html">Contact</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Lennard-Jones fluid</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial2/breaking-a-carbon-nanotube.html">Pulling on a carbon nanotube</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial3/polymer-in-water.html">Polymer in water</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial4/nanosheared-electrolyte.html">Nanosheared electrolyte</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial5/reactive-silicon-dioxide.html">Reactive silicon dioxide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial6/water-adsorption-in-silica.html">Water adsorption in silica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial7/free-energy-calculation.html">Free energy calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial8/reactive-molecular-dynamics.html">Reactive Molecular Dynamics</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extra content</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../non-tutorials/solutions.html">Solutions to the exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../non-tutorials/glossary.html">LAMMPS Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../non-tutorials/bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../non-tutorials/using-lammps-gui.html">Using LAMMPS–GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../non-tutorials/running-lammps.html">Running LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../non-tutorials/command-line.html">Command line</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/tutorial1/lennard-jones-fluid.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="lennard-jones-fluid">
<span id="lennard-jones-label"></span><h1>Lennard-Jones fluid<a class="headerlink" href="#lennard-jones-fluid" title="Link to this heading">¶</a></h1>
<div class="hatnote docutils container">
<p>The very basics of LAMMPS through a simple example</p>
</div>
<figure class="align-right">
<a class="only-dark reference internal image-reference" href="../_images/lennard-jones-fluid-avatar-dark.webp"><img alt="The binary mixture simulated during Tutorial 1. The atoms of type 1 are represented as small green spheres and the atoms of type 2 as large blue spheres." class="only-dark" src="../_images/lennard-jones-fluid-avatar-dark.webp" style="height: 220px;" />
</a>
</figure>
<figure class="align-right">
<a class="only-light reference internal image-reference" href="../_images/lennard-jones-fluid-avatar-light.webp"><img alt="The binary mixture simulated during Tutorial 1. The atoms of type 1 are represented as small green spheres and the atoms of type 2 as large blue spheres." class="only-light" src="../_images/lennard-jones-fluid-avatar-light.webp" style="height: 220px;" />
</a>
</figure>
<p>The objective of this tutorial is to perform simple MD simulations
using LAMMPS.  The system consists of a Lennard-Jones fluid composed of
neutral particles with two different effective diameters, contained
within a cubic box with periodic boundary conditions.  In this tutorial, basic MD simulations in
the microcanonical (NVE) and canonical (NVT) ensembles are performed,
and basic quantities are calculated, including the potential and kinetic
energies.</p>
<div class="version docutils container">
<p>This tutorial is compatible with the 22Jul2025 LAMMPS version.</p>
</div>
<div class="non-title-info admonition">
<p class="admonition-title">Cite</p>
<p>If you find these tutorials useful, you can
cite <em>A Set of Tutorials for the LAMMPS Simulation Package [Article v1.0]</em>
by Simon Gravelle, Cecilia M. S. Alvares, Jacob R. Gissinger, and Axel Kohlmeyer,
published in <em>LiveCoMS</em>, 6(1), 3037 (2025) <span id="id1">[<a class="reference internal" href="../non-tutorials/bibliography.html#id67" title="Simon Gravelle, Cecilia M. S. Alvares, Jacob R. Gissinger, and Axel Kohlmeyer. A set of tutorials for the LAMMPS simulation package [article v1.0]. Living Journal of Computational Molecular Science (LiveCoMS), 6(1):3037, 2025. doi:10.33011/livecoms.6.1.3037.">14</a>]</span>.</p>
</div>
<section id="my-first-input">
<h2>My first input<a class="headerlink" href="#my-first-input" title="Link to this heading">¶</a></h2>
<p>To run a simulation using LAMMPS, you need to write an input script
containing a series of commands for LAMMPS to execute, similar to Python
or Bash scripts.  For clarity, the input scripts for this tutorial will
be divided into five categories, which will be filled out step by step.
To set up this tutorial using LAMMPS graphical user interface
(LAMMPS–GUI), select <code class="docutils literal notranslate"><span class="pre">Start</span> <span class="pre">LAMMPS</span> <span class="pre">Tutorial</span> <span class="pre">1</span></code>
from the <code class="docutils literal notranslate"><span class="pre">Tutorials</span></code> menu and follow the instructions. This will
select (or create, if needed) a folder, place the initial input
file <strong>initial.lmp</strong> in it, and open the file in the LAMMPS–GUI Editor window:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># PART A - ENERGY MINIMIZATION</span>
<span class="c"># 1) Initialization</span>
<span class="c"># 2) System definition</span>
<span class="c"># 3) Settings</span>
<span class="c"># 4) Monitoring</span>
<span class="c"># 5) Run</span>
</pre></div>
</div>
<div class="gui admonition">
<p class="admonition-title">If you are not using LAMMPS-GUI</p>
<p>All tutorials can be followed without using LAMMPS-GUI. To
do so, create a new folder and add a file named <strong>initial.lmp</strong>
inside it. Open the file in a text editor of your choice and
copy the previous lines into it.</p>
</div>
<p>Everything that appears after a hash symbol (#) is a comment
and ignored by LAMMPS. These five categories are not required in every input script an do not
necessarily need to be in that exact order.  For instance, the <code class="docutils literal notranslate"><span class="pre">Settings</span></code>
and the <code class="docutils literal notranslate"><span class="pre">Monitoring</span></code> categories could be inverted, or
the <code class="docutils literal notranslate"><span class="pre">Monitoring</span></code> category could be omitted.  However, note that
LAMMPS reads input files from top to bottom and processes each command
<em>immediately</em>.  Therefore, the <code class="docutils literal notranslate"><span class="pre">Initialization</span></code> and
<code class="docutils literal notranslate"><span class="pre">System</span> <span class="pre">definition</span></code> categories must appear at the top of the
input, and the <code class="docutils literal notranslate"><span class="pre">Run</span></code> category must appear at the bottom.  Also, the
specifics of some commands can change after global settings are modified, so the
order of commands in the input script is important.</p>
<section id="initialization">
<h3>Initialization<a class="headerlink" href="#initialization" title="Link to this heading">¶</a></h3>
<p>In the first section of the script, called <code class="docutils literal notranslate"><span class="pre">Initialization</span></code>,
global parameters for the simulation are defined, such as units, boundary conditions
(e.g., periodic or non-periodic), and atom types (e.g., uncharged point particles
or extended spheres with a radius and angular velocities). These commands must be
executed <em>before</em> creating the simulation box or they will cause
an error. Similarly, many LAMMPS commands may only be
entered <em>after</em> the simulation box is defined. Only a limited
number of commands may be used in both cases. Update the <strong>initial.lmp</strong> file
so that the <code class="docutils literal notranslate"><span class="pre">Initialization</span></code> section appears as follows:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># 1) Initialization</span>
<span class="k">units</span><span class="w"> </span><span class="n">lj</span>
<span class="k">dimension</span><span class="w"> </span><span class="m">3</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">atomic</span>
<span class="k">boundary</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span>
</pre></div>
</div>
<div class="non-title-info admonition">
<p class="admonition-title">Note</p>
<p>Strictly speaking, none of the four commands specified in the
<code class="docutils literal notranslate"><span class="pre">Initialization</span></code> section are mandatory, as they correspond to the
default settings for their respective global properties.  However,
explicitly specifying these defaults is considered good practice to
avoid confusion when sharing input files with other LAMMPS users.</p>
</div>
<p>The first line, <code class="docutils literal notranslate"><span class="pre">units</span> <span class="pre">lj</span></code>, specifies the use of <em>reduced</em>
units, where all quantities are dimensionless.  This unit system is a
popular choice for simulations that explore general statistical
mechanical principles, as it emphasizes relative differences between
parameters rather than representing any specific material.  The second
line, <code class="docutils literal notranslate"><span class="pre">dimension</span> <span class="pre">3</span></code>, specifies that the simulation is conducted
in 3D space, as opposed to 2D, where atoms are confined to move only in
the xy-plane.  The third line, <code class="docutils literal notranslate"><span class="pre">atom_style</span> <span class="pre">atomic</span></code>, designates
the atomic style for representing simple, individual point particles.
In this style, each particle is treated as a point with a mass, making
it the most basic atom style.  Other atom styles can incorporate
additional attributes for atoms, such as charges, bonds, or molecule
IDs, depending on the requirements of the simulated model.  The last
line, <code class="docutils literal notranslate"><span class="pre">boundary</span> <span class="pre">p</span> <span class="pre">p</span> <span class="pre">p</span></code>, indicates that periodic boundary
conditions are applied along all three directions of space, where the
three p stand for <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span>, respectively.
Alternatives are fixed non-periodic (f), shrink-wrapped non-periodic (s), and
shrink-wrapped non-periodic with minimum (m).  For non-periodic
boundaries, different options can be assigned to each dimension, making
configurations like <code class="docutils literal notranslate"><span class="pre">boundary</span> <span class="pre">p</span> <span class="pre">p</span> <span class="pre">fm</span></code> valid for systems such as
slab geometries.</p>
<div class="non-title-info admonition">
<p class="admonition-title">Note</p>
<p>Each LAMMPS command is accompanied by extensive online <a href="https://docs.lammps.org" target="_blank">documentation</a>
that lists and discusses the different options for that command.
Most LAMMPS commands also have default settings that are applied if no
value is explicitly specified. The defaults for each com-
mand are listed at the bottom of its documentation page.
From the LAMMPS–GUI editor buffer, you can access the documentation by
right-clicking on a line containing a command (e.g., <code class="docutils literal notranslate"><span class="pre">units</span> <span class="pre">lj</span></code>)
and selecting <code class="docutils literal notranslate"><span class="pre">View</span> <span class="pre">Documentation</span> <span class="pre">for</span> <span class="pre">`units'</span></code>.  This action
should prompt your web browser to open the corresponding URL for the
online manual.</p>
</div>
<div class="non-title-info admonition">
<p class="admonition-title">Note</p>
<p>Most LAMMPS commands have default settings that are applied if no value
is explicitly specified.  The defaults for each command are listed at the
bottom of its documentation page.</p>
</div>
</section>
<section id="system-definition">
<h3>System definition<a class="headerlink" href="#system-definition" title="Link to this heading">¶</a></h3>
<p>The next step is to create the simulation box and populate it with
atoms.  Modify the <code class="docutils literal notranslate"><span class="pre">System</span> <span class="pre">definition</span></code> category of
<strong>initial.lmp</strong> as shown below:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># 2) System definition</span>
<span class="k">region </span><span class="nv nv-Identifier">simbox</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="o">-</span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="o">-</span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="o">-</span><span class="m">20</span><span class="w"> </span><span class="m">20</span>
<span class="k">create_box </span><span class="nv nv-Identifier">2</span><span class="w"> </span><span class="nv nv-Identifier">simbox</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">1500</span><span class="w"> </span><span class="m">34134</span><span class="w"> </span><span class="n">simbox</span><span class="w"> </span><span class="n">overlap</span><span class="w"> </span><span class="m">0.3</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">12756</span><span class="w"> </span><span class="n">simbox</span><span class="w"> </span><span class="n">overlap</span><span class="w"> </span><span class="m">0.3</span>
</pre></div>
</div>
<p>The first line, <code class="docutils literal notranslate"><span class="pre">region</span> <span class="pre">simbox</span> <span class="pre">(...)</span></code>, defines a region named
<code class="docutils literal notranslate"><span class="pre">simbox</span></code> that is a block (i.e., a rectangular cuboid) extending
from -20 to 20 units along all three spatial dimensions.  The second
line, <code class="docutils literal notranslate"><span class="pre">create_box</span> <span class="pre">2</span> <span class="pre">simbox</span></code>, initializes a simulation box based
on the region <code class="docutils literal notranslate"><span class="pre">simbox</span></code> and reserves space for two types of atoms.
In LAMMPS, every atom is assigned an atom type property. This property selects which force
field parameters (here, the Lennard-Jones parameters, <span class="math notranslate nohighlight">\(\epsilon_{ij}\)</span>
and  <span class="math notranslate nohighlight">\(\sigma_{ij}\)</span>) are applied to each pair of atoms via the pair_coeff
command (see below). We discuss in <a class="reference internal" href="../tutorial2/breaking-a-carbon-nanotube.html#carbon-nanotube-label"><span class="std std-ref">Pulling on a carbon nanotube</span></a> how this applies to
many-body pair styles, and in <a class="reference internal" href="../tutorial3/polymer-in-water.html#all-atoms-label"><span class="std std-ref">Polymer in water</span></a> how this applies to
Coulomb interactions.</p>
<div class="non-title-info admonition">
<p class="admonition-title">Note</p>
<p>From this point on, the number of atom types is <em>locked
in</em>, and any command referencing an atom type larger than 2
will trigger an error.  While it is possible to allocate more atom
types than needed, you must assign a mass and provide force field
parameters for each atom type.  Failing to do so will cause LAMMPS to
terminate with an error.</p>
</div>
<p>The third line, <code class="docutils literal notranslate"><span class="pre">create_atoms</span> <span class="pre">(...)</span></code>, generates 1500 atoms of
type 1 at random positions within the <code class="docutils literal notranslate"><span class="pre">simbox</span></code> region.
The integer 34134 is a seed for the internal random number generator, which
can be changed to produce different sequences of random numbers and,
consequently, different initial atom positions.  The fourth line adds
100 atoms of type 2.  Both <code class="docutils literal notranslate"><span class="pre">create_atoms</span></code> commands use the
optional argument <code class="docutils literal notranslate"><span class="pre">overlap</span> <span class="pre">0.3</span></code>, which enforces a minimum
distance of 0.3 length units between the randomly placed atoms.  This
constraint helps avoid close contacts between atoms, which can lead
to excessively large forces and simulation instability.
Each created atom in LAMMPS is automatically
assigned a unique atom ID, which serves as a numerical
identifier to distinguish individual atoms throughout the
simulation. Atom IDs by default have the range from 1 to
the total number of atoms, but this is not enforced.Deleting atoms, for example,
causes <em>holes</em> in the list of atom IDs.</p>
<div class="non-title-info admonition">
<p class="admonition-title">Note</p>
<p>Another way to define a system in LAMMPS, besides the
<code class="docutils literal notranslate"><span class="pre">create_atoms</span></code> commands, is to import an existing topology
file containing atomic coordinates as well as, optionally, other
attributes such as atomic velocities and the force field parameters
using the <code class="docutils literal notranslate"><span class="pre">read_data</span></code> command, as shown in <a class="reference internal" href="../tutorial2/breaking-a-carbon-nanotube.html#carbon-nanotube-label"><span class="std std-ref">Pulling on a carbon nanotube</span></a>.</p>
</div>
<div class="patreon admonition">
<p class="admonition-title">Looking for help with your project ?</p>
<p>Get guidance for your LAMMPS simulations and receive
personalized <a href="https://www.patreon.com/molecularsimulations" target="_blank">advice</a> for your project.</p>
</div>
</section>
<section id="settings">
<h3>Settings<a class="headerlink" href="#settings" title="Link to this heading">¶</a></h3>
<p>Next, we specify the settings for the two atom types.  Modify the
<code class="docutils literal notranslate"><span class="pre">Settings</span></code> category of <strong>initial.lmp</strong> as follows:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># 3) Settings</span>
<span class="k">mass</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">mass</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5.0</span>
<span class="k">pair_style</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="w"> </span><span class="m">4.0</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0.5</span><span class="w"> </span><span class="m">3.0</span>
</pre></div>
</div>
<p>The two <code class="docutils literal notranslate"><span class="pre">mass</span></code> commands assign a mass of 1.0 and 5.0 units to the
atoms of type 1 and 2, respectively.  The third line,
<code class="docutils literal notranslate"><span class="pre">pair_style</span> <span class="pre">lj/cut</span> <span class="pre">4.0</span></code>, specifies that the atoms will be
interacting through a Lennard-Jones (LJ) potential with a cut-off equal
to <span class="math notranslate nohighlight">\(r_c = 4.0\)</span> length units <span id="id2">[<a class="reference internal" href="../non-tutorials/bibliography.html#id36" title="Xipeng Wang, Simón Ramírez-Hinestrosa, Jure Dobnikar, and Daan Frenkel. The lennard-jones potential: when (not) to use it. Physical Chemistry Chemical Physics, 22(19):10624–10633, 2020.">15</a>, <a class="reference internal" href="../non-tutorials/bibliography.html#id34" title="Johann Fischer and Martin Wendland. On the history of key empirical intermolecular potentials. Fluid Phase Equilibria, 573:113876, 2023.">16</a>]</span>:</p>
<div class="math-wrapper docutils container" id="equation-eq-lj">
<div class="math notranslate nohighlight" id="equation-eq-lj">
<span class="eqno">(1)<a class="headerlink" href="#equation-eq-lj" title="Link to this equation">¶</a></span>\[E_{ij}(r) = 4 \epsilon_{ij} \left[ \left( \dfrac{\sigma_{ij}}{r} \right)^{12}
- \left( \dfrac{\sigma_{ij}}{r} \right)^{6} \right], \quad \text{for} \quad r &lt; r_c,\]</div>
</div>
<p>where <span class="math notranslate nohighlight">\(r\)</span> is the inter-particle distance, <span class="math notranslate nohighlight">\(\epsilon_{ij}\)</span> is
the depth of the potential well that determines the interaction strength, and
<span class="math notranslate nohighlight">\(\sigma_{ij}\)</span> is the distance at which the potential energy equals zero.
The indices <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span> refer to pairs atoms with the corresponding atom types.
The fourth line, <code class="docutils literal notranslate"><span class="pre">pair_coeff</span> <span class="pre">1</span> <span class="pre">1</span> <span class="pre">1.0</span> <span class="pre">1.0</span></code>, specifies the
Lennard-Jones coefficients for interactions between pairs of atoms
that both have atom type 1: the energy parameter <span class="math notranslate nohighlight">\(\epsilon_{11} = 1.0\)</span> and
the distance parameter <span class="math notranslate nohighlight">\(\sigma_{11} = 1.0\)</span>.  Similarly, the last line
sets the Lennard-Jones coefficients for interactions between atoms
of type 2, <span class="math notranslate nohighlight">\(\epsilon_{22} = 0.5\)</span>, and <span class="math notranslate nohighlight">\(\sigma_{22} = 3.0\)</span>.</p>
<div class="non-title-info admonition">
<p class="admonition-title">Note</p>
<p>By default, LAMMPS calculates the mixed force field coefficients for different
atom types using geometric averages: <span class="math notranslate nohighlight">\(\epsilon_{ij} = \sqrt{\epsilon_{ii} \epsilon_{jj}}\)</span>,
<span class="math notranslate nohighlight">\(\sigma_{ij} = \sqrt{\sigma_{ii} \sigma_{jj}}\)</span>.  In the present case,
<span class="math notranslate nohighlight">\(\epsilon_{12} = \sqrt{1.0 \times 0.5} = 0.707\)</span>, and
<span class="math notranslate nohighlight">\(\sigma_{12} = \sqrt{1.0 \times 3.0} = 1.732\)</span>. Other rules
can be selected using the <code class="docutils literal notranslate"><span class="pre">pair_modify</span></code> command.</p>
</div>
</section>
<section id="single-point-energy">
<h3>Single-point energy<a class="headerlink" href="#single-point-energy" title="Link to this heading">¶</a></h3>
<p>The system is now fully parameterized.  Let us complete the two remaining categories,
<code class="docutils literal notranslate"><span class="pre">Monitoring</span></code> and <code class="docutils literal notranslate"><span class="pre">Run</span></code>, by adding the following lines
to <strong>initial.lmp</strong>:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># 4) Monitoring</span>
<span class="k">thermo</span><span class="w"> </span><span class="m">10</span>
<span class="k">thermo_style</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">etotal</span><span class="w"> </span><span class="n">press</span>
<span class="c"># 5) Run</span>
<span class="k">run</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">post</span><span class="w"> </span><span class="n">no</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">thermo</span> <span class="pre">10</span></code> command instructs LAMMPS to print thermodynamic
information to the console every specified number of steps, in this case,
every 10 simulation steps.  The <code class="docutils literal notranslate"><span class="pre">thermo_style</span> <span class="pre">custom</span></code> command
defines the specific outputs, which in this case are the step number
(<code class="docutils literal notranslate"><span class="pre">step</span></code>), total energy <span class="math notranslate nohighlight">\(E\)</span> (<code class="docutils literal notranslate"><span class="pre">etotal</span></code>), and pressure <span class="math notranslate nohighlight">\(p\)</span> (<code class="docutils literal notranslate"><span class="pre">press</span></code>).
The <code class="docutils literal notranslate"><span class="pre">run</span> <span class="pre">0</span> <span class="pre">post</span> <span class="pre">no</span></code> command instructs LAMMPS to initialize forces and energy
without actually running the simulation.  The <code class="docutils literal notranslate"><span class="pre">post</span> <span class="pre">no</span></code> option disables
the post-run summary and statistics output.</p>
<div class="non-title-info admonition">
<p class="admonition-title">Note</p>
<p>The <em>thermodynamic information</em> printed by LAMMPS
using <code class="docutils literal notranslate"><span class="pre">thermo_style</span> <span class="pre">custom</span></code> keywords refers to instanta-
neous values of the specified thermodynamic properties
at each output step, not cumulative averages. However,
LAMMPS also allows to reference a wide variety of custom data from
compute styles, fix styles, and variables.
These can be used for on-the-fly analysis, including cumulative and sliding-window averages.</p>
</div>
<p>You can now run LAMMPS (basic commands for running LAMMPS
are provided in <a class="reference internal" href="../non-tutorials/running-lammps.html#running-lammps-label"><span class="std std-ref">Running LAMMPS</span></a>).
The simulation should finish quickly.</p>
<p>With the default settings, LAMMPS–GUI will open two windows: one
displaying the console output and another with a chart.  The <code class="docutils literal notranslate"><span class="pre">Output</span></code> window
will display information from the executed commands, including the
total energy and pressure at step 0,
as specified by the thermodynamic data request.  Since no actual simulation
steps were performed, the <code class="docutils literal notranslate"><span class="pre">Charts</span></code> window will be empty.</p>
<p><strong>Snapshot image –</strong> At this point, you can create a snapshot image of the current system
using the <code class="docutils literal notranslate"><span class="pre">Image</span> <span class="pre">Viewer</span></code> window, which can be accessed by
clicking the <code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">Image</span></code> button in the <code class="docutils literal notranslate"><span class="pre">Run</span></code> menu.  The
image viewer works by instructing LAMMPS to render an image of the
current system using its internal rendering library via the <code class="docutils literal notranslate"><span class="pre">dump</span> <span class="pre">image</span></code>
command.  The resulting image is then displayed, with various
buttons available to adjust the view and rendering style.  This will always
capture the current state of the system.</p>
</section>
<section id="energy-minimization">
<h3>Energy minimization<a class="headerlink" href="#energy-minimization" title="Link to this heading">¶</a></h3>
<p>Now, replace the <code class="docutils literal notranslate"><span class="pre">run</span> <span class="pre">0</span> <span class="pre">post</span> <span class="pre">no</span></code> command line with the
following <code class="docutils literal notranslate"><span class="pre">minimize</span></code> command:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># 5) Run</span>
<span class="k">minimize</span><span class="w"> </span><span class="m">1.0e-6</span><span class="w"> </span><span class="m">1.0e-6</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="m">10000</span>
</pre></div>
</div>
<p>This tells LAMMPS to perform an iterative energy minimization of the system.
Specifically, LAMMPS will compute the forces on all atoms and then update their
positions according to a selected algorithm, aiming to reduce
the potential energy.  By default, LAMMPS uses the conjugate gradient (CG)
algorithm <span id="id3">[<a class="reference internal" href="../non-tutorials/bibliography.html#id4" title="Magnus Rudolph Hestenes, Eduard Stiefel, and others. Methods of conjugate gradients for solving linear systems. Volume 49. NBS Washington, DC, 1952.">17</a>]</span>.  The simulation will stop as soon
as one of the four minimizer criteria is met. LAMMPS will then report which stopping criterion
was satisfied, along with selected system properties at both the initial
and final steps.  Note that, except for trivial systems, minimization algorithms will find a
local minimum rather than the global minimum.</p>
<p>Run the minimization and observe that LAMMPS-GUI captures the output
and updates the chart in real time.  This run executes quickly (depending
on your computer’s capabilities), and thus LAMMPS-GUI may fail to capture some
of the thermodynamic data.  In that
case, use the <code class="docutils literal notranslate"><span class="pre">Preferences</span></code> dialog to reduce the data update
interval and switch to single-threaded, unaccelerated execution in the
<code class="docutils literal notranslate"><span class="pre">Accelerators</span></code> tab.  You can repeat the run; each new attempt will start
fresh, resetting the system and re-executing the script from the beginning.</p>
<p>Run the minimization.  The potential energy, <span class="math notranslate nohighlight">\(U\)</span>, decreases
from a positive value to a negative value
(as can also be seen in the figure below).  Note that
during energy minimization, the potential energy equals the total energy
of the system, <span class="math notranslate nohighlight">\(E = U\)</span>, since the kinetic energy, <span class="math notranslate nohighlight">\(K\)</span>, is zero.  The
initially positive potential energy is expected, as the atoms are
created at random positions within the simulation box, with some in very
close proximity to each other.  This proximity results in a large
initial potential energy due to the repulsive branch of the
Lennard-Jones potential [i.e., the term <span class="math notranslate nohighlight">\(1/r^{12}\)</span> in
Eq. <a class="reference internal" href="tutorial.html#equation-eq-lj">(1)</a>].  As the energy minimization progresses, the energy
decreases - first rapidly - then more gradually, before plateauing at a
negative value.  This indicates that the atoms have moved to reasonable
distances from one another.</p>
<p>Create and save a snapshot image of the simulation state after the
minimization, and compare it to the initial image.  You should observe
that the atoms are <em>clumping together</em> as they move toward positions
of lower potential energy.</p>
</section>
<section id="molecular-dynamics">
<h3>Molecular dynamics<a class="headerlink" href="#molecular-dynamics" title="Link to this heading">¶</a></h3>
<p>After energy minimization, any overlapping atoms are displaced, and
the system is ready for a molecular dynamics simulation.  To continue
from the result of the minimization step, append the MD simulation
commands to the same input script, <strong>initial.lmp</strong>.  Add the
following lines immediately after the <code class="docutils literal notranslate"><span class="pre">minimize</span></code> command:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># PART B - MOLECULAR DYNAMICS</span>
<span class="c"># 4) Monitoring</span>
<span class="k">thermo</span><span class="w"> </span><span class="m">50</span>
<span class="k">thermo_style</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">etotal</span><span class="w"> </span><span class="n">pe</span><span class="w"> </span><span class="n">ke</span><span class="w"> </span><span class="n">press</span>
</pre></div>
</div>
<p>Since LAMMPS reads inputs from top to bottom, these lines will
be executed <em>after</em> the energy minimization.  Therefore,
there is no need to re-initialize or re-define the
system.  The <code class="docutils literal notranslate"><span class="pre">thermo</span></code> command is called a second time to
update the output frequency from 10 to 50 as soon as <code class="docutils literal notranslate"><span class="pre">PART</span> <span class="pre">B</span></code> of
the simulation starts.  In addition, a new <code class="docutils literal notranslate"><span class="pre">thermo_style</span></code>
command is introduced to specify the thermodynamic information LAMMPS should
print during <code class="docutils literal notranslate"><span class="pre">PART</span> <span class="pre">B</span></code>.  This adjustment is made because, during
molecular dynamics, the system exhibits a non-zero temperature <span class="math notranslate nohighlight">\(T\)</span> (and
consequently a non-zero kinetic energy <span class="math notranslate nohighlight">\(K\)</span>, keyword <code class="docutils literal notranslate"><span class="pre">ke</span></code>), which are useful to monitor.
The <code class="docutils literal notranslate"><span class="pre">pe</span></code> keyword represents the potential energy of the system, <span class="math notranslate nohighlight">\(U\)</span>, such that
<span class="math notranslate nohighlight">\(U + K = E\)</span>.</p>
<p>Then, add a second <code class="docutils literal notranslate"><span class="pre">Run</span></code> category by including the following
lines in <code class="docutils literal notranslate"><span class="pre">PART</span> <span class="pre">B</span></code> of <strong>initial.lmp</strong>:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># 5) Run</span>
<span class="k">fix </span><span class="nv nv-Identifier">mynve</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nve</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.005</span>
<span class="k">run</span><span class="w"> </span><span class="m">50000</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">fix</span> <span class="pre">nve</span></code> command updates the positions and velocities of the
atoms in the group <code class="docutils literal notranslate"><span class="pre">all</span></code> at every step.  More specifically, this command integrates
Newton’s equations of motion using the velocity-Verlet algorithm.  The group <code class="docutils literal notranslate"><span class="pre">all</span></code>
is a default group that contains all atoms.  The last two lines specify
the value of the <code class="docutils literal notranslate"><span class="pre">timestep</span></code> and the number of steps for the
<code class="docutils literal notranslate"><span class="pre">run</span></code>, respectively, for a total duration of 250 time units.</p>
<div class="non-title-info admonition">
<p class="admonition-title">Note</p>
<p>Since the only command affecting forces and velocities in the
present script is <code class="docutils literal notranslate"><span class="pre">fix</span> <span class="pre">nve</span></code>, and periodic boundary conditions are applied
in all directions, the MD simulation will be performed in the microcanonical (NVE) ensemble, which
maintains a constant number of particles and a fixed box volume. In
this ensemble, the system does not exchange energy with anything
outside the simulation box.</p>
</div>
<p>Run the simulation using LAMMPS.  Initially, the system is
not equilibrated, as the potential energy
decreases while the kinetic energy increases.  After approximately
40000 steps, the values for both kinetic and potential energy
plateau, indicating that the system has reached equilibrium, with
the total energy fluctuating around a certain constant value.</p>
<p>Now, we change the second <code class="docutils literal notranslate"><span class="pre">Run</span></code> section to (note the smaller number of
MD steps):</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># 5) Run</span>
<span class="k">fix </span><span class="nv nv-Identifier">mynve</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nve</span>
<span class="k">fix </span><span class="nv nv-Identifier">mylgv</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">langevin</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="m">10917</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.005</span>
<span class="k">run</span><span class="w"> </span><span class="m">15000</span>
</pre></div>
</div>
<p>The new command adds a Langevin thermostat to the atoms in the group
<code class="docutils literal notranslate"><span class="pre">all</span></code>, with a target temperature of 1.0 temperature units
throughout the run (the two numbers represent the target temperature at
the beginning and at the end of the run, which results in a temperature
ramp if they differ) <span id="id4">[<a class="reference internal" href="../non-tutorials/bibliography.html#id2" title="T Schneider and E Stoll. Molecular-dynamics study of a three-dimensional one-component model for distortive phase transitions. Physical Review B, 17(3):1302, 1978.">18</a>]</span>.  A <code class="docutils literal notranslate"><span class="pre">damping</span></code>
parameter of 0.1 is used.  It determines how rapidly the temperature is
relaxed to its desired value.  In a Langevin thermostat, the atoms are
subject to friction and random noise (in the form of randomly added
velocities).  Since a constant friction term removes more kinetic energy
from fast atoms and less from slow atoms, the system will eventually
reach a dynamic equilibrium where the kinetic energy removed and added
are about the same.  The number 10917 is a seed used to initialize the
random number generator used inside of <code class="docutils literal notranslate"><span class="pre">fix</span> <span class="pre">langevin</span></code>; you can
change it to perform statistically independent simulations.  In the
presence of a thermostat, the MD simulation will be performed in the
canonical or NVT ensemble.</p>
<p>Run the simulation again using LAMMPS.  From the information
printed in the log file, one can see that the temperature
starts from 0 but rapidly reaches the requested value and
stabilizes itself near <span class="math notranslate nohighlight">\(T=1\)</span> temperature units.  One can also observe that
the potential energy, <span class="math notranslate nohighlight">\(U\)</span>, rapidly decreases during energy
minimization (see the figure below).  After
the molecular dynamics simulation starts, <span class="math notranslate nohighlight">\(U\)</span> increases until
it reaches a plateau value of about -0.25.  The kinetic energy,
<span class="math notranslate nohighlight">\(K\)</span>, is equal to zero during energy minimization and then
increases rapidly during molecular dynamics until it reaches
a plateau value of about 1.5.</p>
<div class="non-title-info admonition">
<p class="admonition-title">Note</p>
<p>All simulations presented in these tutorials are deliberately kept
short so they can be executed on a personal computer.  These runs are not intended
to produce statistically meaningful results, and should not be considered suitable
for publication (see for instance Ref. <span id="id5">[<a class="reference internal" href="../non-tutorials/bibliography.html#id3" title="Alan Grossfield and Daniel M Zuckerman. Quantifying uncertainty and sampling quality in biomolecular simulations. Annual Reports in Computational Chemistry, 5:23–48, 2009.">19</a>]</span>).</p>
</div>
<p>From the information
printed in the <code class="docutils literal notranslate"><span class="pre">Output</span></code> window, one can see that the temperature
starts from 0 but rapidly reaches the requested value and
stabilizes itself near <span class="math notranslate nohighlight">\(T=1\)</span> temperature units.  One can also observe that
the potential energy, <span class="math notranslate nohighlight">\(U\)</span>, rapidly decreases during energy
minimization (see the figure below).  After
the molecular dynamics simulation starts, <span class="math notranslate nohighlight">\(U\)</span> increases until
it reaches a plateau value of about -0.25.  The kinetic energy,
<span class="math notranslate nohighlight">\(K\)</span>, is equal to zero during energy minimization and then
increases rapidly during molecular dynamics until it reaches
a plateau value of about 1.5.</p>
<figure class="align-default">
<img alt="Evolution of the Lennard-Jones fluid energy" class="only-dark" src="../_images/LJ-energy-dm.png" />
</figure>
<figure class="align-default">
<img alt="Evolution of the Lennard-Jones fluid energy" class="only-light" src="../_images/LJ-energy.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: (a) Potential energy, <span class="math notranslate nohighlight">\(U\)</span>, of the binary mixture as a function of the
step during energy minimization.
(b) Potential energy, <span class="math notranslate nohighlight">\(U\)</span>, as a function of time, <span class="math notranslate nohighlight">\(t\)</span>, during molecular dynamics in
the NVT ensemble.  (c) Kinetic energy, <span class="math notranslate nohighlight">\(K\)</span>, during energy minimization.
(d) Kinetic energy, <span class="math notranslate nohighlight">\(K\)</span>, during molecular dynamics.</p>
</div>
</section>
<section id="trajectory-visualization">
<h3>Trajectory visualization<a class="headerlink" href="#trajectory-visualization" title="Link to this heading">¶</a></h3>
<p>So far, the simulation has been mostly monitored through the analysis of
thermodynamic information.  To better follow the evolution of the system
and visualize the trajectories of the atoms, let us print the positions
of the atoms in a file at a regular interval.</p>
<p>Add the following command to the <code class="docutils literal notranslate"><span class="pre">Monitoring</span></code> section
of <code class="docutils literal notranslate"><span class="pre">PART</span> <span class="pre">B</span></code> of the <strong>initial.lmp</strong> file:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">dump </span><span class="nv nv-Identifier">mydmp</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="n">dump.lammpstrj</span>
</pre></div>
</div>
<p>Run the <strong>initial.lmp</strong> file using LAMMPS again. A file named <strong>dump.lammpstrj</strong>
must appear alongside <strong>initial.lmp</strong>. The <strong>.lammpstrj</strong> file can be opened
using VMD <span id="id6">[<a class="reference internal" href="../non-tutorials/bibliography.html#id11" title="William Humphrey, Andrew Dalke, and Klaus Schulten. VMD: visual molecular dynamics. Journal of molecular graphics, 14(1):33–38, 1996.">12</a>]</span> or OVITO <span id="id7">[<a class="reference internal" href="../non-tutorials/bibliography.html#id6" title="Alexander Stukowski. Visualization and analysis of atomistic simulation data with ovito–the open visualization tool. Modelling and simulation in materials science and engineering, 18(1):015012, 2009.">13</a>]</span>.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">dump</span> <span class="pre">image</span></code> command to create snapshot images during the simulation.  We
have already explored the <code class="docutils literal notranslate"><span class="pre">Image</span> <span class="pre">Viewer</span></code> window.  Open it again
and adjust the visualization to your liking using the available buttons.
Now you can copy the commands used to create this visualization to the
clipboard by either using the <code class="docutils literal notranslate"><span class="pre">Ctrl-D</span></code> keyboard shortcut or
selecting <code class="docutils literal notranslate"><span class="pre">Copy</span> <span class="pre">dump</span> <span class="pre">image</span> <span class="pre">command</span></code> from the <code class="docutils literal notranslate"><span class="pre">File</span></code> menu.
This text can be pasted into the <code class="docutils literal notranslate"><span class="pre">Monitoring</span></code> section
of <code class="docutils literal notranslate"><span class="pre">PART</span> <span class="pre">B</span></code> of the <strong>initial.lmp</strong> file.  This may look like
the following:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">dump </span><span class="nv nv-Identifier">viz</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="n">myimage</span><span class="o">-*</span><span class="n">.ppm</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="m">800</span><span class="w"> </span><span class="m">800</span><span class="w"> </span><span class="n">zoom</span><span class="w"> </span><span class="m">1.452</span><span class="w"> </span><span class="n">shiny</span><span class="w"> </span><span class="m">0.7</span><span class="w"> </span><span class="n">fsaa</span><span class="w"> </span><span class="n">yes</span><span class="w"> </span><span class="o">&amp;</span>
<span class="w">    </span><span class="n">view</span><span class="w"> </span><span class="m">80</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="n">box</span><span class="w"> </span><span class="n">yes</span><span class="w"> </span><span class="m">0.025</span><span class="w"> </span><span class="n">axes</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="n">center</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="m">0.483725</span><span class="w"> </span><span class="m">0.510373</span><span class="w"> </span><span class="m">0.510373</span>
<span class="k">dump_modify </span><span class="nv nv-Identifier">viz</span><span class="w"> </span><span class="n">pad</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="n">boxcolor</span><span class="w"> </span><span class="n">royalblue</span><span class="w"> </span><span class="n">backcolor</span><span class="w"> </span><span class="n">white</span><span class="w"> </span><span class="n">adiam</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1.6</span><span class="w"> </span><span class="n">adiam</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">4.8</span>
</pre></div>
</div>
<p>The $&amp;$ is used to continue the command on a new line.
These commands tell LAMMPS to generate NetPBM format images every 100
steps.  The two <code class="docutils literal notranslate"><span class="pre">type</span></code> keywords are for <em>color</em> and
<em>diameter</em>, respectively.  Run the <strong>initial.lmp</strong> using
LAMMPS again, and a new window named <code class="docutils literal notranslate"><span class="pre">Slide</span> <span class="pre">Show</span></code> will pop up.
It will show each image created by the <code class="docutils literal notranslate"><span class="pre">dump</span> <span class="pre">image</span></code> as it is
created. After the simulation is finished (or stopped), the slideshow
viewer allows you to animate the trajectory by cycling through the
images.  The window also allows you to export the animation to a movie
(provided the FFMpeg program is installed) and to bulk delete those
image files.</p>
<p>The rendering of the system can be further adjusted using the many
options of the <code class="docutils literal notranslate"><span class="pre">dump</span> <span class="pre">image</span></code> command.  For instance, the value for the
<code class="docutils literal notranslate"><span class="pre">shiny</span></code> keyword is used to adjust the shininess of the atoms, the
<code class="docutils literal notranslate"><span class="pre">box</span></code> keyword adds or removes a representation of the box, and
the <code class="docutils literal notranslate"><span class="pre">view</span></code> and <code class="docutils literal notranslate"><span class="pre">zoom</span></code> keywords adjust the camera (and so on).</p>
</section>
</section>
<section id="improving-the-script">
<h2>Improving the script<a class="headerlink" href="#improving-the-script" title="Link to this heading">¶</a></h2>
<p>Let us improve the input script and perform more advanced operations,
such as specifying initial positions for the atoms and restarting the
simulation from a previously saved configuration.</p>
<section id="control-the-initial-atom-positions">
<h3>Control the initial atom positions<a class="headerlink" href="#control-the-initial-atom-positions" title="Link to this heading">¶</a></h3>
<p>Open the <strong>improved.min.lmp</strong>, which was downloaded during the
tutorial setup.  This file contains the <code class="docutils literal notranslate"><span class="pre">Part</span> <span class="pre">A</span></code> of the
<strong>initial.lmp</strong> file, but <em>without</em> any
commands in the <code class="docutils literal notranslate"><span class="pre">System</span> <span class="pre">definition</span></code> section:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># 1) Initialization</span>
<span class="k">units</span><span class="w"> </span><span class="n">lj</span>
<span class="k">dimension</span><span class="w"> </span><span class="m">3</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">atomic</span>
<span class="k">boundary</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span>
<span class="c"># 2) System definition</span>
<span class="c"># 3) Settings</span>
<span class="k">mass</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">mass</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">10.0</span>
<span class="k">pair_style</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="w"> </span><span class="m">4.0</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0.5</span><span class="w"> </span><span class="m">3.0</span>
<span class="c"># 4) Monitoring</span>
<span class="k">thermo</span><span class="w"> </span><span class="m">10</span>
<span class="k">thermo_style</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">etotal</span><span class="w"> </span><span class="n">press</span>
<span class="c"># 5) Run</span>
<span class="k">minimize</span><span class="w"> </span><span class="m">1.0e-6</span><span class="w"> </span><span class="m">1.0e-6</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="m">10000</span>
</pre></div>
</div>
<p>We want to create the atoms of types 1 and 2 in two separate
regions.  To achieve this, we need to add two <code class="docutils literal notranslate"><span class="pre">region</span></code> commands and then
reintroduce the <code class="docutils literal notranslate"><span class="pre">create_atoms</span></code> commands, this time using the new
regions instead of the simulation box region to place the atoms:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># 2) System definition</span>
<span class="k">region </span><span class="nv nv-Identifier">simbox</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="o">-</span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="o">-</span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="o">-</span><span class="m">20</span><span class="w"> </span><span class="m">20</span>
<span class="k">create_box </span><span class="nv nv-Identifier">2</span><span class="w"> </span><span class="nv nv-Identifier">simbox</span>
<span class="c"># for creating atoms</span>
<span class="k">region </span><span class="nv nv-Identifier">cyl_in</span><span class="w"> </span><span class="n">cylinder</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">in</span>
<span class="k">region </span><span class="nv nv-Identifier">cyl_out</span><span class="w"> </span><span class="n">cylinder</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">out</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="m">34134</span><span class="w"> </span><span class="n">cyl_out</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">150</span><span class="w"> </span><span class="m">12756</span><span class="w"> </span><span class="n">cyl_in</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">side</span> <span class="pre">in</span></code> and <code class="docutils literal notranslate"><span class="pre">side</span> <span class="pre">out</span></code> keywords are used to define
regions representing the inside and outside of the cylinder of radius
10 length units.  Then, append a sixth section titled <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">system</span></code> at the end
of the file, ensuring that the <code class="docutils literal notranslate"><span class="pre">write_data</span></code> command is placed <em>after</em>
the <code class="docutils literal notranslate"><span class="pre">minimize</span></code> command:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># 6) Save system</span>
<span class="k">write_data </span><span class="nv nv-Identifier">improved.min.data</span>
</pre></div>
</div>
<div class="non-title-info admonition">
<p class="admonition-title">Note</p>
<p>A key improvement to the input is the addition of the
<code class="docutils literal notranslate"><span class="pre">write_data</span></code> command.  This command writes the state of the
system to a text file called <strong>improved.min.data</strong>.  This
<strong>.data</strong> file will be used later to restart the simulation from
the final state of the energy minimization step, eliminating the need
to repeat the system creation and minimization.</p>
</div>
<p>Run the <strong>improved.min.lmp</strong> file using LAMMPS–GUI.  At the end
of the simulation, a file called <strong>improved.min.data</strong> is created.</p>
<p>You can view the contents of <strong>improved.min.data</strong> from LAMMPS–GUI, by
right-clicking on the file name in the editor and selecting the entry
<code class="docutils literal notranslate"><span class="pre">View</span> <span class="pre">file</span> <span class="pre">improved.min.data</span></code>.</p>
<p>The created <strong>.data</strong> file contains all the information necessary
to restart the simulation, such as the number of atoms, the box size,
the masses, and the pair coefficients.  This <strong>.data</strong> file also
contains the final positions of the atoms, along with their IDs and types, within the <code class="docutils literal notranslate"><span class="pre">Atoms</span></code>
section.  The first five columns of the <code class="docutils literal notranslate"><span class="pre">Atoms</span></code> section
correspond (from left to right) to the atom indexes (from 1 to the total
number of atoms, 1150), the atom types (1 or 2 here), and the positions
of the atoms <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, <span class="math notranslate nohighlight">\(z\)</span>.  The last three columns are image flags that
keep track of which atoms crossed the periodic boundary.  The exact
format of each line in the <code class="docutils literal notranslate"><span class="pre">Atoms</span></code> section depends on the choice
of <code class="docutils literal notranslate"><span class="pre">atom_style</span></code>, which determines which per-atom data is set and
stored internally in LAMMPS.</p>
<div class="non-title-info admonition">
<p class="admonition-title">Note</p>
<p>Instead of the <code class="docutils literal notranslate"><span class="pre">write_data</span></code> command, you can also use the
<code class="docutils literal notranslate"><span class="pre">write_restart</span></code> command to save the state
of the simulation to a binary restart file.  Binary restart files are
more compact, faster to write, and contain more information, making them often
more convenient to use.  For example, the choice of <code class="docutils literal notranslate"><span class="pre">atom_style</span></code>
or <code class="docutils literal notranslate"><span class="pre">pair_style</span></code> is recorded, so those commands do not need to be issued
before reading the restart.  Note however that restart files are not expected to be
portable across LAMMPS versions or platforms.  Therefore, in these tutorials,
and with the exception of Tutorial 3, <a class="reference internal" href="../tutorial3/polymer-in-water.html#all-atoms-label"><span class="std std-ref">Polymer in water</span></a>,
we primarily use <code class="docutils literal notranslate"><span class="pre">write_data</span></code> to provide you with a reference
copy of the data file that works regardless of your LAMMPS version and platform.</p>
</div>
</section>
<section id="restarting-from-a-saved-configuration">
<h3>Restarting from a saved configuration<a class="headerlink" href="#restarting-from-a-saved-configuration" title="Link to this heading">¶</a></h3>
<p>To continue a simulation from the saved configuration, open the
<strong>improved.md.lmp</strong> file, which was downloaded during the tutorial setup.
This file contains the <code class="docutils literal notranslate"><span class="pre">Initialization</span></code> part from <strong>initial.lmp</strong>
and <strong>improved.min.lmp</strong>:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># 1) Initialization</span>
<span class="k">units</span><span class="w"> </span><span class="n">lj</span>
<span class="k">dimension</span><span class="w"> </span><span class="m">3</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">atomic</span>
<span class="k">boundary</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span>
<span class="c"># 2) System definition</span>
<span class="c"># 3) Settings</span>
<span class="c"># 4) Monitoring</span>
<span class="c"># 5) Run</span>
</pre></div>
</div>
<p>Since we read most of the information from the data file, we don’t need
to repeat all the commands from the <code class="docutils literal notranslate"><span class="pre">System</span> <span class="pre">definition</span></code>
and <code class="docutils literal notranslate"><span class="pre">Settings</span></code> categories.  The exception is the <code class="docutils literal notranslate"><span class="pre">pair_style</span></code>
command, which now must come <em>before</em> the simulation box is defined,
meaning before the <code class="docutils literal notranslate"><span class="pre">read_data</span></code> command.  Add the following
lines to <strong>improved.md.lmp</strong>:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># 2) System definition</span>
<span class="k">pair_style</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="w"> </span><span class="m">4.0</span>
<span class="k">read_data</span><span class="w"> </span><span class="n">improved.min.data</span>
</pre></div>
</div>
<p>By visualizing the system, you may
have noticed that some atoms left their original region during
minimization.  To start the simulation from a clean slate, with only
atoms of type 2 inside the cylinder and atoms of type 1 outside the
cylinder, let us delete the misplaced atoms by adding the following
commands to the <code class="docutils literal notranslate"><span class="pre">System</span> <span class="pre">definition</span></code> category to <strong>improved.md.lmp</strong>:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">region </span><span class="nv nv-Identifier">cyl_in</span><span class="w"> </span><span class="n">cylinder</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">in</span>
<span class="k">region </span><span class="nv nv-Identifier">cyl_out</span><span class="w"> </span><span class="n">cylinder</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">side</span><span class="w"> </span><span class="n">out</span>
<span class="k">group </span><span class="nv nv-Identifier">grp_t1</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">1</span>
<span class="k">group </span><span class="nv nv-Identifier">grp_t2</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">2</span>
<span class="k">group </span><span class="nv nv-Identifier">grp_in</span><span class="w"> </span><span class="k">region </span><span class="nv nv-Identifier">cyl_in</span>
<span class="k">group </span><span class="nv nv-Identifier">grp_out</span><span class="w"> </span><span class="k">region </span><span class="nv nv-Identifier">cyl_out</span>
<span class="k">group </span><span class="nv nv-Identifier">grp_t1_in</span><span class="w"> </span><span class="n">intersect</span><span class="w"> </span><span class="n">grp_t1</span><span class="w"> </span><span class="n">grp_in</span>
<span class="k">group </span><span class="nv nv-Identifier">grp_t2_out</span><span class="w"> </span><span class="n">intersect</span><span class="w"> </span><span class="n">grp_t2</span><span class="w"> </span><span class="n">grp_out</span>
<span class="k">delete_atoms</span><span class="w"> </span><span class="k">group </span><span class="nv nv-Identifier">grp_t1_in</span>
<span class="k">delete_atoms</span><span class="w"> </span><span class="k">group </span><span class="nv nv-Identifier">grp_t2_out</span>
</pre></div>
</div>
<p>The first two <code class="docutils literal notranslate"><span class="pre">region</span></code> commands recreate the previously defined
regions, which is necessary since regions are not saved by the
<code class="docutils literal notranslate"><span class="pre">write_data</span></code> command.  The first two <code class="docutils literal notranslate"><span class="pre">group</span></code> commands
create groups containing all the atoms of type 1 and all the
atoms of type 2, respectively.  The next two <code class="docutils literal notranslate"><span class="pre">group</span></code> commands
create atom groups based on their positions at the beginning of the
simulation, i.e., when the commands are being read by LAMMPS.  The last
two <code class="docutils literal notranslate"><span class="pre">group</span></code> commands create atom groups based on the intersection
between the previously defined groups.  Finally, the two
<code class="docutils literal notranslate"><span class="pre">delete_atoms</span></code> commands delete the atoms of type 1
located inside the cylinder and the atoms of type 2 located
outside the cylinder, respectively.</p>
<p>Since LAMMPS has a limited number of custom groups (30), it is good practice
to delete groups that are no longer needed.  This can be done by adding the
following four commands to <strong>improved.md.lmp</strong>:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># delete no longer needed groups</span>
<span class="k">group </span><span class="nv nv-Identifier">grp_in</span><span class="w"> </span><span class="n">delete</span>
<span class="k">group </span><span class="nv nv-Identifier">grp_out</span><span class="w"> </span><span class="n">delete</span>
<span class="k">group </span><span class="nv nv-Identifier">grp_t1_in</span><span class="w"> </span><span class="n">delete</span>
<span class="k">group </span><span class="nv nv-Identifier">grp_t2_out</span><span class="w"> </span><span class="n">delete</span>
</pre></div>
</div>
<p>Let us monitor the number of atoms of each type inside the cylinder as a
function of time by creating the following equal-style variables:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">variable </span><span class="nv nv-Identifier">n1_in</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">count</span><span class="nv">(grp_t1,cyl_in)</span>
<span class="k">variable </span><span class="nv nv-Identifier">n2_in</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">count</span><span class="nv">(grp_t2,cyl_in)</span>
</pre></div>
</div>
<p>The equal-style <code class="docutils literal notranslate"><span class="pre">variables</span></code> are expressions evaluated
during the run and return a number.  Here, they are defined to count
the number of atoms of a specific group within the <code class="docutils literal notranslate"><span class="pre">cyl_in</span></code> region.</p>
<div class="non-title-info admonition">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">n1_in</span></code> and <code class="docutils literal notranslate"><span class="pre">n2_in</span></code> defined above are
equal-style variables, which evaluate a numerical expression using the
<code class="docutils literal notranslate"><span class="pre">count()</span></code> function.  Other common LAMMPS variable types include
atom-style, index, and loop.</p>
</div>
<p>In addition to counting the atoms in each region, we will also extract
the coordination number of type 2 atoms around type 1 atoms.  The
coordination number measures the number of type 2 atoms near
type 1 atoms, defined by a cutoff distance.  Taking the average provides
a good indicator of the degree of mixing in a binary mixture.  This
is done using two <code class="docutils literal notranslate"><span class="pre">compute</span></code> commands:  the first counts the
coordinated atoms, and the second calculates the average over all type 1
atoms.  Add the following lines to <strong>improved.md.lmp</strong>:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">compute </span><span class="nv nv-Identifier">coor12</span><span class="w"> </span><span class="nv nv-Identifier">grp_t1</span><span class="w"> </span><span class="n">coord</span><span class="o">/</span><span class="n">atom</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="k">group </span><span class="nv nv-Identifier">grp_t2</span>
<span class="k">compute </span><span class="nv nv-Identifier">sumcoor12</span><span class="w"> </span><span class="nv nv-Identifier">grp_t1</span><span class="w"> </span><span class="n">reduce</span><span class="w"> </span><span class="n">ave</span><span class="w"> </span><span class="n">c_coor12</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">compute</span> <span class="pre">reduce</span> <span class="pre">ave</span></code> command is used to average the per-atom
coordination number calculated by the <code class="docutils literal notranslate"><span class="pre">coord/atom</span></code>
compute command.  Compute commands do not print or output
anything by themselves, nor are they automatically executed; they
require a <em>consumer</em> command that references the compute.  In this case, the
first compute is referenced by the second, and we reference the second
in a <code class="docutils literal notranslate"><span class="pre">thermo_style</span> <span class="pre">custom</span></code> command (see below).</p>
<div class="non-title-info admonition">
<p class="admonition-title">Note</p>
<p>LAMMPS <code class="docutils literal notranslate"><span class="pre">compute</span></code> commands can produce
a wide variety of data and one can identify the category from the
name of the compute style: global data (no suffix), local data
(local suffix), per-atom data (atom suffix), per-chunk data
(chunk suffix), per-gridpoint data (grid suffix).  In the example
above, the <code class="docutils literal notranslate"><span class="pre">compute</span> <span class="pre">coord/atom</span></code> produces per-atom data, which
is used as input for <code class="docutils literal notranslate"><span class="pre">compute</span> <span class="pre">reduce</span></code> which returns global
data.  For global data three kinds of data exists: scalars (single
values), vectors (one-dimensional arrays), or arrays
(two-dimensional tables).  When referencing results of a compute,
you can use indices: for example, <code class="docutils literal notranslate"><span class="pre">c_mycompute</span></code> refers to
the entire scalar, vector, or array, and <code class="docutils literal notranslate"><span class="pre">c_mycompute[1]</span></code>
refers to its first element (in case of vector or array).  In some
cases also wildcards like “*” can be used to, for instance, refer to all elements
of a vector instead of having specify all elements individually.
In general, <em>consumer</em> commands (fix styles or dump styles,
variables, or other compute styles) can only work with certain data
types or need to have keywords set to select which data to use.
You need to check the documentation of each command to ensure
compatibility.</p>
</div>
<div class="non-title-info admonition">
<p class="admonition-title">Note</p>
<p>There is no need for a <code class="docutils literal notranslate"><span class="pre">Settings</span></code>
section, as the settings are taken from the <strong>.data</strong> file.</p>
</div>
<p>Finally, let us complete the script by adding the following lines to
<strong>improved.md.lmp</strong>:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># 4) Monitoring</span>
<span class="k">thermo</span><span class="w"> </span><span class="m">1000</span>
<span class="k">thermo_style</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">pe</span><span class="w"> </span><span class="n">ke</span><span class="w"> </span><span class="n">etotal</span><span class="w"> </span><span class="n">press</span><span class="w"> </span><span class="n">v_n1_in</span><span class="w"> </span><span class="n">v_n2_in</span><span class="w"> </span><span class="n">c_sumcoor12</span>
<span class="k">dump </span><span class="nv nv-Identifier">viz</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">myimage</span><span class="o">-*</span><span class="n">.ppm</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">shiny</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="n">box</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="m">0.01</span><span class="w"> </span><span class="n">view</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">zoom</span><span class="w"> </span><span class="m">1.8</span><span class="w"> </span><span class="n">fsaa</span><span class="w"> </span><span class="n">yes</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="m">800</span><span class="w"> </span><span class="m">800</span>
<span class="k">dump_modify </span><span class="nv nv-Identifier">viz</span><span class="w"> </span><span class="n">adiam</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">adiam</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">acolor</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">turquoise</span><span class="w"> </span><span class="n">acolor</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="n">royalblue</span><span class="w"> </span><span class="n">backcolor</span><span class="w"> </span><span class="n">white</span>
</pre></div>
</div>
<p>The two variables <code class="docutils literal notranslate"><span class="pre">n1_in</span></code>, <code class="docutils literal notranslate"><span class="pre">n2_in</span></code>, along with the compute
<code class="docutils literal notranslate"><span class="pre">sumcoor12</span></code>, were added to the list of information printed during
the simulation.  Additionally, images of the system will be created with
slightly less saturated colors than the default ones.</p>
<p>Finally, add the following lines to <strong>improved.md.lmp</strong>:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># 5) Run</span>
<span class="k">velocity </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">49284</span><span class="w"> </span><span class="n">mom</span><span class="w"> </span><span class="n">yes</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="n">gaussian</span>
<span class="k">fix </span><span class="nv nv-Identifier">mynve</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nve</span>
<span class="k">fix </span><span class="nv nv-Identifier">mylgv</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">langevin</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="m">10917</span><span class="w"> </span><span class="n">zero</span><span class="w"> </span><span class="n">yes</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.005</span>
<span class="k">run</span><span class="w"> </span><span class="m">300000</span>
</pre></div>
</div>
<p>Here, there are a few more differences from the previous simulation.
First, the <code class="docutils literal notranslate"><span class="pre">velocity</span> <span class="pre">create</span></code> command assigns an initial velocity
to each atom.  The initial velocity is chosen so that the average
initial temperature is equal to 1.0 temperature units.  The additional
keywords ensure that no linear momentum (<code class="docutils literal notranslate"><span class="pre">mom</span> <span class="pre">yes</span></code>) is given to
the system and that the generated velocities are distributed according
to a Gaussian distribution.  Another improvement is the <code class="docutils literal notranslate"><span class="pre">zero</span>
<span class="pre">yes</span></code> keyword in the Langevin thermostat, which ensures that the total
random force applied to the atoms is equal to zero. These steps are
important to prevent the system from starting to drift or move as a
whole.</p>
<div class="non-title-info admonition">
<p class="admonition-title">Note</p>
<p>A bulk system with periodic boundary conditions is expected to remain
in place.  Accordingly, when computing the temperature from the
kinetic energy, we use <span class="math notranslate nohighlight">\(3N-3`\)</span> degrees of freedom since there is no
global translation.  In a drifting system, some of the kinetic energy
is due to the drift, which means the system itself cools down.  In
extreme cases, the system can freeze while its center of mass drifts
very quickly.  This phenomenon is sometimes referred to as the
<em>flying ice cube syndrome</em> <span id="id8">[<a class="reference internal" href="../non-tutorials/bibliography.html#id35" title="Jirasak Wong-Ekkabut and Mikko Karttunen. The good, the bad and the user in soft matter simulations. Biochimica et Biophysica Acta (BBA)-Biomembranes, 1858(10):2529–2538, 2016.">20</a>]</span>.</p>
</div>
<p>Run <strong>improved.md.lmp</strong> and observe the mixing of the two populations
over time.</p>
<figure class="align-default">
<img alt="Evolution of the Lennard-Jones fluid mixing" class="only-dark" src="../_images/mixing-vmd-dark.png" />
</figure>
<figure class="align-default">
<img alt="Evolution of the Lennard-Jones fluid mixing" class="only-light" src="../_images/mixing-vmd-light.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Evolution of the system during mixing. The
three snapshots show respectively the system at <span class="math notranslate nohighlight">\(t = 0\)</span> (left panel),
<span class="math notranslate nohighlight">\(t = 75\)</span> (middle panel), and <span class="math notranslate nohighlight">\(t = 1500\)</span> (right panel). The atoms of type
1 are represented as small green spheres and the atoms of type 2 as large cyan spheres.</p>
</div>
<p>From the  variables <code class="docutils literal notranslate"><span class="pre">n1_in</span></code> and <code class="docutils literal notranslate"><span class="pre">n2_in</span></code>, you can track the number of atoms
in each region as a function of time (figure below, panel a).  To view
their evolution, select the entries <code class="docutils literal notranslate"><span class="pre">v_n1_in</span></code> or <code class="docutils literal notranslate"><span class="pre">v_n2_in</span></code> in the <code class="docutils literal notranslate"><span class="pre">Data</span></code>
drop-down menu in the <code class="docutils literal notranslate"><span class="pre">Charts</span></code> window of LAMMPS–GUI.
In addition, as the mixing progresses, the average coordination number
between atoms of types 1 and 2 increases from about 0.01 to 0.04
(figure below, panel b).  This indicates that, over time, more and
more particles of type 1 come into contact with particles of type 2, as
expected during mixing.  This can be observed using the entry
<code class="docutils literal notranslate"><span class="pre">c_sumcoor12</span></code> in the <code class="docutils literal notranslate"><span class="pre">Charts</span></code> drop-down menu.</p>
<figure class="align-default">
<img alt="Evolution of the Lennard-Jones fluid mixing" class="only-dark" src="../_images/LJ-mixing-dm.png" />
</figure>
<figure class="align-default">
<img alt="Evolution of the Lennard-Jones fluid mixing" class="only-light" src="../_images/LJ-mixing.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: a) Evolution of the numbers <span class="math notranslate nohighlight">\(N_\text{1, in}\)</span> and <span class="math notranslate nohighlight">\(N_\text{2, in}\)</span> of atoms
of types 1 and 2, respectively, within the <code class="docutils literal notranslate"><span class="pre">cyl_in</span></code> region as functions
of time <span class="math notranslate nohighlight">\(t\)</span>.  b) Evolution of the coordination number <span class="math notranslate nohighlight">\(C_{1-2}\)</span>
(compute <code class="docutils literal notranslate"><span class="pre">sumcoor12</span></code>) between atoms of types 1 and 2.</p>
</div>
<div class="non-title-info admonition">
<p class="admonition-title">Cite</p>
<p>You can access the input scripts and data files that
are used in these tutorials from a dedicated <a href="https://github.com/lammpstutorials/lammpstutorials-inputs/" target="_blank">GitHub repository</a>.
This repository also contains the full solutions to the exercises.</p>
</div>
</section>
</section>
<section id="going-further-with-exercises">
<h2>Going further with exercises<a class="headerlink" href="#going-further-with-exercises" title="Link to this heading">¶</a></h2>
<section id="experiments">
<h3>Experiments<a class="headerlink" href="#experiments" title="Link to this heading">¶</a></h3>
<p>Here are some suggestions for further experiments with this system that
may lead to additional insights into how different systems are configured
and how various features function:</p>
<ul class="simple">
<li><p>Use a Nosé-Hoover thermostat (<em>fix nvt</em>) instead of a Langevin thermostat
(<em>fix nve</em> + <em>fix langevin</em>).</p></li>
<li><p>Omit the energy minimization step before starting the MD simulation using either
the Nosé-Hoover or the Langevin thermostat.</p></li>
<li><p>Apply a thermostat to only one type of atoms and observe the
temperature for each type separately.</p></li>
<li><p>Append an NVE run (i.e., without any thermostat) and observe the energy levels.</p></li>
</ul>
<div class="gui admonition">
<p class="admonition-title">If you are using LAMMPS-GUI</p>
<p>An useful experiment is coloring the atoms in the <em>Slide Show</em> according
to an observable, such as their respective coordination numbers. To do this,
replace the <em>dump</em> and <em>dump_modify</em> commands with the following lines:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">variable </span><span class="nv nv-Identifier">coor12</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="nv">(type==1)</span><span class="o">*</span><span class="nv">(c_coor12)</span><span class="o">+</span><span class="nv">(type==2)</span><span class="o">*-</span><span class="m">1</span>
<span class="k">dump </span><span class="nv nv-Identifier">viz</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">myimage</span><span class="o">-*</span><span class="n">.ppm</span><span class="w"> </span><span class="n">v_coor12</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">&amp;</span>
<span class="n">shiny</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="n">box</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="m">0.01</span><span class="w"> </span><span class="n">view</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">zoom</span><span class="w"> </span><span class="m">1.8</span><span class="w"> </span><span class="n">fsaa</span><span class="w"> </span><span class="n">yes</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="m">800</span><span class="w"> </span><span class="m">800</span>
<span class="k">dump_modify </span><span class="nv nv-Identifier">viz</span><span class="w"> </span><span class="n">adiam</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">adiam</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">backcolor</span><span class="w"> </span><span class="n">white</span><span class="w"> </span><span class="o">&amp;</span>
<span class="n">amap</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="n">ca</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="n">royalblue</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">turquoise</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">yellow</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="n">red</span>
</pre></div>
</div>
<p>Run LAMMPS again.  Atoms of type 1 are now colored based on the value
of <em>c_coor12</em>, which is mapped continuously from turquoise to yellow
and red for atoms with the highest coordination.
In the definition of the variable <em>v_coor12</em>, atoms of type 2 are
all assigned a value of -1, and will therefore always be colored their default blue.</p>
</div>
</section>
<section id="solve-lost-atoms-error">
<h3>Solve Lost atoms error<a class="headerlink" href="#solve-lost-atoms-error" title="Link to this heading">¶</a></h3>
<p>For this exercise, the following input script is provided:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">units</span><span class="w"> </span><span class="n">lj</span>
<span class="k">dimension</span><span class="w"> </span><span class="m">3</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">atomic</span>
<span class="k">pair_style</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="w"> </span><span class="m">2.5</span>
<span class="k">boundary</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span>

<span class="k">region </span><span class="nv nv-Identifier">simulation_box</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="o">-</span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="o">-</span><span class="m">20</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="o">-</span><span class="m">20</span><span class="w"> </span><span class="m">20</span>
<span class="k">create_box </span><span class="nv nv-Identifier">1</span><span class="w"> </span><span class="nv nv-Identifier">simulation_box</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="m">341841</span><span class="w"> </span><span class="n">simulation_box</span>

<span class="k">mass</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">1.0</span>

<span class="k">dump </span><span class="nv nv-Identifier">mydmp</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="n">dump.lammpstrj</span>
<span class="k">thermo</span><span class="w"> </span><span class="m">100</span>
<span class="k">thermo_style</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">pe</span><span class="w"> </span><span class="n">ke</span><span class="w"> </span><span class="n">etotal</span><span class="w"> </span><span class="n">press</span>

<span class="k">fix </span><span class="nv nv-Identifier">mynve</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nve</span>
<span class="k">fix </span><span class="nv nv-Identifier">mylgv</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">langevin</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="m">1530917</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.005</span>

<span class="k">run</span><span class="w"> </span><span class="m">10000</span>
</pre></div>
</div>
<p>As it is, this input returns one of the most common
error that you will encounter using LAMMPS:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ERROR:<span class="w"> </span>Lost<span class="w"> </span>atoms:<span class="w"> </span>original<span class="w"> </span><span class="m">1000</span><span class="w"> </span>current<span class="w"> </span><span class="m">984</span>
</pre></div>
</div>
<p>The goal of this exercise is to fix the <em>Lost atoms</em> error without
using any other command than the ones already present. You can
only play with the values of the parameters and/or replicate every
command as many times as needed.</p>
<div class="info admonition">
<p class="admonition-title">Note</p>
<p>This script is failing because particles are created randomly in space, some
of them are likely overlapping, and no energy minimization is performed prior
to start the molecular dynamics simulation.</p>
</div>
</section>
<section id="create-a-demixed-dense-phase">
<h3>Create a demixed dense phase<a class="headerlink" href="#create-a-demixed-dense-phase" title="Link to this heading">¶</a></h3>
<p>Starting from one of the <em>input</em> created in this tutorial, fine-tune the
parameters such as particle numbers and interaction to create a simulation
with the following properties:</p>
<ul class="simple">
<li><p>the density in particles must be high,</p></li>
<li><p>both particles of type 1 and 2 must have the same size,</p></li>
<li><p>particles of type 1 and 2 must demix.</p></li>
</ul>
<figure class="align-default">
<img alt="VMD/LAMMPS exercise molecular dynamics simulation: demixing lennard jones fluids" class="only-light" src="../_images/demixing-light.png" />
</figure>
<figure class="align-default">
<img alt="VMD/LAMMPS exercise molecular dynamics simulation: demixing lennard jones fluids" class="only-dark" src="../_images/demixing-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Snapshots taken at different times showing the particles of type 1
and type 2 progressively demixing and forming large demixed areas.</p>
</div>
<div class="info admonition">
<p class="admonition-title">Hint</p>
<p>An easy way to create a dense phase is to allow the box dimensions to relax
until the vacuum disappears. You can do that by replacing the <em>fix nve</em> with <em>fix nph</em>.</p>
</div>
</section>
<section id="from-atoms-to-molecules">
<h3>From atoms to molecules<a class="headerlink" href="#from-atoms-to-molecules" title="Link to this heading">¶</a></h3>
<p>Add a bond between particles of <em>type 2</em> to create dumbbell molecules instead
of single particles.</p>
<figure class="align-default">
<img alt="Dumbbell Lennard-Jones molecules simulated using LAMMPS" class="only-dark" src="../_images/dumbell-dark.png" />
</figure>
<figure class="align-default">
<img alt="Dumbbell Lennard-Jones molecules simulated using LAMMPS" class="only-light" src="../_images/dumbell-light.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Dumbbell molecules made of 2 large spheres mixed with smaller
particles (small spheres). See the corresponding <a href="https://youtu.be/R_oHonOQi68" target="_blank">video</a>.</p>
</div>
<p>Similarly to the dumbbell molecules, create a small polymer,
i.e. a long chain of particles linked by bonds and angles.</p>
<figure class="align-default">
<img alt="Polymer Lennard-Jones molecules simulated using LAMMPS" class="only-dark" src="../_images/polymer-dark.png" />
</figure>
<figure class="align-default">
<img alt="Polymer Lennard-Jones molecules simulated using LAMMPS" class="only-light" src="../_images/polymer-light.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: A single small polymer molecule made of 9 large spheres mixed with
smaller particles. See the corresponding <a href="https://youtu.be/LfqcfP3ZQcY" target="_blank">video</a>.</p>
</div>
<div class="info admonition">
<p class="admonition-title">Hints</p>
<p>Use a <em>molecule template</em> to easily insert as many atoms connected
by bonds (i.e. molecules) as you want. A molecule template typically
begins as follows:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="m">2</span><span class="w"> </span><span class="n">atoms</span>
<span class="m">1</span><span class="w"> </span><span class="n">bonds</span>

<span class="n">Coords</span>

<span class="m">1</span><span class="w"> </span><span class="m">0.5</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="m">2</span><span class="w"> </span><span class="o">-</span><span class="m">0.5</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>

<span class="nv">(...)</span>
</pre></div>
</div>
<p>A bond section also needs to be added, see this
<a href="https://docs.lammps.org/molecule.html" target="_blank">page</a> for details on the formatting of a
molecule template.</p>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../tutorial2/breaking-a-carbon-nanotube.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Pulling on a carbon nanotube</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../non-tutorials/contact.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Contact</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Lennard-Jones fluid</a><ul>
<li><a class="reference internal" href="#my-first-input">My first input</a><ul>
<li><a class="reference internal" href="#initialization">Initialization</a></li>
<li><a class="reference internal" href="#system-definition">System definition</a></li>
<li><a class="reference internal" href="#settings">Settings</a></li>
<li><a class="reference internal" href="#single-point-energy">Single-point energy</a></li>
<li><a class="reference internal" href="#energy-minimization">Energy minimization</a></li>
<li><a class="reference internal" href="#molecular-dynamics">Molecular dynamics</a></li>
<li><a class="reference internal" href="#trajectory-visualization">Trajectory visualization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#improving-the-script">Improving the script</a><ul>
<li><a class="reference internal" href="#control-the-initial-atom-positions">Control the initial atom positions</a></li>
<li><a class="reference internal" href="#restarting-from-a-saved-configuration">Restarting from a saved configuration</a></li>
</ul>
</li>
<li><a class="reference internal" href="#going-further-with-exercises">Going further with exercises</a><ul>
<li><a class="reference internal" href="#experiments">Experiments</a></li>
<li><a class="reference internal" href="#solve-lost-atoms-error">Solve Lost atoms error</a></li>
<li><a class="reference internal" href="#create-a-demixed-dense-phase">Create a demixed dense phase</a></li>
<li><a class="reference internal" href="#from-atoms-to-molecules">From atoms to molecules</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>