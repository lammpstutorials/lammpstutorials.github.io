<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-W1WGEC5GQ8"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-W1WGEC5GQ8');
    </script>
        <link href="../_static/favicon-32x32.png" sizes="32x32" rel="icon" type="image/png"><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Breaking a carbon nanotube" href="carbonnanotube.html" /><link rel="prev" title="Lennard Jones fluid" href="lennardjones.html" />

    <!-- Generated with Sphinx 6.2.1 and Furo 2023.03.27 -->
        <title>Graphene under deformation - </title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">    </div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">    </span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Main</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../howto.html">How-to</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 0</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="lennardjones.html">Lennard Jones fluid</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 1</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Graphene under deformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="carbonnanotube.html">Breaking a carbon nanotube</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="allatoms.html">Polymer in water</a></li>
<li class="toctree-l1"><a class="reference internal" href="sheared.html">Nanosheared electrolyte</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 3</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gcmc-silica.html">Water adsorption in silica</a></li>
<li class="toctree-l1"><a class="reference internal" href="umbrella-sampling.html">Simple free energy calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="surface-profile.html">Adsorption of ethanol</a></li>
<li class="toctree-l1"><a class="reference internal" href="reax-silica.html">Deforming silicon dioxide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extra content</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contact/contact.html">Contact me</a></li>
<li class="toctree-l1"><a class="reference internal" href="../miscellaneous/vmd.html">Make gorgeous image</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Alternative</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../miscellaneous/gromacs.html">Use GROMACS instead</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="graphene-under-deformation">
<span id="graphene-label"></span><h1>Graphene under deformation<a class="headerlink" href="#graphene-under-deformation" title="Permalink to this heading">#</a></h1>
<div class="hatnote docutils container">
<p>Longitudinal deformation of a small graphene sheet</p>
</div>
<figure class="align-right">
<a class="only-dark reference internal image-reference" href="../_images/graphene_dark.png"><img alt="graphene in vacuum image VMD" class="only-dark" src="../_images/graphene_dark.png" style="width: 250px;" /></a>
</figure>
<figure class="align-right">
<a class="only-light reference internal image-reference" href="../_images/graphene_light.png"><img alt="graphene in vacuum image VMD" class="only-light" src="../_images/graphene_light.png" style="width: 250px;" /></a>
</figure>
<div class="justify docutils container">
<p>In this tutorial, a graphene sheet
is generated using VMD and topotool, and is then
deformed using an applied displacement.</p>
</div>
<p>If you are completely new to LAMMPS, I recommend you to follow this simpler tutorial first : <a class="reference internal" href="lennardjones.html#lennard-jones-label"><span class="std std-ref">Lennard Jones fluid</span></a>.</p>
<div class="patreon admonition">
<p class="admonition-title">Do you think I can help you with your project?</p>
<p>See the <a class="reference internal" href="../contact/contact.html#contact-label"><span class="std std-ref">Contact me</span></a> page.</p>
</div>
<section id="generation-of-the-system">
<h2>Generation of the system<a class="headerlink" href="#generation-of-the-system" title="Permalink to this heading">#</a></h2>
<div class="justify docutils container">
<p>The initial configuration (atoms positions, bonds, angles,
etc.) is generated using <a href="https://www.ks.uiuc.edu/Research/vmd/" target="_blank">VMD</a>. Open VMD,
and go to Extensions, Modeling, Nanotube Builder. A window
named Carbon Nanostructures opens up, allowing us to choose
between generating sheet or nanotube of graphene or BN. For
this tutorial, let us generate a 4 nm per 4 nm sheet of
graphene. Simply change the values of “Edge length along x”
and “Edge length along y” to 4, and click on “Generate
Sheet(s)”. You should something like the image on the right
(here I changed the original color a little bit,
but that is not necessary).</p>
</div>
<figure class="align-right">
<a class="only-dark reference internal image-reference" href="../_images/vmd_dark.png"><img alt="graphene in vacuum image VMD" class="only-dark" src="../_images/vmd_dark.png" style="width: 250px;" /></a>
</figure>
<figure class="align-right">
<a class="only-light reference internal image-reference" href="../_images/vmd_light.png"><img alt="graphene in vacuum image VMD" class="only-light" src="../_images/vmd_light.png" style="width: 250px;" /></a>
</figure>
<div class="justify docutils container">
<p>At this point, this is not a molecular dynamics simulations,
but a cloud of dots that looks like graphene.
In the VMD terminal, set the box
dimensions by typing the following command in the VMD
terminal:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text"><em>to be written in the VMD terminal</em></span><a class="headerlink" href="#id1" title="Permalink to this code">#</a></div>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>molinfo top set a 80
molinfo top set b 80
molinfo top set c 80
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>The values of 80 in each direction have been chosen
so that the box is much larger than the graphene sheet.</p>
<p>In order to
generate the initial LAMMPS data file, let us use Topotool:
to generate the LAMMPS data file, enter the following command:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text"><em>to be written in the VMD terminal</em></span><a class="headerlink" href="#id2" title="Permalink to this code">#</a></div>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>topo writelammpsdata carbon.data molecular
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>Here molecular refers to the LAMMPS atom_style, and carbon.data
to the name of the file.</p>
<p>Note that I am using TopoTools v1.7. Older or newer versions
may require slightly different commands.</p>
<p>More details about these commands can be found on the
personal page of <a href="https://sites.google.com/site/akohlmey/software/topotools" target="_blank">Axel Kohlmeyer</a>.
In short, Topotool deduces the location of bonds, angles,
dihedrals, and impropers from the positions of the atoms,
and generates a file that can be read by LAMMPS.</p>
</div>
<div class="justify docutils container">
<p>The keyword “full” corresponds to the LAMMPS atom full
style (other possibilities include atomic, bond, charge,
etc). The parameters of the constraints (bond length,
dihedral coefficients, etc.) will be given later.</p>
<p>A new file named “carbon.data” has been created, it starts
like that:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="n">LAMMPS</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">file.</span><span class="w"> </span><span class="n">CGCMM</span><span class="w"> </span><span class="n">style.</span><span class="w"> </span><span class="n">atom_style</span><span class="w"> </span><span class="n">molecular</span><span class="w"> </span><span class="n">generated</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="n">VMD</span><span class="o">/</span><span class="n">TopoTools</span><span class="w"> </span><span class="n">v1.7</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">Tue</span><span class="w"> </span><span class="n">Apr</span><span class="w"> </span><span class="m">04</span><span class="w"> </span><span class="m">15:58:11</span><span class="w"> </span><span class="n">CEST</span><span class="w"> </span><span class="m">2023</span>
<span class="m">680</span><span class="w"> </span><span class="n">atoms</span>
<span class="m">983</span><span class="w"> </span><span class="n">bonds</span>
<span class="m">1894</span><span class="w"> </span><span class="n">angles</span>
<span class="m">3665</span><span class="w"> </span><span class="n">dihedrals</span>
<span class="m">608</span><span class="w"> </span><span class="n">impropers</span>
<span class="m">1</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="n">types</span>
<span class="m">1</span><span class="w"> </span><span class="n">bond</span><span class="w"> </span><span class="n">types</span>
<span class="m">1</span><span class="w"> </span><span class="n">angle</span><span class="w"> </span><span class="n">types</span>
<span class="m">1</span><span class="w"> </span><span class="n">dihedral</span><span class="w"> </span><span class="n">types</span>
<span class="m">1</span><span class="w"> </span><span class="n">improper</span><span class="w"> </span><span class="n">types</span>
<span class="o">-</span><span class="m">20.965628</span><span class="w"> </span><span class="m">59.034372</span><span class="w">  </span><span class="n">xlo</span><span class="w"> </span><span class="n">xhi</span>
<span class="o">-</span><span class="m">19.438999</span><span class="w"> </span><span class="m">60.561001</span><span class="w">  </span><span class="n">ylo</span><span class="w"> </span><span class="n">yhi</span>
<span class="o">-</span><span class="m">40.000000</span><span class="w"> </span><span class="m">40.000000</span><span class="w">  </span><span class="n">zlo</span><span class="w"> </span><span class="n">zhi</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>As you can see, the carbon.data file contains information
about the positions of the carbons atoms, as well as the
identity of the atoms that are linked by bonds, angles, dihedrals,
and impropers constraints.</p>
<p>Save the “carbon.data” file in the same folder as your
future LAMMPS input script.</p>
<p>We are done with the system
generation, we can start the molecular dynamics simulations.</p>
<p>Alternatively, you can download the file I did generate
by clicking  <a href="../../../../inputs/graphene-under-deformation/carbon.data" target="_blank">here</a>, and continue with the tutorial.</p>
</div>
<div class="patreon admonition">
<p class="admonition-title">Support me for 1 euro per month</p>
<p>Become a <a href="https://www.patreon.com/molecularsimulations" target="_blank">Patreon</a> and support the creation of content for LAMMPS</p>
</div>
</section>
<section id="lammps-input-script">
<h2>LAMMPS input script<a class="headerlink" href="#lammps-input-script" title="Permalink to this heading">#</a></h2>
<div class="justify docutils container">
<p>Create a new text file and name it “input.lammps”. Copy the
following lines in it:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in input.lammps</em></span><a class="headerlink" href="#id3" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># Initialisation</span>

<span class="k">variable </span><span class="nv nv-Identifier">T</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="m">300</span>

<span class="k">units</span><span class="w"> </span><span class="n">real</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">molecular</span>
<span class="k">boundary</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="n">f</span>
<span class="k">pair_style</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="w"> </span><span class="m">14</span>

<span class="k">bond_style</span><span class="w"> </span><span class="n">harmonic</span>
<span class="k">angle_style</span><span class="w"> </span><span class="n">harmonic</span>
<span class="k">dihedral_style</span><span class="w"> </span><span class="n">opls</span>
<span class="k">improper_style</span><span class="w"> </span><span class="n">harmonic</span>

<span class="k">special_bonds</span><span class="w"> </span><span class="n">lj</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">0.5</span>

<span class="k">read_data</span><span class="w"> </span><span class="n">carbon.data</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>The unit system is real (distance are in Angstrom, time in femtosecond),
atom style is molecular (atoms are dots that can be bonded with each other),
and the boundary conditions are fixed. The boundary conditions
do not matter much here, as the box boundaries are far from the graphene sheet.</p>
<p>Here the pair style is lj/cut (i.e. a Lennard Jones potential
with a short range cutoff) with
parameter 14, which means that the atoms closer than 14
Angstroms from each others interact through a Lennard-Jones
potential. Notice that there is no Coulombic interaction
because all the atoms in pure graphene have a charge of 0.
The bond, angle, dihedral, and improper styles specify the
different potentials used to restrain the positions of the
atoms. For more details, have a look at the LAMMPS website
(see for example the <a href="https://lammps.sandia.gov/doc/dihedral_opls.html" target="_blank">OPLS dihedral style</a>).</p>
</div>
<div class="justify docutils container">
<p>The last command (read_data) imports the carbon.data file
previously generated with VMD, which contains the
information about the box size, atoms positions, etc.</p>
</div>
<div class="info admonition">
<p class="admonition-title">About interaction between neighbors atoms</p>
<p>Atoms connected by a bond do not typically interact through
Lennard-Jones interaction. This is ensured here by the
special_bonds command. The three numbers of the
special_bonds command are weighting factors for the
Lennard-Jones interaction between atoms connected by bond
(respectively directly bounded C-C, separated by two bonds C-C-C,
and separated by three bonds C-C-C-C). For instance, the
first weighting factor, with a
value of 0, imposes that two atoms connected by a bond do
not interact through a Lennard-Jones potential (therefore
they only interact through the harmonic potential that bond the atoms
of the graphene).</p>
</div>
</section>
<section id="parameters-for-the-graphene">
<h2>Parameters for the graphene<a class="headerlink" href="#parameters-for-the-graphene" title="Permalink to this heading">#</a></h2>
<div class="justify docutils container">
<p>Next, we need to specify the parameters of both bonded and
non-bonded interactions. Create a new text file in the same
folder and name it “PARM.lammps”. Copy the following lines
in it:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in PARM.lammps</em></span><a class="headerlink" href="#id4" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">pair_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.066047</span><span class="w"> </span><span class="m">3.4</span>
<span class="k">bond_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">469</span><span class="w"> </span><span class="m">1.4</span>
<span class="k">angle_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">63</span><span class="w"> </span><span class="m">120</span>
<span class="k">dihedral_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">7.25</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="k">improper_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">180</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>The pair_coeff sets the Lennard-jones parameters
<span class="math notranslate nohighlight">\(\epsilon\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> for the only type of
atom of the simulation: carbon atom of type 1. The
bond_coeff provides the equilibrium distance <span class="math notranslate nohighlight">\(r_0\)</span> as
well as the spring constant <span class="math notranslate nohighlight">\(K\)</span> for the harmonic
potential imposed between two neighboring carbon atoms,
where the potential is <span class="math notranslate nohighlight">\(E = K_r ( r - r_0)^2\)</span>. The
angle_coeff gives the equilibrium angle \(\theta_0\) and
constant for the potential between three neighbors atoms :
<span class="math notranslate nohighlight">\(E = K_\theta ( \theta - \theta_0)^2\)</span>. The dihedral_coeff
and improper_coeff give the potential for the constraints
between 4 atoms. The file PARM.lammps need to be included in the
simulation by adding the following line to input.lammps:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in input.lammps</em></span><a class="headerlink" href="#id5" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">include</span><span class="w"> </span><span class="n">PARM.lammps</span>
</pre></div>
</div>
</div>
</section>
<section id="recenter-the-atoms-in-the-box">
<h2>Recenter the atoms in the box<a class="headerlink" href="#recenter-the-atoms-in-the-box" title="Permalink to this heading">#</a></h2>
<div class="justify docutils container">
<p>The graphene sheet generated by topotool is not centered in the box.
The box itself is not symmetric, as its coordinates are</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="m">20.965628</span><span class="w"> </span><span class="m">59.034372</span><span class="w">  </span><span class="n">xlo</span><span class="w"> </span><span class="n">xhi</span>
<span class="o">-</span><span class="m">19.438999</span><span class="w"> </span><span class="m">60.561001</span><span class="w">  </span><span class="n">ylo</span><span class="w"> </span><span class="n">yhi</span>
<span class="o">-</span><span class="m">40.000000</span><span class="w"> </span><span class="m">40.000000</span><span class="w">  </span><span class="n">zlo</span><span class="w"> </span><span class="n">zhi</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Let us create a cleaner initial state by recentering the graphene
at the origin (0, 0, 0), and symmetrize the box.</p>
<p>In the LAMMPS input, copy:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in input.lammps</em></span><a class="headerlink" href="#id6" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">group </span><span class="nv nv-Identifier">gcar</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">1</span>
<span class="k">variable </span><span class="nv nv-Identifier">xcm</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="o">*</span><span class="n">xcm</span><span class="nv">(gcar,x)</span>
<span class="k">variable </span><span class="nv nv-Identifier">ycm</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="o">*</span><span class="n">xcm</span><span class="nv">(gcar,y)</span>
<span class="k">variable </span><span class="nv nv-Identifier">zcm</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="o">*</span><span class="n">xcm</span><span class="nv">(gcar,z)</span>
<span class="k">displace_atoms</span><span class="w"> </span><span class="n">gcar</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="nv">${xcm}</span><span class="w"> </span><span class="nv">${ycm}</span><span class="w"> </span><span class="nv">${zcm}</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>The first command includes all of the atoms of type one
(i.e. all the atoms here) in a group named ‘gcar’.
The 3 variables measure the current position of the group gcar
along all 3 directions, respectively. Then, the displace atoms
command move the group gcar, ensuring that its center of mass
is located at the origin (0, 0, 0).</p>
<p>Let us also slightly reduce the box size, and give it cleaner and symmetric value.</p>
</div>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in input.lammps</em></span><a class="headerlink" href="#id7" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">change_box </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="o">-</span><span class="m">35.0</span><span class="w"> </span><span class="m">35.0</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="o">-</span><span class="m">35.0</span><span class="w"> </span><span class="m">35.0</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="o">-</span><span class="m">15.0</span><span class="w"> </span><span class="m">15.0</span>
</pre></div>
</div>
</div>
<div class="info admonition">
<p class="admonition-title">About the atom style</p>
<p>A cleaner initial state, as we did here, wont make any difference to the simulation, but
can make the future data analysis more practical.</p>
</div>
</section>
<section id="separate-the-atoms-into-3-groups">
<h2>Separate the atoms into 3 groups<a class="headerlink" href="#separate-the-atoms-into-3-groups" title="Permalink to this heading">#</a></h2>
<div class="justify docutils container">
<p>The main goal of the present tutorial is to impose a
deformation to the sheet. To do so, we will isolate the
atoms from the two edges of the graphene sheets and place them into groups.
Then, the displacement will be applied to the atoms of the edges.
Add the following lines to the input script :</p>
</div>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in input.lammps</em></span><a class="headerlink" href="#id8" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">variable </span><span class="nv nv-Identifier">xmax</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">bound</span><span class="nv">(gcar,xmax)</span><span class="o">-</span><span class="m">0.5</span>
<span class="k">variable </span><span class="nv nv-Identifier">xmin</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">bound</span><span class="nv">(gcar,xmin)</span><span class="o">+</span><span class="m">0.5</span>
<span class="k">region </span><span class="nv nv-Identifier">rtop</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="nv">${xmax}</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span>
<span class="k">region </span><span class="nv nv-Identifier">rbot</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="nv">${xmin}</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span>
<span class="k">region </span><span class="nv nv-Identifier">rmid</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="nv">${xmin}</span><span class="w"> </span><span class="nv">${xmax}</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>The variable <span class="math notranslate nohighlight">\(x_\mathrm{max}\)</span> corresponds to
the coordinate of the last atoms along \(x\) minus 0.5
Angstroms, and <span class="math notranslate nohighlight">\(x_\mathrm{min}\)</span> to the coordinate of
the first atoms along <span class="math notranslate nohighlight">\(x\)</span> plus 0.5 Angstroms. Then, 3
regions are defined, and correspond respectively to: <span class="math notranslate nohighlight">\(x &lt; x_\mathrm{min}\)</span>,
<span class="math notranslate nohighlight">\(x_\mathrm{min} &gt; x &gt; x_\mathrm{max}\)</span>, and
<span class="math notranslate nohighlight">\(x &gt; x_\mathrm{max}\)</span>.</p>
<p>Finally, let us define 3 groups of atoms
corresponding to the atoms located in each of the 3 regions,
respectively:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in input.lammps</em></span><a class="headerlink" href="#id9" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">group </span><span class="nv nv-Identifier">gtop</span><span class="w"> </span><span class="k">region </span><span class="nv nv-Identifier">rtop</span>
<span class="k">group </span><span class="nv nv-Identifier">gbot</span><span class="w"> </span><span class="k">region </span><span class="nv nv-Identifier">rbot</span>
<span class="k">group </span><span class="nv nv-Identifier">gmid</span><span class="w"> </span><span class="k">region </span><span class="nv nv-Identifier">rmid</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>The atoms of the edges as selected within the gtop and gbot groups
are represented by spheres:</p>
</div>
<figure class="align-default">
<img alt="graphene in vacuum image VMD with selected groups at the edges" class="only-dark" src="../_images/group-dark.png" />
</figure>
<figure class="align-default">
<img alt="graphene in vacuum image VMD with selected groups at the edges" class="only-light" src="../_images/group-light.png" />
</figure>
<div class="info admonition">
<p class="admonition-title">Tip</p>
<div class="justify docutils container">
<p>When running a simulation, the number of atoms in each
group is printed in the terminal (and in the log.lammps
file). Alway control that the number of atoms is the one you expect.</p>
<p>Here I see:</p>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">20</span><span class="w"> </span>atoms<span class="w"> </span><span class="k">in</span><span class="w"> </span>group<span class="w"> </span>gtop
<span class="m">20</span><span class="w"> </span>atoms<span class="w"> </span><span class="k">in</span><span class="w"> </span>group<span class="w"> </span>gbot
<span class="m">640</span><span class="w"> </span>atoms<span class="w"> </span><span class="k">in</span><span class="w"> </span>group<span class="w"> </span>gmid
</pre></div>
</div>
<div class="justify docutils container">
<p>which is consistent with what I expect when looking at the system
using VMD.</p>
</div>
</div>
</section>
<section id="thermalisation-and-dynamics">
<h2>Thermalisation and dynamics<a class="headerlink" href="#thermalisation-and-dynamics" title="Permalink to this heading">#</a></h2>
<div class="justify docutils container">
<p>Let us specify the thermalisation and the dynamics of the
system. Add the following lines to input.lammps:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in input.lammps</em></span><a class="headerlink" href="#id10" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">velocity</span><span class="w"> </span><span class="n">gmid</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="nv">${T}</span><span class="w"> </span><span class="m">48455</span><span class="w"> </span><span class="n">mom</span><span class="w"> </span><span class="n">yes</span><span class="w"> </span><span class="n">rot</span><span class="w"> </span><span class="n">yes</span>
<span class="k">fix </span><span class="nv nv-Identifier">mynve</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nve</span>
<span class="k">compute </span><span class="nv nv-Identifier">Tmid</span><span class="w"> </span><span class="nv nv-Identifier">gmid</span><span class="w"> </span><span class="n">temp</span>
<span class="k">fix </span><span class="nv nv-Identifier">myber</span><span class="w"> </span><span class="nv nv-Identifier">gmid</span><span class="w"> </span><span class="n">temp</span><span class="o">/</span><span class="n">berendsen</span><span class="w"> </span><span class="nv">${T}</span><span class="w"> </span><span class="nv">${T}</span><span class="w"> </span><span class="m">100</span>
<span class="k">fix_modify</span><span class="w"> </span><span class="n">myber</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">Tmid</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>The “velocity create” command gives initial velocities to
the atoms of the group gmid, assuring an initial temperature
of 300 K for these atoms.</p>
<p>The fix nve is applied to all
atoms so that atoms positions are recalculated
every timestep, and a Berendsen thermostat is applied to the atoms
of the group gmid only. The “fix modify” ensures that the
fix Berendsen uses the temperature of the group gmid as an
input, instead of the temperature of whole system (as the
frozen edges would biase the temperature). The atoms
of the edges are not thermalised because their motion will
be restrained in the next part of the input.</p>
</div>
<div class="info admonition">
<p class="admonition-title">Deal with semi-frozen system</p>
<p>Always be carefull when part of a system is frozen. In that
case, the total temperature of the system is effectively lower
than the applied temperature because the frozen atoms
have a temperature of 0. If you have any doubt about the procedure
you are using, simply print the temperature of the non-frozen group using fix ave/time:</p>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in input.lammps</em></span><a class="headerlink" href="#id11" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">at1</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">time</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">c_Tmid</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">temperature.dat</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="restrain-the-motion-of-the-edges">
<h2>Restrain the motion of the edges<a class="headerlink" href="#restrain-the-motion-of-the-edges" title="Permalink to this heading">#</a></h2>
<div class="justify docutils container">
<p>To restrain the motion of the atoms at the edges, add the
following commands:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in input.lammps</em></span><a class="headerlink" href="#id12" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">mysf1</span><span class="w"> </span><span class="nv nv-Identifier">gtop</span><span class="w"> </span><span class="n">setforce</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="m">0</span>
<span class="k">fix </span><span class="nv nv-Identifier">mysf2</span><span class="w"> </span><span class="nv nv-Identifier">gbot</span><span class="w"> </span><span class="n">setforce</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="m">0</span>
<span class="k">velocity</span><span class="w"> </span><span class="n">gtop</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="m">0</span>
<span class="k">velocity</span><span class="w"> </span><span class="n">gbot</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="m">0</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>The two setforce commands cancel the forces applied on the
atoms of the two edges, respectively. Fix setforce apply during the whole
simulation, and are here applying only along <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(z\)</span>. The two velocity
commands set the initial velocities along <span class="math notranslate nohighlight">\(x\)</span> and
<span class="math notranslate nohighlight">\(z\)</span> to 0 for the atoms of the edges. Therefore, the
atoms of the edges will remain immobile during the
simulation (or at least they would if no other command was applied to them).</p>
</div>
<div class="info admonition">
<p class="admonition-title">On imposing a constant velocity to a system</p>
<p>The ‘velocity set’ commands impose the velocity of a group of atoms <em>when it is
read</em>, but do not enforce the velocity during the entire simulation.</p>
<p>When ‘velocity set’ is used in combination with ‘setforce 0’, the atoms will
feel no force from the rest of the simulation. Accoring to the Newton equation,
no force means no acceleration, meaning that the initial velocity will persist.</p>
</div>
</section>
<section id="data-extraction">
<h2>Data extraction<a class="headerlink" href="#data-extraction" title="Permalink to this heading">#</a></h2>
<div class="justify docutils container">
<p>Next, in order to measure the strain and stress suffered by the
graphene sheet, let us extract the distance <span class="math notranslate nohighlight">\(L\)</span> between
the two edges as well as the force applied on the edges. Let
us also add a command to print the atom coordinates in a
lammpstrj file every 1000 timeteps:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in input.lammps</em></span><a class="headerlink" href="#id13" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">variable </span><span class="nv nv-Identifier">L</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">xcm</span><span class="nv">(gtop,x)</span><span class="o">-</span><span class="n">xcm</span><span class="nv">(gbot,x)</span>
<span class="k">fix </span><span class="nv nv-Identifier">at2</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">time</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">v_L</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">length.dat</span>
<span class="k">fix </span><span class="nv nv-Identifier">at3</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">time</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">f_mysf1[1]</span><span class="w"> </span><span class="n">f_mysf2[1]</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">force.dat</span>
<span class="k">dump </span><span class="nv nv-Identifier">mydmp</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">dump.lammpstrj</span>
</pre></div>
</div>
</div>
<div class="info admonition">
<p class="admonition-title">About <cite>f_</cite>, <cite>v_</cite>, and <cite>c_</cite></p>
<p>Notice that the values of the force on each edge are
extracted from the fixes setforce ‘mysf1’ and ‘mysf2’, by
calling them using <cite>f_</cite>, the same way variables are called
using <cite>v_</cite> and computes are called using <cite>c_</cite>. A fix
setforce cancels all the forces on a group of atoms every
timestep, but allows one to extract the values of the force
before its cancellation.</p>
</div>
</section>
<section id="run">
<h2>Run<a class="headerlink" href="#run" title="Permalink to this heading">#</a></h2>
<div class="justify docutils container">
<p>Let us run a small equilibration step to bring the system
to the required temperature without applying any deformation:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in input.lammps</em></span><a class="headerlink" href="#id14" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">thermo</span><span class="w"> </span><span class="m">100</span>
<span class="k">thermo_modify</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">Tmid</span>

<span class="k">timestep</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">run</span><span class="w"> </span><span class="m">5000</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>With the ‘thermo_modify’ command, we specify to LAMMPS that we
want the temperature <span class="math notranslate nohighlight">\(T_\mathrm{mid}\)</span> to be printed in
the terminal, not the temperature of the entire system
(because of the frozen edges, the temperature of the entire
system is not relevant).</p>
</div>
<section id="option-a-incremental-elongation">
<h3>Option A: Incremental elongation<a class="headerlink" href="#option-a-incremental-elongation" title="Permalink to this heading">#</a></h3>
<div class="justify docutils container">
<p>Let us perform a loop:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id15">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in input.lammps</em></span><a class="headerlink" href="#id15" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">variable </span><span class="nv nv-Identifier">var</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="m">10</span>
<span class="w">    </span><span class="n">label</span><span class="w"> </span><span class="n">loop</span>
<span class="w">    </span><span class="n">displace_atoms</span><span class="w"> </span><span class="n">gtop</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="w">    </span><span class="n">displace_atoms</span><span class="w"> </span><span class="n">gbot</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="o">-</span><span class="m">0.1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="w">    </span><span class="n">run</span><span class="w"> </span><span class="m">1000</span>
<span class="w">    </span><span class="n">next</span><span class="w"> </span><span class="n">var</span>
<span class="w">    </span><span class="n">jump</span><span class="w"> </span><span class="n">input.lammps</span><span class="w"> </span><span class="n">loop</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>At each step of the loop, the edges are slightly displaced, and
the simulation runs for 1000. Then the variable ‘var’ is iterated
by the ‘next var’, and the simulation ‘jumps’ back to the beginning of
the loop. It will be repeated 10 times, for a total elongation of the
graphene sheet of 2 x 0.1 x 10 = 2 Angstroms.</p>
<p>What you observe should resemble <a href="https://www.youtube.com/embed/o5IoCVWpPKg" target="_blank">this video</a>. The
sheet is progressively elongated, and the carbon honeycombs
are being deformed. You can increase the number of iteration
of the loop (variable var) to force a larger elongation.</p>
</div>
<div class="justify docutils container">
<p>Always remember that what you measure and observe is only
as good as your force field.</p>
</div>
<div class="justify docutils container">
<p>With the present force field, no matter how large is the
imposed deformation, the bonds will never break. To study
such bond breaking, one has to use a reactive force
field, which is done in some other tutorials here (like <a class="reference internal" href="carbonnanotube.html#carbon-nanotube-label"><span class="std std-ref">Breaking a carbon nanotube</span></a>).</p>
</div>
</section>
<section id="option-b-constant-velocity-elongation">
<h3>Option B: Constant-velocity elongation<a class="headerlink" href="#option-b-constant-velocity-elongation" title="Permalink to this heading">#</a></h3>
<div class="justify docutils container">
<p>Instead of the loop, the deformation of the sheet can be ensured
using the velocity set command + the fix setforce (which are already there).</p>
<p>To obtain the same elongation as previously (i.e. 2 Angstroms, or 1 Angstrom
per edge), using a velocity
for each edge of 0.0005 Angstroms per femtosecond (i.e. 50 meters per second), the simulation
must last 1 / 0.0005 = 2000 femtoseconds.</p>
</div>
<div class="literal-block-wrapper docutils container" id="id16">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in input.lammps</em></span><a class="headerlink" href="#id16" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">velocity</span><span class="w"> </span><span class="n">gtop</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="m">0.0005</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="m">0</span>
<span class="k">velocity</span><span class="w"> </span><span class="n">gbot</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="o">-</span><span class="m">0.0005</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="m">0</span>
<span class="k">run</span><span class="w"> </span><span class="m">2000</span>
</pre></div>
</div>
</div>
<p>You can access all the input scripts and data files that
are used in these tutorials from <a href="https://github.com/lammpstutorials/lammpstutorials.github.io/tree/version2.0/docs/inputs" target="_blank">Github</a>.</p>
</section>
</section>
<section id="going-further-with-exercices">
<h2>Going further with exercices<a class="headerlink" href="#going-further-with-exercices" title="Permalink to this heading">#</a></h2>
<section id="strain-stress-curve-with-solution">
<h3>Strain-stress curve (with solution)<a class="headerlink" href="#strain-stress-curve-with-solution" title="Permalink to this heading">#</a></h3>
<p>Adapt the current script and extract a full strain-stress curve.</p>
<figure class="align-default">
<img alt="strain stain curve for determining the young modulus of graphene" class="only-dark" src="../_images/strain-stain-curve-dark.png" />
</figure>
<figure class="align-default">
<img alt="strain stain curve for determining the young modulus of graphene" class="only-light" src="../_images/strain-stain-curve-light.png" />
</figure>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<p>The following steps are optional, but give a better result:</p>
<ul class="simple">
<li><p>move fix at2 and at3 after the equilibration, so that it only records during the production run</p></li>
<li><p>reduce the velocity to perform a nice and slow graphene pull</p></li>
<li><p>increase the magnitude of the total elongation (10 Angstroms in total per edge)</p></li>
</ul>
<p>The strain can be calculated as the relative elongation of the sheet: strain = L - Linit / Linit,
and the stress, in pressure unit, can be calculated as the force divided by the surface area
of the graphene sheet: A = Ly x dC, where Ly in the length of the graphene sheet along y, here 4 nanometers,
and dC the diameter of the carbon atoms (I used dC = 3.4 Angstrom, this choice is debatable).</p>
<p>The python script I used to generate the stress-strain curve is <a href="../../../../inputs/graphene-under-deformation/exercice-stress-strain-curve/plot_stress_strain.py" target="_blank">here</a>.</p>
</div>
<div class="mail admonition">
<p class="admonition-title">Contact me</p>
<p>Feel free to <a class="reference internal" href="../contact/contact.html#contact-label"><span class="std std-ref">Contact me</span></a> me if you have any question or suggestion about these tutorials.</p>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="carbonnanotube.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Breaking a carbon nanotube</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="lennardjones.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Lennard Jones fluid</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Graphene under deformation</a><ul>
<li><a class="reference internal" href="#generation-of-the-system">Generation of the system</a></li>
<li><a class="reference internal" href="#lammps-input-script">LAMMPS input script</a></li>
<li><a class="reference internal" href="#parameters-for-the-graphene">Parameters for the graphene</a></li>
<li><a class="reference internal" href="#recenter-the-atoms-in-the-box">Recenter the atoms in the box</a></li>
<li><a class="reference internal" href="#separate-the-atoms-into-3-groups">Separate the atoms into 3 groups</a></li>
<li><a class="reference internal" href="#thermalisation-and-dynamics">Thermalisation and dynamics</a></li>
<li><a class="reference internal" href="#restrain-the-motion-of-the-edges">Restrain the motion of the edges</a></li>
<li><a class="reference internal" href="#data-extraction">Data extraction</a></li>
<li><a class="reference internal" href="#run">Run</a><ul>
<li><a class="reference internal" href="#option-a-incremental-elongation">Option A: Incremental elongation</a></li>
<li><a class="reference internal" href="#option-b-constant-velocity-elongation">Option B: Constant-velocity elongation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#going-further-with-exercices">Going further with exercices</a><ul>
<li><a class="reference internal" href="#strain-stress-curve-with-solution">Strain-stress curve (with solution)</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>