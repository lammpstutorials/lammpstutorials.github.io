<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-W1WGEC5GQ8"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-W1WGEC5GQ8');
    </script>
        <link href="../_static/favicon-32x32.png" sizes="32x32" rel="icon" type="image/png"><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Contact me" href="../contact/contact.html" /><link rel="prev" title="Adsorption of ethanol" href="surface-profile.html" />

    <!-- Generated with Sphinx 7.0.1 and Furo 2023.05.20 -->
        <title>Reactive silicon dioxide - </title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=e6660623a769aa55fea372102b9bf3151b292993" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">    </div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">    </span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Main</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../howto.html">How-to</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 0</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="lennardjones.html">Lennard Jones fluid</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="graphene.html">Graphene under deformation</a></li>
<li class="toctree-l1"><a class="reference internal" href="carbonnanotube.html">Breaking a carbon nanotube</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="allatoms.html">Polymer in water</a></li>
<li class="toctree-l1"><a class="reference internal" href="sheared.html">Nanosheared electrolyte</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 3</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="gcmc-silica.html">Water adsorption in silica</a></li>
<li class="toctree-l1"><a class="reference internal" href="umbrella-sampling.html">Simple free energy calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="surface-profile.html">Adsorption of ethanol</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Reactive silicon dioxide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extra content</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contact/contact.html">Contact me</a></li>
<li class="toctree-l1"><a class="reference internal" href="../miscellaneous/vmd.html">Make gorgeous image</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Alternative</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../miscellaneous/gromacs.html">Use GROMACS instead</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="reactive-silicon-dioxide">
<span id="reactive-silicon-dioxide-label"></span><h1>Reactive silicon dioxide<a class="headerlink" href="#reactive-silicon-dioxide" title="Permalink to this heading">#</a></h1>
<div class="hatnote docutils container">
<p>Deforming a chemically reactive structure using reaxff</p>
</div>
<figure class="align-right">
<a class="only-light reference internal image-reference" href="../_images/SiO_gif_light.webp"><img alt="Figure showing silicon dioxide structure with colored charges as simulated with lammps and reaxff" class="only-light" src="../_images/SiO_gif_light.webp" style="height: 250px;" /></a>
</figure>
<figure class="align-right">
<a class="only-dark reference internal image-reference" href="../_images/SiO_gif_dark.webp"><img alt="Figure showing silicon dioxide structure with colored charges as simulated with lammps and reaxff" class="only-dark" src="../_images/SiO_gif_dark.webp" style="height: 250px;" /></a>
</figure>
<div class="justify docutils container">
<p>The objective of this tutorial is to use a molecular
dynamics system made of silicon dioxide (SiO2), and deform
it until it breaks. The reactive force field reaxff is used, and
a particular attention is given to the evolution of the charges of the atoms during
the deformation of the structure.</p>
</div>
<p>If you are completely new to LAMMPS, I recommend you to follow this simpler tutorial first : <a class="reference internal" href="lennardjones.html#lennard-jones-label"><span class="std std-ref">Lennard Jones fluid</span></a>.</p>
<div class="patreon admonition">
<p class="admonition-title">Need assistance with your LAMMPS project?</p>
<p>See the <a class="reference internal" href="../contact/contact.html#contact-label"><span class="std std-ref">Contact me</span></a> page.</p>
</div>
<section id="relax-the-structure">
<h2>Relax the structure<a class="headerlink" href="#relax-the-structure" title="Permalink to this heading">#</a></h2>
<div class="justify docutils container">
<p>Create a folder, name it RelaxSilica/, and <a href="../../../../inputs/reactive-silicon-dioxide/RelaxSilica/silica.data" target="_blank">download</a>
the initial topology of a small amorphous silica structure.
The system was created by temperature annealing using another force field
(<a href="../../../../inputs/reactive-silicon-dioxide/CreateSilica/SiO.1990.vashishta" target="_blank">vashishta</a>), therefore the structure is slightly
different to what is expected from the reaxff force field.
For instance, the average bond lengths, angles, or charges
can be expected to be slightly different, and the structure will need
to be relaxed again using reaxff.</p>
<p>If you are interested, the input file used for creating the initial topology is
available <a href="../../../../inputs/reactive-silicon-dioxide/CreateSilica/input.lammps" target="_blank">here</a>, but its description is not part of this tutorial.</p>
<p>The Atoms section of the <em>silica.data</em> file starts like that:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="n">Atoms</span><span class="w"> </span><span class="c"># full</span>

<span class="m">132</span><span class="w"> </span><span class="m">15</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">-</span><span class="m">0.55</span><span class="w"> </span><span class="m">1.722106654667303</span><span class="w"> </span><span class="m">6.0790786378597526</span><span class="w"> </span><span class="m">5.627968948336774</span><span class="w"> </span><span class="o">-</span><span class="m">6</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="o">-</span><span class="m">5</span>
<span class="m">172</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1.1</span><span class="w"> </span><span class="m">5.755393150671698</span><span class="w"> </span><span class="m">3.31535305846982</span><span class="w"> </span><span class="m">1.0501387543709164</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">2</span>
<span class="m">231</span><span class="w"> </span><span class="m">26</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">-</span><span class="m">0.55</span><span class="w"> </span><span class="m">5.617126717910301</span><span class="w"> </span><span class="m">7.487471864752421</span><span class="w"> </span><span class="m">1.963810241571427</span><span class="w"> </span><span class="o">-</span><span class="m">16</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="o">-</span><span class="m">3</span>
<span class="m">54</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">-</span><span class="m">0.55</span><span class="w"> </span><span class="m">4.060884959755418</span><span class="w"> </span><span class="m">1.6283060986470597</span><span class="w"> </span><span class="m">4.297860218329581</span><span class="w"> </span><span class="o">-</span><span class="m">7</span><span class="w"> </span><span class="o">-</span><span class="m">4</span><span class="w"> </span><span class="m">3</span>
<span class="m">174</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1.1</span><span class="w"> </span><span class="m">2.9926597997825395</span><span class="w"> </span><span class="m">2.0364512736354192</span><span class="w"> </span><span class="m">0.7520371846065788</span><span class="w"> </span><span class="o">-</span><span class="m">2</span><span class="w"> </span><span class="o">-</span><span class="m">6</span><span class="w"> </span><span class="o">-</span><span class="m">7</span>
<span class="m">180</span><span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">-</span><span class="m">0.55</span><span class="w"> </span><span class="m">3.18438907446254</span><span class="w"> </span><span class="m">2.5721052475107857</span><span class="w"> </span><span class="m">6.622363526485664</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">-</span><span class="m">12</span><span class="w"> </span><span class="m">1</span>
<span class="m">121</span><span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">-</span><span class="m">0.55</span><span class="w"> </span><span class="m">5.537222937373211</span><span class="w"> </span><span class="m">1.456250286791573</span><span class="w"> </span><span class="m">6.343752399466858</span><span class="w"> </span><span class="o">-</span><span class="m">9</span><span class="w"> </span><span class="o">-</span><span class="m">12</span><span class="w"> </span><span class="o">-</span><span class="m">4</span>
<span class="m">111</span><span class="w"> </span><span class="m">13</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1.1</span><span class="w"> </span><span class="m">1.7279273441891305</span><span class="w"> </span><span class="m">7.28674041911877</span><span class="w"> </span><span class="m">6.669158065545038</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="o">-</span><span class="m">10</span><span class="w"> </span><span class="o">-</span><span class="m">2</span>
<span class="m">51</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">-</span><span class="m">0.55</span><span class="w"> </span><span class="m">5.366932941422638</span><span class="w"> </span><span class="m">4.1504125630630435</span><span class="w"> </span><span class="m">2.3740196532457105</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="m">3</span>
<span class="m">202</span><span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">-</span><span class="m">0.55</span><span class="w"> </span><span class="m">7.313845702241226</span><span class="w"> </span><span class="m">3.321272888336706</span><span class="w"> </span><span class="m">3.777618751313188</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="o">-</span><span class="m">13</span>
<span class="m">215</span><span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">-</span><span class="m">0.55</span><span class="w"> </span><span class="m">6.690317849940269</span><span class="w"> </span><span class="m">5.754543737004929</span><span class="w"> </span><span class="m">4.103252634559489</span><span class="w"> </span><span class="o">-</span><span class="m">6</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0</span>
<span class="m">183</span><span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1.1</span><span class="w"> </span><span class="m">1.777618482333677</span><span class="w"> </span><span class="m">6.145548171417662</span><span class="w"> </span><span class="m">3.999369841948803</span><span class="w"> </span><span class="o">-</span><span class="m">5</span><span class="w"> </span><span class="o">-</span><span class="m">5</span><span class="w"> </span><span class="o">-</span><span class="m">3</span>
<span class="m">95</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">-</span><span class="m">0.55</span><span class="w"> </span><span class="m">4.561227581704491</span><span class="w"> </span><span class="m">2.3474960588346616</span><span class="w"> </span><span class="m">0.6330321107351076</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="m">6</span><span class="w"> </span><span class="m">3</span>
<span class="m">105</span><span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">-</span><span class="m">0.55</span><span class="w"> </span><span class="m">5.0710009155644125</span><span class="w"> </span><span class="m">3.8511969818510208</span><span class="w"> </span><span class="m">5.143556706337486</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">5</span>
<span class="nv">(...)</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Due to the use of vashishta force field, all silicon atoms have the same charge (1.1e),
and all oxygen atoms as well (-0.55e). This is common to most classical force field.
Let us keep that in mind before we start using reaxff.</p>
<p>The first step is to relax the structure, which we are gonna do using molecular
dynamcis. To make sure that system equilibrates nicely, let us track the changes in our system
over time.</p>
<p>Create an input file called input.lammps in RelaxSilica/, and copy in it:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in RelaxSilica/input.lammps</em></span><a class="headerlink" href="#id1" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">units</span><span class="w"> </span><span class="n">real</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">full</span>

<span class="k">read_data</span><span class="w"> </span><span class="n">silica.data</span>

<span class="k">mass</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">28.0855</span><span class="w"> </span><span class="c"># Si</span>
<span class="k">mass</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">15.999</span><span class="w"> </span><span class="c"># O</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>So far, the input is very similar to what is seen in the other tutorials here,
with some basic parameters being defined (units, atom_style and masses), and
our data file being read. Now let us enter 3 crucial lines:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in RelaxSilica/input.lammps</em></span><a class="headerlink" href="#id2" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">pair_style</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">safezone</span><span class="w"> </span><span class="m">3.0</span><span class="w"> </span><span class="n">mincap</span><span class="w"> </span><span class="m">150</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">reaxCHOFe.ff</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span>
<span class="k">fix </span><span class="nv nv-Identifier">myqeq</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">qeq</span><span class="o">/</span><span class="n">reaxff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">10.0</span><span class="w"> </span><span class="m">1.0e-6</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">maxiter</span><span class="w"> </span><span class="m">400</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>Here, the reaxff pair_style is used with no control file, and safezone and mincap
are there for memory allocation issue. If not there, the segmentation faults and bondchk
failed errors sometimes occur.</p>
<p>The pair_coeff uses the <a href="../../../../inputs/reactive-silicon-dioxide/RelaxSilica/reaxCHOFe.ff" target="_blank">reaxCHOFe.ff</a> file which is assumed to be saved in the same folder as the input.
The atoms of type 1 are set as silicon (Si),
and type 2 as oxygen (O) in order to be consistent with our .data file and previous mass definition.</p>
<p>Finally, qeq/reaxff is used to perform charge equilibration every timestep. The values 0 and 10.0
are low and high cutoffs, and 1.0e-6 a tolerance. Finally, maxiter sets a limit to the number of
attempt to equilibrate the charge. If the charge does not properly equilibrate
despite the 400 attempts, a warning will appear. Such warning are likely to appear if the initial
charges are too far from equilibrium values.</p>
<p>Then, let us insert some familiar commands controlling the building of the
neighbor lists. Let us also print thermodynamic information, the charge of both atom types,
and create a dump file for visualization.</p>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in RelaxSilica/input.lammps</em></span><a class="headerlink" href="#id3" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">neighbor</span><span class="w"> </span><span class="m">0.5</span><span class="w"> </span><span class="n">bin</span>
<span class="k">neigh_modify</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="n">delay</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">yes</span>

<span class="k">group </span><span class="nv nv-Identifier">grpSi</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">1</span>
<span class="k">group </span><span class="nv nv-Identifier">grpO</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">2</span>
<span class="k">variable </span><span class="nv nv-Identifier">totqSi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpSi)</span>
<span class="k">variable </span><span class="nv nv-Identifier">totqO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpO)</span>
<span class="k">variable </span><span class="nv nv-Identifier">nSi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">count</span><span class="nv">(grpSi)</span>
<span class="k">variable </span><span class="nv nv-Identifier">nO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">count</span><span class="nv">(grpO)</span>
<span class="k">variable </span><span class="nv nv-Identifier">qSi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">v_totqSi</span><span class="o">/</span><span class="nv">${nSi}</span>
<span class="k">variable </span><span class="nv nv-Identifier">qO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">v_totqO</span><span class="o">/</span><span class="nv">${nO}</span>

<span class="k">dump </span><span class="nv nv-Identifier">dmp</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="n">dump.lammpstrj</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">z</span>
<span class="k">thermo</span><span class="w"> </span><span class="m">10</span>
<span class="k">thermo_style</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">etotal</span><span class="w"> </span><span class="n">press</span><span class="w"> </span><span class="n">vol</span><span class="w"> </span><span class="n">v_qSi</span><span class="w"> </span><span class="n">v_qO</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>Let us perform a very short
run using anisotropic NPT command, thus allowing for the box
volume to relax.</p>
</div>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in RelaxSilica/input.lammps</em></span><a class="headerlink" href="#id4" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">velocity</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">3482028</span>
<span class="k">fix </span><span class="nv nv-Identifier">mynpt</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">npt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="n">aniso</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">100</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.5</span>

<span class="k">run</span><span class="w"> </span><span class="m">2000</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>Here, I choose values of 10 fs for the temperature damping parameter and 100 fs
for the pressure. These choices were made to reach equilibrium faster and
allow very short run to be performed. For an actual simulation (and not a tutorial), longer equilibration
and larger damping times should be used (100 fs and 1000 fs for temperature and pressure respectively are
usually used for atomic systems).</p>
<p>As the simulation runs, you can see that the charges of the atoms are fluctuating,
as it adjusts to the topology:</p>
</div>
<figure class="align-default">
<img alt="Charge of silica during equilibration with reaxff and LAMMPS" class="only-light" src="../_images/average-charge-light.png" />
</figure>
<figure class="align-default" id="id5">
<img alt="Charge of silica during equilibration with reaxff and LAMMPS" class="only-dark" src="../_images/average-charge-dark.png" />
<figcaption>
<p><span class="caption-text">Average charge of the silicon (Si) atoms during equilibration using reaxff.</span><a class="headerlink" href="#id5" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="justify docutils container">
<p>Moreover, as each atom instantaneously adopts its own charge value, the charges are distributed
around a mean value:</p>
</div>
<figure class="align-default">
<img alt="Distribution charge of silica and oxygen during equilibration with reaxff" class="only-light" src="../_images/distribution-charge-light.png" />
</figure>
<figure class="align-default" id="id6">
<img alt="Distribution charge of silica and oxygen during equilibration with reaxff" class="only-dark" src="../_images/distribution-charge-dark.png" />
<figcaption>
<p><span class="caption-text">Distribution of charge of silicon (positive) and oxygen (negative) atoms during equilibration. The data
were extracted from the dump.lammpstrj file using python, you can
download this <a href="../../../../inputs/reactive-silicon-dioxide/RelaxSilica/plot_distribution.ipynb" target="_blank">notebook</a> to plot the charge distribution using Python, NumPy, and Matplotlib.</span><a class="headerlink" href="#id6" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="justify docutils container">
<p>Using VMD and coloring the atoms by their charges, one can see that
the atoms with the extreme-most charges are located at defects in the
amorphous structure (here at the positions of the dandling oxygen group):</p>
</div>
<figure class="align-default">
<img alt="Amorphous silica colored by charges using VMD" class="only-light" src="../_images/silicon-light.png" />
</figure>
<figure class="align-default" id="id7">
<img alt="Amorphous silica colored by charges using VMD" class="only-dark" src="../_images/silicon-dark.png" />
<figcaption>
<p><span class="caption-text">Amorphous silica colored by charges using VMD. Dandling oxygen groups appear in green.</span><a class="headerlink" href="#id7" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="justify docutils container">
<p>Note for VMD user: to color the atoms by their charge, use <em>Charge</em> as coloring method in the
representation windows, and then tune the <em>Color scale</em> in the <em>Color control windows</em>.</p>
</div>
<div class="patreon admonition">
<p class="admonition-title">Support me for 1 euro per month</p>
<p>Become a <a href="https://www.patreon.com/molecularsimulations" target="_blank">Patreon</a> and support the creation of content for LAMMPS</p>
</div>
</section>
<section id="deform-the-structure">
<h2>Deform the structure<a class="headerlink" href="#deform-the-structure" title="Permalink to this heading">#</a></h2>
<div class="justify docutils container">
<p>Let us apply a deformation to the structure in order to force some bonds
to dynamically break and reassemble.</p>
<p>Next to RelaxSilica/, create a folder, call it Deform/ and create a
file named input.lammps in it. Copy the following lines:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in Deform/input.lammps</em></span><a class="headerlink" href="#id8" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># SiO amorphous silica deformed with reaxff potential</span>

<span class="k">units</span><span class="w"> </span><span class="n">real</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">full</span>

<span class="k">read_data</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">RelaxSilica</span><span class="o">/</span><span class="n">silica</span><span class="o">-</span><span class="n">relaxed.data</span>

<span class="k">mass</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">28.0855</span><span class="w"> </span><span class="c"># Si</span>
<span class="k">mass</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">15.999</span><span class="w"> </span><span class="c"># O</span>

<span class="k">pair_style</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">safezone</span><span class="w"> </span><span class="m">3.0</span><span class="w"> </span><span class="n">mincap</span><span class="w"> </span><span class="m">150</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">RelaxSilica</span><span class="o">/</span><span class="n">reaxCHOFe.ff</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span>
<span class="k">fix </span><span class="nv nv-Identifier">myqeq</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">qeq</span><span class="o">/</span><span class="n">reaxff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">10.0</span><span class="w"> </span><span class="m">1.0e-6</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">maxiter</span><span class="w"> </span><span class="m">400</span>

<span class="k">neighbor</span><span class="w"> </span><span class="m">0.5</span><span class="w"> </span><span class="n">bin</span>
<span class="k">neigh_modify</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="n">delay</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">yes</span>

<span class="k">group </span><span class="nv nv-Identifier">grpSi</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">1</span>
<span class="k">group </span><span class="nv nv-Identifier">grpO</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">2</span>
<span class="k">variable </span><span class="nv nv-Identifier">totqSi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpSi)</span>
<span class="k">variable </span><span class="nv nv-Identifier">totqO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpO)</span>
<span class="k">variable </span><span class="nv nv-Identifier">nSi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">count</span><span class="nv">(grpSi)</span>
<span class="k">variable </span><span class="nv nv-Identifier">nO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">count</span><span class="nv">(grpO)</span>
<span class="k">variable </span><span class="nv nv-Identifier">qSi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">v_totqSi</span><span class="o">/</span><span class="nv">${nSi}</span>
<span class="k">variable </span><span class="nv nv-Identifier">qO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">v_totqO</span><span class="o">/</span><span class="nv">${nO}</span>

<span class="k">dump </span><span class="nv nv-Identifier">dmp</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="n">dump</span><span class="o">-</span><span class="n">deform.lammpstrj</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">z</span>
<span class="k">thermo</span><span class="w"> </span><span class="m">100</span>
<span class="k">thermo_style</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">etotal</span><span class="w"> </span><span class="n">press</span><span class="w"> </span><span class="n">vol</span><span class="w"> </span><span class="n">v_qSi</span><span class="w"> </span><span class="n">v_qO</span>

<span class="k">fix </span><span class="nv nv-Identifier">mynvt</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nvt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">100</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.5</span>

<span class="k">run</span><span class="w"> </span><span class="m">2000</span>

<span class="k">fix </span><span class="nv nv-Identifier">mydef</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">deform</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">erate</span><span class="w"> </span><span class="m">5e-5</span>

<span class="k">run</span><span class="w"> </span><span class="m">25000</span>
<span class="k">unfix </span><span class="nv nv-Identifier">mydef</span>
<span class="k">undump </span><span class="nv nv-Identifier">dmp</span>

<span class="k">dump </span><span class="nv nv-Identifier">dmp</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="n">dump.lammpstrj</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">z</span>

<span class="k">run</span><span class="w"> </span><span class="m">2000</span>

<span class="k">write_data</span><span class="w"> </span><span class="n">silica</span><span class="o">-</span><span class="n">deformed.data</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>The main differences with the previous input are</p>
<ul class="simple">
<li><p>the use of fix deform for elongating progressively the box along x,</p></li>
<li><p>the use of fix NVT instead of NPT (because the box deformation is already ensured by fix deform).</p></li>
</ul>
<p>After a first run of 25000 steps, a short run of 2000 steps is performed
in order to extract the final charges of the atoms from an structure that is not
under deformation.</p>
<p>During the deformation, the charges progressively changes, until the structure eventually
breaks up. After the structure breaks, the charges equilibrates near a new
average value that differs from the starting charge, which is expected due to the
presence of the new solid/vacuum interface:</p>
</div>
<figure class="align-default">
<img alt="Charge of silica during deformation of the silicon oxide with LAMMPS and reaxff" class="only-light" src="../_images/deformed-charge-light.png" />
</figure>
<figure class="align-default" id="id9">
<img alt="Charge of silica during deformation of the silicon oxide with LAMMPS and reaxff" class="only-dark" src="../_images/deformed-charge-dark.png" />
<figcaption>
<p><span class="caption-text">Charge of silica during deformation of the silicon oxide block using LAMMPS and reaxff. The vertical
dashed lines show the limit of the 3 consecutive runs of respective durations; 2000 steps (or 1000 fs),
25000 steps, and 2000 steps.</span><a class="headerlink" href="#id9" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="justify docutils container">
<p>At the end of the deformation,  one can visualize the broken material. Notice
the different charge of the atoms located near the interface and compared to the
atoms located in the bulk of the material:</p>
</div>
<figure class="align-default">
<img alt="Deformed amorphous silica colored by charges using VMD" class="only-light" src="../_images/deformed-light1.png" />
</figure>
<figure class="align-default" id="id10">
<img alt="Deformed amorphous silica colored by charges using VMD" class="only-dark" src="../_images/deformed-dark1.png" />
<figcaption>
<p><span class="caption-text">Amorphous silicon oxide after deformation. The atoms are colored by charges using VMD.</span><a class="headerlink" href="#id10" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="justify docutils container">
<p>One O2 molecule was formed during the process (here appearing in green),
most likely because the rate of deformation was really high.</p>
<p>One can have a look at the final charge distribution:</p>
</div>
<figure class="align-default">
<img alt="Distribution charge of silica and oxygen during equilibration with reaxff" class="only-light" src="../_images/deformed-distribution-charge-light.png" />
</figure>
<figure class="align-default" id="id11">
<img alt="Distribution charge of silica and oxygen during equilibration with reaxff" class="only-dark" src="../_images/deformed-distribution-charge-dark.png" />
<figcaption>
<p><span class="caption-text">Distribution of charge of silica (positive) and oxygen (negative) after deformation.
The small dots correspond are the charge measured with the previous undeformed
structure. Notice the difference near q=-0.5e and q=1.25e.</span><a class="headerlink" href="#id11" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="justify docutils container">
<p>The final charge distribution differs from the previously calculated, as a new peak
near -0.5e for the oxygen.</p>
</div>
</section>
<section id="add-o2-molecules">
<h2>Add O2 molecules<a class="headerlink" href="#add-o2-molecules" title="Permalink to this heading">#</a></h2>
<div class="justify docutils container">
<p>Let us add more O2 molecule to our previously equilibrated structure, equilibrate it again,
and extract the charge density profile along the x axis.</p>
<p>Create a new folder, named it AddOxygen, and create a new molecule file in it:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in AddOxygen/O2.mol</em></span><a class="headerlink" href="#id12" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># O2 reaxff file</span>

<span class="m">2</span><span class="w"> </span><span class="n">atoms</span>

<span class="n">Coords</span>

<span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="m">0.6</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="m">2</span><span class="w"> </span><span class="m">0.6</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>

<span class="n">Types</span>

<span class="m">1</span><span class="w">        </span><span class="m">2</span>
<span class="m">2</span><span class="w">        </span><span class="m">2</span>

<span class="n">Charges</span>

<span class="m">1</span><span class="w">   </span><span class="m">0.0</span>
<span class="m">2</span><span class="w">   </span><span class="m">0.0</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>This O2 molecule is simply made of 2 oxygen (type 2) atoms that are not
connected by any bond (because there is no need with reaxff).</p>
<p>Then, create a new input.lammps file, and copy the same first lines as
previously in it:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id13">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in AddOxygen/input.lammps</em></span><a class="headerlink" href="#id13" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">units</span><span class="w"> </span><span class="n">real</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">full</span>

<span class="k">read_data</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">Deform</span><span class="o">/</span><span class="n">silica</span><span class="o">-</span><span class="n">deformed.data</span>

<span class="k">mass</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">28.0855</span><span class="w"> </span><span class="c"># Si</span>
<span class="k">mass</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">15.999</span><span class="w"> </span><span class="c"># O</span>

<span class="k">pair_style</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">safezone</span><span class="w"> </span><span class="m">3.0</span><span class="w"> </span><span class="n">mincap</span><span class="w"> </span><span class="m">150</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">RelaxSilica</span><span class="o">/</span><span class="n">reaxCHOFe.ff</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span>
<span class="k">fix </span><span class="nv nv-Identifier">myqeq</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">qeq</span><span class="o">/</span><span class="n">reaxff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">10.0</span><span class="w"> </span><span class="m">1.0e-6</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">maxiter</span><span class="w"> </span><span class="m">400</span>

<span class="k">neighbor</span><span class="w"> </span><span class="m">0.5</span><span class="w"> </span><span class="n">bin</span>
<span class="k">neigh_modify</span><span class="w"> </span><span class="n">every</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="n">delay</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">yes</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>Optionally, let us shift the structure to recenter it in the box. The best value
for the shift may be different in your case. This step is not necessary.</p>
</div>
<div class="literal-block-wrapper docutils container" id="id14">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in AddOxygen/input.lammps</em></span><a class="headerlink" href="#id14" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">displace_atoms</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="o">-</span><span class="m">13</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">units</span><span class="w"> </span><span class="n">box</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>Then, let us import the molecule template O2.mol and create 10 molecules.
The overlap and maxtry keywords allow us to prevent overlapping between the atoms:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id15">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in AddOxygen/input.lammps</em></span><a class="headerlink" href="#id15" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">molecule</span><span class="w"> </span><span class="n">O2mol</span><span class="w"> </span><span class="n">O2.mol</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">456415</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">mol</span><span class="w"> </span><span class="n">O2mol</span><span class="w"> </span><span class="m">454756</span><span class="w"> </span><span class="n">overlap</span><span class="w"> </span><span class="m">3.0</span><span class="w"> </span><span class="n">maxtry</span><span class="w"> </span><span class="m">50</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>Finally, let us minimize the energy of the system, and run for a relatively long time:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id16">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in AddOxygen/input.lammps</em></span><a class="headerlink" href="#id16" title="Permalink to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">minimize</span><span class="w"> </span><span class="m">1.0e-4</span><span class="w"> </span><span class="m">1.0e-6</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">1000</span>
<span class="k">reset_timestep</span><span class="w"> </span><span class="m">0</span>

<span class="k">group </span><span class="nv nv-Identifier">grpSi</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">1</span>
<span class="k">group </span><span class="nv nv-Identifier">grpO</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">2</span>
<span class="k">variable </span><span class="nv nv-Identifier">totqSi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpSi)</span>
<span class="k">variable </span><span class="nv nv-Identifier">totqO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpO)</span>
<span class="k">variable </span><span class="nv nv-Identifier">nSi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">count</span><span class="nv">(grpSi)</span>
<span class="k">variable </span><span class="nv nv-Identifier">nO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">count</span><span class="nv">(grpO)</span>
<span class="k">variable </span><span class="nv nv-Identifier">qSi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">v_totqSi</span><span class="o">/</span><span class="nv">${nSi}</span>
<span class="k">variable </span><span class="nv nv-Identifier">qO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">v_totqO</span><span class="o">/</span><span class="nv">${nO}</span>

<span class="k">dump </span><span class="nv nv-Identifier">dmp</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">dump.lammpstrj</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">z</span>
<span class="k">thermo</span><span class="w"> </span><span class="m">1000</span>
<span class="k">thermo_style</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">etotal</span><span class="w"> </span><span class="n">press</span><span class="w"> </span><span class="n">vol</span><span class="w"> </span><span class="n">v_qSi</span><span class="w"> </span><span class="n">v_qO</span>

<span class="k">fix </span><span class="nv nv-Identifier">mynvt</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nvt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">100</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.5</span>

<span class="k">run</span><span class="w"> </span><span class="m">100000</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>Run the simulation. You should seen additional O2 molecules in the system:</p>
</div>
<figure class="align-default">
<img alt="Silicon oxide with additional O2 molecules" class="only-light" src="../_images/O2_light.png" />
</figure>
<figure class="align-default" id="id17">
<img alt="Silicon oxide with additional O2 molecules" class="only-dark" src="../_images/O2_dark.png" />
<figcaption>
<p><span class="caption-text">Deformed structure with additional O2 molecules</span><a class="headerlink" href="#id17" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>You can access all the input scripts and data files that
are used in these tutorials from <a href="https://github.com/lammpstutorials/lammpstutorials.github.io/tree/version2.0/docs/inputs" target="_blank">Github</a>.</p>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this heading">#</a></h2>
<div class="justify docutils container">
<div class="solution admonition">
<p class="admonition-title">Solutions</p>
<p>Request the solutions by <a class="reference external" href="mailto:simon&#46;gravelle&#37;&#52;&#48;live&#46;fr">email</a>, or register as a <a href="https://www.patreon.com/molecularsimulations" target="_blank">Patreon</a> for 1 euro/month
to access all the solutions as well as additional LAMMPS content and access
an active LAMMPS dedicated forum.</p>
</div>
</div>
<div class="justify docutils container">
<p>Under ambient conditions, dandling oxygen are typically terminated by hydrogen atoms.
Let us improve the current structure by decorating some of the dandling oxygen with
hydrogen atoms, before relaxing it thanks to reaxff.</p>
<p>Add hydrogen atoms to the dandling oxygens. Then relax the structure using reaxff with LAMMPS.
Hydrogen atoms can be added using create_atoms command, gcmc, or external python script as I did here:</p>
</div>
<figure class="align-default">
<img alt="Silicon oxide decorated with hydrogens" class="only-light" src="../_images/exercice-light.png" />
</figure>
<figure class="align-default" id="id18">
<img alt="Silicon oxide decorated with hydrogens" class="only-dark" src="../_images/exercice-dark.png" />
<figcaption>
<p><span class="caption-text">Hydrogen atoms are in white, oxygen in red, and silicon in yellow.</span><a class="headerlink" href="#id18" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="dropdown admonition">
<p class="admonition-title">Hint n1</p>
<div class="justify docutils container">
<p>The structure can be imported in MDAnalysis/Python using:</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">mda</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="s2">&quot;silica-deformed.data&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Then dandling oxygen can be detected by counting the number of neighbor (oxygen with only
one connected silicon is dandling and should be completed with an hydrogen).</p>
</div>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Hint n2</p>
<div class="justify docutils container">
<p>Once hydrogen have been added, run LAMMPS using:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">mass</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">28.0855</span><span class="w"> </span><span class="c"># Si</span>
<span class="k">mass</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">15.999</span><span class="w"> </span><span class="c"># O</span>
<span class="k">mass</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">1.008</span><span class="w"> </span><span class="c"># H</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>and:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">reaxCHOFe.ff</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span><span class="w"> </span><span class="n">H</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<div class="mail admonition">
<p class="admonition-title">Contact me</p>
<p>Feel free to <a class="reference internal" href="../contact/contact.html#contact-label"><span class="std std-ref">Contact me</span></a> me if you have any question or suggestion about these tutorials.</p>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../contact/contact.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Contact me</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="surface-profile.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Adsorption of ethanol</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Reactive silicon dioxide</a><ul>
<li><a class="reference internal" href="#relax-the-structure">Relax the structure</a></li>
<li><a class="reference internal" href="#deform-the-structure">Deform the structure</a></li>
<li><a class="reference internal" href="#add-o2-molecules">Add O2 molecules</a></li>
<li><a class="reference internal" href="#exercises">Exercises</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    </body>
</html>