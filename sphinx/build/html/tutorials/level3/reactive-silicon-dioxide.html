<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="../../_static/favicon-32x32.png" sizes="32x32" rel="icon" type="image/png"><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Water adsorption in silica" href="water-adsorption-in-silica.html" /><link rel="prev" title="Nanosheared electrolyte" href="../level2/nanosheared-electrolyte.html" />

    <!-- Generated with Sphinx 7.3.7 and Furo 2024.04.27 -->
        <title>Reactive silicon dioxide - </title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=437aa6ec" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=4c6e8526" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">    </div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">    </span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../non-tutorials/before-you-start.html">Before you start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../non-tutorials/contact-me.html">Contact me</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../level1/lennard-jones-fluid.html">Lennard-Jones fluid</a></li>
<li class="toctree-l1"><a class="reference internal" href="../level1/breaking-a-carbon-nanotube.html">Pulling on a carbon nanotube</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../level2/polymer-in-water.html">Polymer in water</a></li>
<li class="toctree-l1"><a class="reference internal" href="../level2/nanosheared-electrolyte.html">Nanosheared electrolyte</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 3</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Reactive silicon dioxide</a></li>
<li class="toctree-l1"><a class="reference internal" href="water-adsorption-in-silica.html">Water adsorption in silica</a></li>
<li class="toctree-l1"><a class="reference internal" href="free-energy-calculation.html">Free energy calculation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extra tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vmd/vmd-tutorial.html">VMD tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mdanalysis/mdanalysis-tutorial.html">MDAnalysis tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bash/bash-tutorial.html">Bash tutorial</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extra content</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../non-tutorials/solutions.html">Solutions to the exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../non-tutorials/glossary.html">LAMMPS Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../non-tutorials/bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../miscellaneous/use-gromacs-instead.html">Use GROMACS instead</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="reactive-silicon-dioxide">
<span id="reactive-silicon-dioxide-label"></span><h1>Reactive silicon dioxide<a class="headerlink" href="#reactive-silicon-dioxide" title="Link to this heading">¶</a></h1>
<div class="hatnote docutils container">
<p>Simulating a chemically reactive structure</p>
</div>
<figure class="align-right">
<a class="only-light reference internal image-reference" href="../../_images/SiO_gif_light.webp"><img alt="Figure showing silicon dioxide structure with colored charges as simulated with lammps and reaxff" class="only-light" src="../../_images/SiO_gif_light.webp" style="height: 250px;" />
</a>
</figure>
<figure class="align-right">
<a class="only-dark reference internal image-reference" href="../../_images/SiO_gif_dark.webp"><img alt="Figure showing silicon dioxide structure with colored charges as simulated with lammps and reaxff" class="only-dark" src="../../_images/SiO_gif_dark.webp" style="height: 250px;" />
</a>
</figure>
<div class="justify docutils container">
<p>The objective of this tutorial is to use a
reactive force field (<em>ReaxFF</em> <span id="id1">[<a class="reference internal" href="../../non-tutorials/bibliography.html#id34" title="Adri CT Van Duin, Siddharth Dasgupta, Francois Lorant, and William A Goddard. ReaxFF: a reactive force field for hydrocarbons. The Journal of Physical Chemistry A, 105(41):9396–9409, 2001.">31</a>, <a class="reference internal" href="../../non-tutorials/bibliography.html#id33" title="Chenyu Zou and Adri Van Duin. Investigation of complex iron surface catalytic chemistry using the ReaxFF reactive force field method. Jom, 64:1426–1437, 2012.">32</a>]</span>),
and calculate the partial charges of a system undergoing
deformation, as well as chemical bond formation and breaking.</p>
</div>
<div class="justify docutils container">
<p>The system simulated here is a block of silicon dioxide (SiO2), that is deformed
until rupture. Particular attention is given to the evolution of the charges
of the atoms during the deformation of the structure, and
the chemical reactions occurring due to the deformation
are tracked.</p>
</div>
<div class="justify docutils container">
<p>If you are completely new to LAMMPS, I recommend that
you follow this tutorial on a simple <a class="reference internal" href="../level1/lennard-jones-fluid.html#lennard-jones-label"><span class="std std-ref">Lennard-Jones fluid</span></a> first.</p>
</div>
<div class="patreon admonition">
<p class="admonition-title">Looking for support in molecular simulations?</p>
<p>I provide <a href="https://www.patreon.com/molecularsimulations" target="_blank">assistance</a> for LAMMPS projects.
See the <a class="reference internal" href="../../non-tutorials/contact-me.html#contact-label"><span class="std std-ref">Contact me</span></a> page.</p>
</div>
<div class="version docutils container">
<p>This tutorial is compatible with the 2Aug2023 LAMMPS version.</p>
</div>
<section id="prepare-and-relax">
<h2>Prepare and relax<a class="headerlink" href="#prepare-and-relax" title="Link to this heading">¶</a></h2>
<div class="justify docutils container">
<p>Create a folder, name it <em>RelaxSilica/</em>,
and <a href="../../../../../lammpstutorials-inputs/level3/reactive-silicon-dioxide/RelaxSilica/silica.data" target="_blank">download</a> the initial topology of a small
amorphous silica structure.</p>
</div>
<div class="info admonition">
<p class="admonition-title">About the initial structure</p>
<p>The system was created by temperature annealing using another force field
named <a href="../../../../../lammpstutorials-inputs/level3/reactive-silicon-dioxide/CreateSilica/SiO.1990.vashishta" target="_blank">vashishta</a>. In case you are
interested in the input creation, the files
used for creating the initial topology is available
<a href="../../../../../lammpstutorials-inputs/level3/reactive-silicon-dioxide/CreateSilica/input.lammps" target="_blank">here</a>.</p>
</div>
<div class="justify docutils container">
<p>If you open the <em>silica.data</em> file, you can see
by looking at the Atoms section that
all silicon atoms have the same charge <span class="math notranslate nohighlight">\(q = 1.1\,\text{e}\)</span>,
and all oxygen atoms the charge <span class="math notranslate nohighlight">\(q = -0.55\,\text{e}\)</span>.
This is common with classical force field and will change once
<em>ReaxFF</em> is used. Let us keep that in mind for now.</p>
</div>
<div class="justify docutils container">
<p>The first step we need to perform here is to relax
the structure with <em>ReaxFF</em>, which we are gonna do using molecular
dynamics. To make sure that the system equilibrates
nicely, let us track some changes over time.</p>
</div>
<div class="justify docutils container">
<p>Create an input file called <em>input.lammps</em> in <em>RelaxSilica/</em>,
and copy the following lines in it:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">units</span><span class="w"> </span><span class="n">real</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">full</span>

<span class="k">read_data</span><span class="w"> </span><span class="n">silica.data</span>

<span class="k">mass</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">28.0855</span><span class="w"> </span><span class="c"># Si</span>
<span class="k">mass</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">15.999</span><span class="w"> </span><span class="c"># O</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>So far, the input is very similar to what was seen
in the previous tutorials. Some basic parameters are
defined (<em>units</em>, <em>atom_style</em> and <em>masses</em>), and
the <em>.data</em> file is imported by the <em>read_data</em> command.
Now let us enter 3 crucial lines in the <em>input.lammps</em> file:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">pair_style</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">safezone</span><span class="w"> </span><span class="m">3.0</span><span class="w"> </span><span class="n">mincap</span><span class="w"> </span><span class="m">150</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">reaxCHOFe.ff</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span>
<span class="k">fix </span><span class="nv nv-Identifier">myqeq</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">qeq</span><span class="o">/</span><span class="n">reaxff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">10.0</span><span class="w"> </span><span class="m">1.0e-6</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">maxiter</span><span class="w"> </span><span class="m">400</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Here, the <em>ReaxFF pair_style</em> is used with no control file.
The <em>safezone</em> and <em>mincap</em> keywords have been added
to avoid memory allocation issues, which sometimes can trigger
the segmentation faults and <em>bondchk</em> failed errors.</p>
</div>
<div class="justify docutils container">
<p>The <em>pair_coeff</em> uses
the <a href="../../../../../lammpstutorials-inputs/level3/reactive-silicon-dioxide/RelaxSilica/reaxCHOFe.ff" target="_blank">reaxCHOFe.ff</a> file which is assumed
to be saved within <em>RelaxSilica/</em>.
For consistency, the atoms of type 1 are set as silicon (Si),
and the atoms of type 2 as oxygen (O).</p>
</div>
<div class="justify docutils container">
<p>Finally, the <em>fix qeq/reaxff</em> is used to perform charge equilibration. The charge
equilibration occurs at every step. The values 0.0 and 10.0
are the low and the high cutoffs, respectively, and <span class="math notranslate nohighlight">\(1.0 \text{e} -6\)</span> is a
tolerance. Finally, <em>maxiter</em> sets an upper limit to the number of attempts to
equilibrate the charge.</p>
</div>
<div class="info admonition">
<p class="admonition-title">Note</p>
<p>If the charge does not
properly equilibrate despite the 400 attempts, a warning will appear. Such warnings
are likely to appear at the beginning of the simulation if the initial charges
are too far from the equilibrium values.</p>
</div>
<div class="justify docutils container">
<p>Then, let us add some commands to the <em>input.lammps</em> file
to measure the evolution of the charges during the simulation:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">group </span><span class="nv nv-Identifier">grpSi</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">1</span>
<span class="k">group </span><span class="nv nv-Identifier">grpO</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">2</span>
<span class="k">variable </span><span class="nv nv-Identifier">qSi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpSi)</span><span class="o">/</span><span class="n">count</span><span class="nv">(grpSi)</span>
<span class="k">variable </span><span class="nv nv-Identifier">qO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpO)</span><span class="o">/</span><span class="n">count</span><span class="nv">(grpO)</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Let us also print the charge in the <em>.log</em> file by using <em>thermo_style</em>,
and create a <em>.lammpstrj</em> file for visualization.
Add the following lines to the <em>input.lammps</em>:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">thermo</span><span class="w"> </span><span class="m">5</span>
<span class="k">thermo_style</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">etotal</span><span class="w"> </span><span class="n">press</span><span class="w"> </span><span class="n">vol</span><span class="w"> </span><span class="n">v_qSi</span><span class="w"> </span><span class="n">v_qO</span>
<span class="k">dump </span><span class="nv nv-Identifier">dmp</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="n">dump.lammpstrj</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">z</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Let us also use the <em>fix reaxff/species</em> to evaluate what
species are present within the simulation. It will
be useful later when the system is deformed:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">myspec</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">reaxff</span><span class="o">/</span><span class="n">species</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="n">species.log</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Here, the information will be printed every 5 steps in a
file named <em>species.log</em>.</p>
</div>
<div class="justify docutils container">
<p>Let us perform a very short run using the anisotropic NPT command
and relax the density of the system.</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">velocity </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">3482028</span>
<span class="k">fix </span><span class="nv nv-Identifier">mynpt</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">npt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="n">aniso</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">1000</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.5</span>

<span class="k">run</span><span class="w"> </span><span class="m">5000</span>

<span class="k">write_data </span><span class="nv nv-Identifier">silica-relaxed.data</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Run the <em>input.lammps</em> file using LAMMPS. As can be seen from <em>species.log</em>,
only one species is detected, called <em>Si192O384</em>, which is the entire system.</p>
</div>
<div class="justify docutils container">
<p>As the simulation progresses, you can see that the charges of the atoms are fluctuating
since the charge of every individual atom is adjusting to its local environment.</p>
</div>
<figure class="align-default">
<img alt="Charge of silica during equilibration with reaxff and LAMMPS" class="only-light" src="../../_images/average-charge-light.png" />
</figure>
<figure class="align-default">
<img alt="Charge of silica during equilibration with reaxff and LAMMPS" class="only-dark" src="../../_images/average-charge-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Average charge per atom of the silicon (a) and oxygen (b)
atoms during equilibration, as given by the
<em>v_qSi</em> and <em>v_qO</em> variables.</p>
</div>
<div class="justify docutils container">
<p>One can see that the charges of the atoms are strongly fluctuating
at the beginning of the simulation. This early fluctuation correlates
with a rapid volume change of the box, during which
the inter-atomic distances are expected to quickly change.</p>
</div>
<figure class="align-default">
<img alt="volume of the system with reaxff and LAMMPS" class="only-light" src="../../_images/volume-light.png" />
</figure>
<figure class="align-default">
<img alt="volume of the system with reaxff and LAMMPS" class="only-dark" src="../../_images/volume-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Volume of the system as a function of time.</p>
</div>
<div class="justify docutils container">
<p>Since each atom has a charge that depends on its local environment,
the charge values are expected to be different for every atom in the system.
We can plot the charge distribution <span class="math notranslate nohighlight">\(P(q)\)</span>, using the charge values
printed in the <em>.lammptrj</em> file.</p>
</div>
<figure class="align-default">
<img alt="Distribution charge of silica and oxygen during equilibration with reaxff" class="only-light" src="../../_images/distribution-charge-light.png" />
</figure>
<figure class="align-default">
<img alt="Distribution charge of silica and oxygen during equilibration with reaxff" class="only-dark" src="../../_images/distribution-charge-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Probability distribution of charge of silicon (positive, blue)
and oxygen (negative, orange) atoms during equilibration.</p>
</div>
<div class="justify docutils container">
<p>Using VMD and coloring the atoms by their charges, one can see that
the atoms with the extreme-most charges are located at defects in the
amorphous structure (here at the positions of the dandling oxygen groups).</p>
</div>
<figure class="align-default">
<img alt="Amorphous silica colored by charges using VMD" class="only-light" src="../../_images/silicon-light.png" />
</figure>
<figure class="align-default">
<img alt="Amorphous silica colored by charges using VMD" class="only-dark" src="../../_images/silicon-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: A slice of the amorphous silica, where atoms are colored by their
charges. Dandling oxygen groups appear in greenish, bulk Si atoms with a
charge of about 1.8e appear in red/orange, and bulk O atoms with a charge of
about <span class="math notranslate nohighlight">\(-0.9\text{e}\)</span> appear in blue. To color the atoms by their
charge using VMD, use <em>Charge</em> as the coloring method in the representation
windows, and then tune the <em>Color scale</em> in the <em>Color control windows</em>.</p>
</div>
</section>
<section id="deform-the-structure">
<h2>Deform the structure<a class="headerlink" href="#deform-the-structure" title="Link to this heading">¶</a></h2>
<div class="justify docutils container">
<p>Let us apply a deformation to the structure to force some
<span class="math notranslate nohighlight">\(\text{Si}-\text{O}\)</span> bonds to break and re-assemble.</p>
</div>
<div class="justify docutils container">
<p>Next to <em>RelaxSilica/</em>, create a folder, call it <em>Deform/</em> and create a
file named <em>input.lammps</em> in it. Copy the same lines as previously in
<em>input.lammps</em>:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">units</span><span class="w"> </span><span class="n">real</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">full</span>

<span class="k">read_data</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">RelaxSilica</span><span class="o">/</span><span class="n">silica</span><span class="o">-</span><span class="n">relaxed.data</span>

<span class="k">mass</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">28.0855</span><span class="w"> </span><span class="c"># Si</span>
<span class="k">mass</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">15.999</span><span class="w"> </span><span class="c"># O</span>

<span class="k">pair_style</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">safezone</span><span class="w"> </span><span class="m">3.0</span><span class="w"> </span><span class="n">mincap</span><span class="w"> </span><span class="m">150</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">RelaxSilica</span><span class="o">/</span><span class="n">reaxCHOFe.ff</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span>
<span class="k">fix </span><span class="nv nv-Identifier">myqeq</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">qeq</span><span class="o">/</span><span class="n">reaxff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">10.0</span><span class="w"> </span><span class="m">1.0e-6</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">maxiter</span><span class="w"> </span><span class="m">400</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>The only differences with the previous <em>input.lammps</em> file are the
paths to the <em>.data</em> and <em>.ff</em> files located within <em>RelaxSilica/</em>.
Copy the following lines as well:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">group </span><span class="nv nv-Identifier">grpSi</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">1</span>
<span class="k">group </span><span class="nv nv-Identifier">grpO</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">2</span>
<span class="k">variable </span><span class="nv nv-Identifier">qSi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpSi)</span><span class="o">/</span><span class="n">count</span><span class="nv">(grpSi)</span>
<span class="k">variable </span><span class="nv nv-Identifier">qO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpO)</span><span class="o">/</span><span class="n">count</span><span class="nv">(grpO)</span>

<span class="k">thermo</span><span class="w"> </span><span class="m">5</span>
<span class="k">thermo_style</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">etotal</span><span class="w"> </span><span class="n">press</span><span class="w"> </span><span class="n">vol</span><span class="w"> </span><span class="n">v_qSi</span><span class="w"> </span><span class="n">v_qO</span>
<span class="k">dump </span><span class="nv nv-Identifier">dmp</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="n">dump.lammpstrj</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">z</span>

<span class="k">fix </span><span class="nv nv-Identifier">myspec</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">reaxff</span><span class="o">/</span><span class="n">species</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="n">species.log</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Then, let us use <em>fix nvt</em> instead of <em>fix npt</em> to apply a
thermostat but no barostat:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">mynvt</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nvt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">100</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.5</span>
</pre></div>
</div>
<div class="info admonition">
<p class="admonition-title">Note</p>
<p>Here, no barostat is used because the box volume will be imposed by
the <em>fix deform</em>.</p>
</div>
<div class="justify docutils container">
<p>Let us run for 5000 steps without deformation, then apply the <em>fix deform</em>
for elongating progressively the box along <em>x</em> during 25000 steps. Add the
following line to <em>input.lammps</em>:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">run</span><span class="w"> </span><span class="m">5000</span>

<span class="k">fix </span><span class="nv nv-Identifier">mydef</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">deform</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">erate</span><span class="w"> </span><span class="m">5e-5</span>

<span class="k">run</span><span class="w"> </span><span class="m">25000</span>

<span class="k">write_data </span><span class="nv nv-Identifier">silica-deformed.data</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>During the deformation, the charge values progressively evolve until the structure
eventually breaks down. After the structure breaks down, the charges
equilibrate near new average values that differ from the starting averages.
The difference between the initial and the final charges can be explained by
the presence of defects as well as new solid/vacuum interfaces, and the fact
that surface atoms typically have different charges compared to bulk atoms.</p>
</div>
<figure class="align-default">
<img alt="Charge of silica during deformation of the silicon oxide with LAMMPS and reaxff" class="only-light" src="../../_images/deformed-charge-light.png" />
</figure>
<figure class="align-default">
<img alt="Charge of silica during deformation of the silicon oxide with LAMMPS and reaxff" class="only-dark" src="../../_images/deformed-charge-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Average charge per atom of the silicon (a) and oxygen (b). The
vertical dashed lines mark the beginning of the deformation.</p>
</div>
<div class="justify docutils container">
<p>There is also a strong increase in temperature during the rupture of the
material.</p>
</div>
<figure class="align-default">
<img alt="temperature of silica during deformation of the silicon oxide with LAMMPS and reaxff" class="only-light" src="../../_images/deformed-temperature-light.png" />
</figure>
<figure class="align-default">
<img alt="temperature of silica during deformation of the silicon oxide with LAMMPS and reaxff" class="only-dark" src="../../_images/deformed-temperature-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Temperature of the silica system over time.</p>
</div>
<div class="justify docutils container">
<p>At the end of the deformation, one can visualize the broken material using
VMD. Notice the different charge values of the atoms located near the vacuum
interfaces, compared to the atoms located in the bulk of the material.</p>
</div>
<figure class="align-default">
<img alt="Deformed amorphous silica colored by charges using VMD" class="only-light" src="../../_images/deformed-light1.png" />
</figure>
<figure class="align-default">
<img alt="Deformed amorphous silica colored by charges using VMD" class="only-dark" src="../../_images/deformed-dark1.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Amorphous silicon oxide after deformation. The atoms are colored by
their charges.</p>
</div>
<div class="justify docutils container">
<p>One can have a look at the charge distribution after deformation,
as well as during the deformation.</p>
</div>
<figure class="align-default">
<img alt="Distribution charge of silica and oxygen during equilibration with reaxff" class="only-light" src="../../_images/deformed-distribution-charge-light.png" />
</figure>
<figure class="align-default">
<img alt="Distribution charge of silica and oxygen during equilibration with reaxff" class="only-dark" src="../../_images/deformed-distribution-charge-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Distribution of charge of silicon (positive, blue) and oxygen (negative, orange)
after deformation. The stars correspond to the charge distribution during deformation.</p>
</div>
<div class="justify docutils container">
<p>As expected, the final charge distribution slightly differs from the
previously calculated. In my case, no new species were formed during the
simulation, as can be seen from the <em>species.log</em> file:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c">#  Timestep    No_Moles    No_Specs   Si192O384</span>
<span class="w">        </span><span class="m">5</span><span class="w">           </span><span class="m">1</span><span class="w">           </span><span class="m">1</span><span class="w">           </span><span class="m">1</span>
<span class="nv">(...)</span>
<span class="c">#  Timestep    No_Moles    No_Specs   Si192O384</span>
<span class="w">    </span><span class="m">30000</span><span class="w">           </span><span class="m">1</span><span class="w">           </span><span class="m">1</span><span class="w">           </span><span class="m">1</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Sometimes, <span class="math notranslate nohighlight">\(\text{O}_2\)</span> molecules are formed during the
deformation. If this is the case, the <em>species.log</em> file will look like:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c">#  Timestep    No_Moles    No_Specs   Si192O384</span>
<span class="w">          </span><span class="m">5</span><span class="w">           </span><span class="m">1</span><span class="w">           </span><span class="m">1</span><span class="w">           </span><span class="m">1</span>
<span class="nv">(...)</span>
<span class="c">#  Timestep    No_Moles    No_Specs   Si192O382          O2</span>
<span class="w">      </span><span class="m">30000</span><span class="w">           </span><span class="m">1</span><span class="w">           </span><span class="m">1</span><span class="w">           </span><span class="m">1</span><span class="w">           </span><span class="m">1</span>
</pre></div>
</div>
</section>
<section id="decorate-the-surface">
<h2>Decorate the surface<a class="headerlink" href="#decorate-the-surface" title="Link to this heading">¶</a></h2>
<div class="justify docutils container">
<p>Let us add hydrogen atoms to the cracked silica, and measure how the system
evolves with time.</p>
</div>
<div class="justify docutils container">
<p>Next to <em>RelaxSilica/</em> and <em>Deform/</em>, create a folder, and call it <em>Decorate/</em>.
Then, let us modify the previously generated data file
<em>silica-deformed.data</em> and make space for a third atom type.
Copy <em>silica-deformed.data</em> from the <em>Deform/</em> folder,
and modify the first lines as follow:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="m">576</span><span class="w"> </span><span class="n">atoms</span>
<span class="m">3</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="n">types</span>

<span class="o">-</span><span class="m">12.15958814509652</span><span class="w"> </span><span class="m">32.74516585669389</span><span class="w"> </span><span class="n">xlo</span><span class="w"> </span><span class="n">xhi</span>
<span class="m">2.316358282925984</span><span class="w"> </span><span class="m">18.26921942866687</span><span class="w"> </span><span class="n">ylo</span><span class="w"> </span><span class="n">yhi</span>
<span class="m">1.3959542953413138</span><span class="w"> </span><span class="m">19.189623416252907</span><span class="w"> </span><span class="n">zlo</span><span class="w"> </span><span class="n">zhi</span>

<span class="n">Masses</span>

<span class="m">1</span><span class="w"> </span><span class="m">28.0855</span>
<span class="m">2</span><span class="w"> </span><span class="m">15.999</span>
<span class="m">3</span><span class="w"> </span><span class="m">1.008</span>

<span class="nv">(...)</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Create a file named <em>input.lammps</em>
into the <em>Decorate/</em> folder, and copy
the following lines into it:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">units</span><span class="w"> </span><span class="n">real</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">full</span>

<span class="k">read_data</span><span class="w"> </span><span class="n">silica</span><span class="o">-</span><span class="n">deformed.data</span>
<span class="k">displace_atoms </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="o">-</span><span class="m">12</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="c"># optional</span>

<span class="k">pair_style</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">safezone</span><span class="w"> </span><span class="m">3.0</span><span class="w"> </span><span class="n">mincap</span><span class="w"> </span><span class="m">150</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">RelaxSilica</span><span class="o">/</span><span class="n">reaxCHOFe.ff</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span><span class="w"> </span><span class="n">H</span>
<span class="k">fix </span><span class="nv nv-Identifier">myqeq</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">qeq</span><span class="o">/</span><span class="n">reaxff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">10.0</span><span class="w"> </span><span class="m">1.0e-6</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">maxiter</span><span class="w"> </span><span class="m">400</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Here, the <em>displace_atoms</em> command was used to move the center of the crack
near the center of the box. This step is optional but makes the visualization
of the interface in VMD easier. A different value for the shift may be
needed in your case, depending on the location of the crack.</p>
</div>
<div class="justify docutils container">
<p>A difference with the previous input is that three atom types are specified
in the <em>pair_coeff</em> command, <em>Si O H</em>, instead of two.</p>
</div>
<div class="justify docutils container">
<p>Then, let us adapt some familiar commands to measure the charges of all
three types of atoms, and output the charge values into log files:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">group </span><span class="nv nv-Identifier">grpSi</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">1</span>
<span class="k">group </span><span class="nv nv-Identifier">grpO</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">2</span>
<span class="k">group </span><span class="nv nv-Identifier">grpH</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">3</span>
<span class="k">variable </span><span class="nv nv-Identifier">qSi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpSi)</span><span class="o">/</span><span class="n">count</span><span class="nv">(grpSi)</span>
<span class="k">variable </span><span class="nv nv-Identifier">qO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpO)</span><span class="o">/</span><span class="n">count</span><span class="nv">(grpO)</span>
<span class="k">variable </span><span class="nv nv-Identifier">qH</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpH)</span><span class="o">/</span><span class="nv">(count(grpH)+1e-10)</span>

<span class="k">thermo</span><span class="w"> </span><span class="m">5</span>
<span class="k">thermo_style</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">etotal</span><span class="w"> </span><span class="n">press</span><span class="w"> </span><span class="n">vol</span><span class="w"> </span><span class="o">&amp;</span>
<span class="w">    </span><span class="n">v_qSi</span><span class="w"> </span><span class="n">v_qO</span><span class="w"> </span><span class="n">v_qH</span>
<span class="k">fix </span><span class="nv nv-Identifier">myspec</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">reaxff</span><span class="o">/</span><span class="n">species</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="n">species.log</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span><span class="w"> </span><span class="n">H</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Here, the <span class="math notranslate nohighlight">\(+1\text{e}-10\)</span> was added to the denominator of the
<em>variable qH</em> in order to avoid dividing by 0 at the beginning of the
simulation.</p>
</div>
<div class="justify docutils container">
<p>Finally, let us create a loop with 10 steps, and create two hydrogen atoms
at random locations at every step:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">mynvt</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nvt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">100</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.5</span>

<span class="k">label </span><span class="sc">loop</span>
<span class="k">variable </span><span class="nv nv-Identifier">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="m">10</span>

<span class="k">variable </span><span class="nv nv-Identifier">seed</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="m">35672</span><span class="o">+</span><span class="nv">${a}</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="nv">${seed}</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">overlap</span><span class="w"> </span><span class="m">2.6</span><span class="w"> </span><span class="n">maxtry</span><span class="w"> </span><span class="m">50</span>
<span class="k">group </span><span class="nv nv-Identifier">grpH</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">3</span>
<span class="k">run</span><span class="w"> </span><span class="m">2000</span>
<span class="k">write_dump </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">dump.</span><span class="nv">${a}</span><span class="n">.lammpstrj</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">z</span>

<span class="k">next </span><span class="nv nv-Identifier">a</span>
<span class="k">jump </span><span class="sc">SELF</span><span class="w"> </span><span class="n">loop</span>

<span class="k">write_data </span><span class="nv nv-Identifier">decorated.data</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Here, a different <em>lammpstrj</em> file is created for each step of the loop to
avoid creating dump files with varying numbers of atoms, which VMD can’t
read.</p>
</div>
<div class="justify docutils container">
<p>Once the simulation is over, it can be seen from the <em>species.log</em> file that
all the created hydrogen atoms reacted with the <span class="math notranslate nohighlight">\(\text{SiO}_{2}\)</span>
structure to form surface groups (such as hydroxyl (-OH) groups).</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># Timestep   No_Moles   No_Specs  Si192O384  H</span>
<span class="w">  </span><span class="m">5</span><span class="w">          </span><span class="m">3</span><span class="w">          </span><span class="m">2</span><span class="w">         </span><span class="m">1</span><span class="w">          </span><span class="m">2</span>
<span class="nv">(...)</span>
<span class="c"># Timestep   No_Moles No_Specs Si192O384H20</span>
<span class="w">  </span><span class="m">20000</span><span class="w">      </span><span class="m">1</span><span class="w">        </span><span class="m">1</span><span class="w">        </span><span class="m">1</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="Cracked silicon oxide after addition of hydrogen atoms" class="only-light" src="../../_images/decorated-light.png" />
</figure>
<figure class="align-default">
<img alt="Cracked silicon oxide after addition of hydrogen atoms" class="only-dark" src="../../_images/decorated-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Cracked silicon oxide after the addition of hydrogen atoms. Some
hydroxyl groups can be seen at the interfaces. The atoms are colored by
their charges.</p>
</div>
<div class="justify docutils container">
<p>You can access the input scripts and data files that
are used in these tutorials from <a href="https://github.com/lammpstutorials/lammpstutorials-inputs/" target="_blank">this Github repository</a>.
This repository also contains the full solutions to the exercises.</p>
</div>
</section>
<section id="going-further-with-exercises">
<h2>Going further with exercises<a class="headerlink" href="#going-further-with-exercises" title="Link to this heading">¶</a></h2>
<div class="justify docutils container">
<p>Each  comes with a proposed solution,
see <a class="reference internal" href="../../non-tutorials/solutions.html#solutions-label"><span class="std std-ref">Solutions to the exercises</span></a>.</p>
</div>
<section id="hydrate-the-structure">
<h3>Hydrate the structure<a class="headerlink" href="#hydrate-the-structure" title="Link to this heading">¶</a></h3>
<div class="justify docutils container">
<p>Add water molecules to the current structure, and follow the reactions ove
time.</p>
</div>
<figure class="align-default">
<img alt="Cracked silicon oxide after addition of water molecule" class="only-light" src="../../_images/hydrated-light.png" />
</figure>
<figure class="align-default">
<img alt="Cracked silicon oxide after addition of water molecule" class="only-dark" src="../../_images/hydrated-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Cracked silicon oxide after the addition of hydrogen atoms and water
molecules. The atoms are colored by their charges.</p>
</div>
</section>
<section id="a-slightly-acidic-bulk-solution">
<h3>A slightly acidic bulk solution<a class="headerlink" href="#a-slightly-acidic-bulk-solution" title="Link to this heading">¶</a></h3>
<div class="justify docutils container">
<p>Create a bulk water system with a few hydronium ions (<span class="math notranslate nohighlight">\(H_3O^+\)</span>
or <span class="math notranslate nohighlight">\(H^+\)</span>) using <em>ReaxFF</em>. The addition of hydronium ions will make the
system acidic.</p>
</div>
<figure class="align-default">
<img alt="Acidic bulk water with ReaxFF" class="only-light" src="../../_images/acidic-water-light.png" />
</figure>
<figure class="align-default">
<img alt="Acidic bulk water with ReaxFF" class="only-dark" src="../../_images/acidic-water-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Slightly acidic bulk water simulated with <em>ReaxFF</em>.</p>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="water-adsorption-in-silica.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Water adsorption in silica</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../level2/nanosheared-electrolyte.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Nanosheared electrolyte</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Reactive silicon dioxide</a><ul>
<li><a class="reference internal" href="#prepare-and-relax">Prepare and relax</a></li>
<li><a class="reference internal" href="#deform-the-structure">Deform the structure</a></li>
<li><a class="reference internal" href="#decorate-the-surface">Decorate the surface</a></li>
<li><a class="reference internal" href="#going-further-with-exercises">Going further with exercises</a><ul>
<li><a class="reference internal" href="#hydrate-the-structure">Hydrate the structure</a></li>
<li><a class="reference internal" href="#a-slightly-acidic-bulk-solution">A slightly acidic bulk solution</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=4e2eecee"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>