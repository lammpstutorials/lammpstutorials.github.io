<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-W1WGEC5GQ8"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-W1WGEC5GQ8');
    </script>
        <link href="../../_static/favicon-32x32.png" sizes="32x32" rel="icon" type="image/png"><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Free energy calculation" href="free-energy-calculation.html" /><link rel="prev" title="Nanosheared electrolyte" href="../level2/nanosheared-electrolyte.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Water adsorption in silica - </title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=3ceca25e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">    </div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">    </span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../non-tutorials/before-you-start.html">Before you start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../non-tutorials/contact-me.html">Contact me</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../level1/lennard-jones-fluid.html">Lennard Jones fluid</a></li>
<li class="toctree-l1"><a class="reference internal" href="../level1/breaking-a-carbon-nanotube.html">Pulling on a carbon nanotube</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../level2/polymer-in-water.html">Polymer in water</a></li>
<li class="toctree-l1"><a class="reference internal" href="../level2/nanosheared-electrolyte.html">Nanosheared electrolyte</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 3</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Water adsorption in silica</a></li>
<li class="toctree-l1"><a class="reference internal" href="free-energy-calculation.html">Free energy calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="reactive-silicon-dioxide.html">Reactive silicon dioxide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extra content</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../non-tutorials/solutions.html">Solutions to the exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vmd/vmd-tutorial.html">VMD tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../miscellaneous/use-gromacs-instead.html">Use GROMACS instead</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="water-adsorption-in-silica">
<span id="gcmc-silica-label"></span><h1>Water adsorption in silica<a class="headerlink" href="#water-adsorption-in-silica" title="Link to this heading">#</a></h1>
<div class="hatnote docutils container">
<p>Dealing with a varying number of molecules</p>
</div>
<figure class="align-right">
<a class="only-dark reference internal image-reference" href="../../_images/avatar-dark.webp"><img alt="Water molecules adsorbed in silica SiO2 porous inorganic material" class="only-dark" src="../../_images/avatar-dark.webp" style="height: 250px;" /></a>
</figure>
<figure class="align-right">
<a class="only-light reference internal image-reference" href="../../_images/avatar-light.webp"><img alt="Water molecules adsorbed in silica SiO2 porous inorganic material" class="only-light" src="../../_images/avatar-light.webp" style="height: 250px;" /></a>
</figure>
<div class="justify docutils container">
<p>The objective of this tutorial is to combine molecular
dynamics and grand canonical Monte Carlo simulations to
compute the adsorption of water molecules in a cracked silica material.</p>
</div>
<div class="justify docutils container">
<p>This tutorial illustrates the use of the grand canonical
ensemble in molecular simulation, an open ensemble in which
the number of atoms within the simulation box is not constant.
When using the grand canonical ensemble, it is possible to impose
the chemical potential (or pressure, or fugacity) of a given fluid
in a nanoporous structure.</p>
</div>
<p>If you are completely new to LAMMPS, I recommend you to follow this simpler tutorial first : <a class="reference internal" href="../level1/lennard-jones-fluid.html#lennard-jones-label"><span class="std std-ref">Lennard Jones fluid</span></a>.</p>
<div class="patreon admonition">
<p class="admonition-title">I provide personal assistance for LAMMPS projects</p>
<p>See the <a class="reference internal" href="../../non-tutorials/contact-me.html#contact-label"><span class="std std-ref">Contact me</span></a> page.</p>
</div>
<div class="version docutils container">
<p>This tutorial was tested with the <em>2Aug2023</em> LAMMPS version.</p>
</div>
<section id="generation-of-the-silica-block">
<h2>Generation of the silica block<a class="headerlink" href="#generation-of-the-silica-block" title="Link to this heading">#</a></h2>
<div class="justify docutils container">
<p>Let us first generate a block of amorphous silica (SiO2). To do
so, we are going to replicate a building block containing 3
Si and 6 O atoms.</p>
</div>
<div class="justify docutils container">
<p>Create two folders side by side, and name them respectively <em>Potential/</em>
and <em>SilicaBlock/</em>.</p>
</div>
<div class="justify docutils container">
<p>An initial data file for the SiO atoms can be
downloaded by clicking <a href="../../../../../inputs/level3/water-adsorption-in-silica/SilicaBlock/SiO.data" target="_blank">here</a>.
Save it in <em>SilicaBlock/</em>. This data file
contains the coordinates of the 9 atoms, their masses, and
their charges. The <em>.data</em> file can be directly read by LAMMPS using the
<em>read_data</em> command. Let us replicate these atoms using
LAMMPS, and apply an annealing procedure to obtain a block
of amorphous silica.</p>
</div>
<div class="info admonition">
<p class="admonition-title">About annealing procedure</p>
<p>The annealing procedure consists of adjusting the system temperature in successive steps.
Here, a large initial temperature is chosen to ensure the melting of the SiO2 structure.
Then, several steps are used to progressively cool down the system until it solidifies and forms
amorphous silica. Depending on the material, different cooling velocities can sometimes
lead to different crystal structure or different degree of defect.</p>
</div>
<section id="vashishta-potential">
<h3>Vashishta potential<a class="headerlink" href="#vashishta-potential" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>Create a new input file named <em>input.lammps</em> in the <em>SilicaBlock/</em> folder, and copy
the following lines in it:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">units</span><span class="w"> </span><span class="n">metal</span>
<span class="k">boundary</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">full</span>
<span class="k">pair_style</span><span class="w"> </span><span class="n">vashishta</span>
<span class="k">neighbor</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="n">bin</span>
<span class="k">neigh_modify</span><span class="w"> </span><span class="n">delay</span><span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>The main difference with some of the previous tutorials is the use of
the <em>Vashishta</em> pair style. Download the <em>Vashishta</em> potential by
clicking <a href="../../../../../inputs/level3/water-adsorption-in-silica/Potential/SiO.1990.vashishta" target="_blank">here</a>,
and copy it within the <em>Potential/</em> folder.</p>
</div>
<div class="info admonition">
<p class="admonition-title">About the Vashishta potential</p>
<p>The <a href="https://pubmed.ncbi.nlm.nih.gov/9993674/" target="_blank">Vashishta</a>
potential is a bond-angle energy based potential, it
deduces the bonds between atoms from their relative
positions. Therefore, there is no need to provide bond
and angle information as we do with classic force fields
like GROMOS or AMBER. When used with LAMMPS, the <em>Vashishta</em>
potential requires the use of metal units system.
Bond-angle energy based potentials
are more computationally heavy than classical force
fields and require the use of a smaller timestep, but
they allow for the modelling of bond formation and
breaking, which is what we need here as we want to create
a crack in the silica.</p>
</div>
<div class="justify docutils container">
<p>Let us then import the system made of 9 atoms, replicate it four times in all three
directions of space, thus creating a system with 576 atoms. Add the following lines
to <em>input.lammps</em>:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">read_data</span><span class="w"> </span><span class="n">SiO.data</span>
<span class="k">replicate</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Then, let us specify the pair coefficients by indicating
that the first atom type is <em>Si</em>, and
the second is <em>O</em>. Let us also
add a dump command for printing out the positions of the
atoms every 5000 steps:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">Potential</span><span class="o">/</span><span class="n">SiO.1990.vashishta</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Let us add some commands to <em>input.lammps</em> to help us follow the evolution of the system,
such as its temperature, volume, and potential-energy:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">dump </span><span class="nv nv-Identifier">dmp</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="m">5000</span><span class="w"> </span><span class="n">dump.lammpstrj</span>
<span class="k">variable </span><span class="nv nv-Identifier">myvol</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">vol</span>
<span class="k">variable </span><span class="nv nv-Identifier">mylx</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">lx</span>
<span class="k">variable </span><span class="nv nv-Identifier">myly</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">ly</span>
<span class="k">variable </span><span class="nv nv-Identifier">mylz</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">lz</span>
<span class="k">variable </span><span class="nv nv-Identifier">mypot</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">pe</span>
<span class="k">variable </span><span class="nv nv-Identifier">mytemp</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">temp</span>
<span class="k">fix </span><span class="nv nv-Identifier">myat1</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">time</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">v_mytemp</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">temperature.dat</span>
<span class="k">fix </span><span class="nv nv-Identifier">myat2</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">time</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">v_myvol</span><span class="w"> </span><span class="n">v_mylx</span><span class="w"> </span><span class="n">v_myly</span><span class="w"> </span><span class="n">v_mylz</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">dimensions.dat</span>
<span class="k">fix </span><span class="nv nv-Identifier">myat3</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">time</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">v_mypot</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">potential</span><span class="o">-</span><span class="n">energy.dat</span>
<span class="k">thermo</span><span class="w"> </span><span class="m">1000</span>
</pre></div>
</div>
</section>
<section id="annealing-procedure">
<h3>Annealing procedure<a class="headerlink" href="#annealing-procedure" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>Finally, let us create the last part of our script. The
annealing procedure is made of four consecutive runs.
First, a <span class="math notranslate nohighlight">\(50\,\text{ps}\)</span>
phase at <span class="math notranslate nohighlight">\(T = 6000\,\text{K}\)</span>
and isotropic pressure coupling with desired pressure <span class="math notranslate nohighlight">\(p = 100\,\text{atm}\)</span>:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">velocity </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="m">6000</span><span class="w"> </span><span class="m">4928459</span><span class="w"> </span><span class="n">rot</span><span class="w"> </span><span class="n">yes</span><span class="w"> </span><span class="n">dist</span><span class="w"> </span><span class="n">gaussian</span>
<span class="k">fix </span><span class="nv nv-Identifier">npt1</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">npt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">6000</span><span class="w"> </span><span class="m">6000</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="n">iso</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">1</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.001</span>
<span class="k">run</span><span class="w"> </span><span class="m">50000</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Then, a second phase during which the system is cooled down
from <span class="math notranslate nohighlight">\(T = 6000\,\text{K}\)</span>
to <span class="math notranslate nohighlight">\(T = 4000\,\text{K}\)</span>.
An anisotropic pressure coupling is used, allowing all three
dimensions of the box to evolve independently from one another:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">npt1</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">npt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">6000</span><span class="w"> </span><span class="m">4000</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="n">aniso</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">1</span>
<span class="k">run</span><span class="w"> </span><span class="m">50000</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Then, let us cool down the system
further while also reducing the pressure, then perform a
small equilibration step at the final desired condition, <span class="math notranslate nohighlight">\(T = 300\,\text{K}\)</span>
and <span class="math notranslate nohighlight">\(p = 1\,\text{atm}\)</span>.</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">npt1</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">npt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">4000</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="n">aniso</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span>
<span class="k">run</span><span class="w"> </span><span class="m">200000</span>
<span class="k">fix </span><span class="nv nv-Identifier">npt1</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">npt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="n">aniso</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span>
<span class="k">run</span><span class="w"> </span><span class="m">50000</span>

<span class="k">write_data </span><span class="nv nv-Identifier">amorphousSiO.data</span>
</pre></div>
</div>
<div class="justify docutils container">
<p><em>Disclaimer â€“</em> I created this procedure by intuition and
not from proper calibration, do not copy it without
making your own tests if you intend to publish your results.</p>
</div>
<div class="info admonition">
<p class="admonition-title">Anisotropic versus isotropic barostat</p>
<p>Here, an isotropic barostat is used for the melted phase at <span class="math notranslate nohighlight">\(T = 6000\,\text{K}\)</span>,
and then an anisotropic barostat is used for all following phases. With the anisotropic
barostat, all three directions of space are adjusted independently from one another. Such
anisotropic barostat is usually a better choice for a solid phase,
when there is no reason for the final solid phase to
have the same dimensions along all 3 axis. For a
liquid or a gas, the isotropic barostat is usually the best choice.</p>
</div>
<div class="justify docutils container">
<p>The simulation takes about 15-20 minutes on 4 cpu cores.</p>
</div>
<div class="justify docutils container">
<p>Let us check the evolution of the temperature from the <em>temperature.dat</em> file.
Apart from an initial spike (may be due to an initial bad configuration, probably harmless here),
the temperature follows well the desired annealing procedure:</p>
</div>
<figure class="align-default">
<img alt="silica temperature during annealing, from melt to solid" class="only-dark" src="../../_images/temperature_evolution-dark.png" />
</figure>
<figure class="align-default">
<img alt="silica temperature during annealing, from melt to solid" class="only-light" src="../../_images/temperature_evolution-light.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Temperature of the system during annealing. The vertical dashed lines
mark the transition between the different phases of the simulations.</p>
</div>
<div class="justify docutils container">
<p>Let us also make sure that the box was indeed deformed isotropically during the first
stage of the simulation, and then anisotropically by plotting the evolution of the
box dimensions over time.</p>
</div>
<figure class="align-default">
<img alt="box dimensions during annealing, from melt to solid" class="only-dark" src="../../_images/dimensions_evolution-dark.png" />
</figure>
<figure class="align-default">
<img alt="box dimensions during annealing, from melt to solid" class="only-light" src="../../_images/dimensions_evolution-light.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Box dimensions during annealing. The vertical dashed lines
mark the transition between the different phases of the simulations.</p>
</div>
<div class="justify docutils container">
<p>As always, let us also look at the system using VMD.</p>
</div>
<figure class="align-default">
<img alt="silica block generated by temperature annealing using LAMMPS" class="only-dark" src="../../_images/generated-silica-dark.png" />
</figure>
<figure class="align-default">
<img alt="silica block generated by temperature annealing using LAMMPS" class="only-light" src="../../_images/generated-silica-light.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Snapshot final amorphous silica (SiO2) with Si atom in yellow and
O atoms in red.</p>
</div>
<div class="justify docutils container">
<p>After running the simulation, the final LAMMPS topology file named
<em>amorphousSiO.data</em> will be located in <em>SilicaBlock/</em>. Alternatively, if you are only interested in the
next steps of this tutorial, you can download it by clicking
<a href="../../../../../inputs/level3/water-adsorption-in-silica/SilicaBlock/amorphousSiO.data" target="_blank">here</a>.</p>
</div>
<div class="info admonition">
<p class="admonition-title">Tip for research project</p>
<p>In the case of a research project, the validity of the generated
structure must be tested and compared to reference values, ideally from
experiments. For instance, radial distribution functions or Young modulus
can both be compared to experimental values. This is beyond the
scope of this tutorial.</p>
</div>
</section>
</section>
<section id="cracking-the-silica">
<h2>Cracking the silica<a class="headerlink" href="#cracking-the-silica" title="Link to this heading">#</a></h2>
<div class="justify docutils container">
<p>Let us dilate the block of silica to create a
crack. Create a new folder called <em>Cracking/</em> next to <em>SilicaBlock/</em>, and create a
new input.lammps file starting with:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in Cracking/input.lammps</em></span><a class="headerlink" href="#id1" title="Link to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">units</span><span class="w"> </span><span class="n">metal</span>
<span class="k">boundary</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">full</span>
<span class="k">neighbor</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="n">bin</span>
<span class="k">neigh_modify</span><span class="w"> </span><span class="n">delay</span><span class="w"> </span><span class="m">1</span>

<span class="k">read_data</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">SilicaBlock</span><span class="o">/</span><span class="n">amorphousSiO.data</span>

<span class="k">pair_style</span><span class="w"> </span><span class="n">vashishta</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">Potential</span><span class="o">/</span><span class="n">SiO.1990.vashishta</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span>
<span class="k">dump </span><span class="nv nv-Identifier">dmp</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">dump.lammpstrj</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>Then, let us progressively increase the size of the
box in the z direction, thus forcing the silica to deform and crack. To do
so, we are going to make a loop using the jump command. At
every step of the loop, the box dimension over x will
be multiplied by a factor 1.005. Here, we use a NVT
thermostat because we want to impose a deformation of the
volume.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">NVT vs 2D barostat</p>
<p>Here, box deformations are applied in the x-direction, while the
y and z box dimensions are kept constants.</p>
<p>Another possible choice would be to apply a barostat along the y and z
direction, allowing the system more freedom to deform. In LAMMPS, this
can be done by using :</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">npt1</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">npt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
<p>instead of:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">nvt1</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nvt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">0.1</span>
</pre></div>
</div>
<p>Here, the latter command will be used (see below), but feel free to improvise.</p>
</div>
<div class="justify docutils container">
<p>Add the following lines to the input script:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in Cracking/input.lammps</em></span><a class="headerlink" href="#id2" title="Link to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">nvt1</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nvt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">0.1</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.001</span>
<span class="k">thermo</span><span class="w"> </span><span class="m">1000</span>
<span class="k">variable </span><span class="nv nv-Identifier">var</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="m">45</span>
<span class="k">label </span><span class="sc">loop</span>
<span class="k">change_box </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="m">1.005</span><span class="w"> </span><span class="n">remap</span>
<span class="k">run</span><span class="w"> </span><span class="m">2000</span>
<span class="k">next </span><span class="nv nv-Identifier">var</span>
<span class="k">jump </span><span class="sc">input.lammps</span><span class="w"> </span><span class="n">loop</span>
<span class="k">run</span><span class="w"> </span><span class="m">20000</span>
<span class="k">write_data </span><span class="nv nv-Identifier">dilatedSiO.data</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>Use different factor (1.005) or different number of
loop (45) if you want to generate different defects in the silica.</p>
</div>
<figure class="align-right">
<a class="only-dark reference internal image-reference" href="../../_images/cracked-dark.png"><img alt="silica block with crack" class="only-dark" src="../../_images/cracked-dark.png" style="height: 150px;" /></a>
</figure>
<figure class="align-right">
<a class="only-light reference internal image-reference" href="../../_images/cracked-light.png"><img alt="silica block with crack" class="only-light" src="../../_images/cracked-light.png" style="height: 150px;" /></a>
</figure>
<div class="justify docutils container">
<p>The snapshot on the side shows the block of silica with holes and deformed bonds.</p>
<p>After the dilatation, a final equilibration step of 20
picoseconds is performed. If you look at the dump file
produced after executing this script, or at <a href="https://www.youtube.com/watch?v=8rBqYIcTgno&ab_channel=SimonGravelle" target="_blank">this video</a>,
you can see the dilatation occurring step-by-step, and the
atoms adjusting progressively to the box size.</p>
<p>At first, the deformations
are reversible (elastic regime). At some point, bonds
start breaking and dislocations appear (plastic regime).</p>
<p>Alternatively, you
can download the final state directly by clicking
<a href="../../../../../inputs/level3/water-adsorption-in-silica/Cracking/dilatedSiO.data" target="_blank">here</a>. The final system, with the crack, resembles:</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Passivated silica</p>
<p>In ambient conditions, Some of the surface SiO2 atoms are chemically
passivated by forming covalent bonds with hydrogen (H)
atoms. For the sake of simplicity, we are not going to
add surface hydrogen atoms here.</p>
<p>An example of procedure allowing for properly inserting hydrogen atoms is given in one
exercise from this tutorial: <a class="reference internal" href="reactive-silicon-dioxide.html#reactive-silicon-dioxide-label"><span class="std std-ref">Reactive silicon dioxide</span></a>.</p>
</div>
</section>
<section id="adding-water">
<h2>Adding water<a class="headerlink" href="#adding-water" title="Link to this heading">#</a></h2>
<div class="info admonition">
<p class="admonition-title">About the GCMC method</p>
<p>In order to add the water molecules to the silica, we are
going to use the Monte Carlo method in the grand canonical
ensemble (GCMC). In short, the system is put into contact
with a virtual reservoir of given chemical potential
<span class="math notranslate nohighlight">\(\mu\)</span>, and multiple attempts to insert water
molecules at random positions are made. Attempts are
either accepted or rejected based on energy consideration.</p>
<p>If you are interested in learning more about GCMC, I am developing
another website with the goal of delving deeper into the algorithms: <a href="https://mdcourse.github.io" target="_blank">mdcourse.github.io</a>.</p>
</div>
<section id="using-hydrid-potentials">
<h3>Using hydrid potentials<a class="headerlink" href="#using-hydrid-potentials" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>In a new folder called <em>Addingwater/</em>, add this template file
for the water molecule: <a href="../../../../../inputs/level3/water-adsorption-in-silica/AddingWater/TIP4P2005.txt" target="_blank">TIP4P2005.txt</a>.</p>
<p>Create a new input file, and copy the following lines into it:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in Addingwater/input.lammps</em></span><a class="headerlink" href="#id3" title="Link to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">units</span><span class="w"> </span><span class="n">metal</span>
<span class="k">boundary</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">full</span>
<span class="k">neighbor</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="n">bin</span>
<span class="k">neigh_modify</span><span class="w"> </span><span class="n">delay</span><span class="w"> </span><span class="m">1</span>
<span class="k">pair_style</span><span class="w"> </span><span class="n">hybrid</span><span class="o">/</span><span class="n">overlay</span><span class="w"> </span><span class="n">vashishta</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.1546</span><span class="w"> </span><span class="m">10</span>
<span class="k">kspace_style</span><span class="w"> </span><span class="n">pppm</span><span class="o">/</span><span class="n">tip4p</span><span class="w"> </span><span class="m">1.0e-4</span>
<span class="k">bond_style</span><span class="w"> </span><span class="n">harmonic</span>
<span class="k">angle_style</span><span class="w"> </span><span class="n">harmonic</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>There are several differences with the previous input files
used in this tutorial because, from now on, the system will combine water and silica.
Two force fields are combined, Vashishta for
SiO, and lj/cut/tip4p/long for TIP4P water model, which is
done using the hybrid/overlay pair style.
The kspace solver is used to calculate the long
range Coulomb interactions associated with tip4p/long.
Finally, the style for the bonds and angles
of the water molecules are defined (although not important
since its a rigid water model).</p>
<p>Before going further, we also need to make a few change to our data file.
Currently, <em>dilatedSiO.data</em> only includes two atom types, but
we need four. Copy the previously generated <em>dilatedSiO.data</em>
file within <em>Addingwater/</em>. Currently, <em>dilatedSiO.data</em> starts with:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="n">LAMMPS</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">write_data</span>,<span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="n">Aug</span><span class="w"> </span><span class="m">2023</span>,<span class="w"> </span><span class="n">timestep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">110000</span>,<span class="w"> </span><span class="n">units</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">metal</span>

<span class="m">576</span><span class="w"> </span><span class="n">atoms</span>
<span class="m">2</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="n">types</span>

<span class="o">-</span><span class="m">5.512084438507452</span><span class="w"> </span><span class="m">26.09766215010596</span><span class="w"> </span><span class="n">xlo</span><span class="w"> </span><span class="n">xhi</span>
<span class="o">-</span><span class="m">0.12771230207837192</span><span class="w"> </span><span class="m">20.71329001367807</span><span class="w"> </span><span class="n">ylo</span><span class="w"> </span><span class="n">yhi</span>
<span class="m">3.211752393088563</span><span class="w"> </span><span class="m">17.373825318513106</span><span class="w"> </span><span class="n">zlo</span><span class="w"> </span><span class="n">zhi</span>

<span class="n">Masses</span>

<span class="m">1</span><span class="w"> </span><span class="m">28.0855</span>
<span class="m">2</span><span class="w"> </span><span class="m">15.9994</span>

<span class="n">Atoms</span><span class="w"> </span><span class="c"># full</span>

<span class="nv">(...)</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Make the following changes to allow for the addition of water
molecules. Modify the file so that it looks like the following
(with 4 atom types, 1 bond type, 1 angle type, and four masses):</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="n">LAMMPS</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">write_data</span>,<span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="n">Jul</span><span class="w"> </span><span class="m">2021</span>,<span class="w"> </span><span class="n">timestep</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">90000</span>

<span class="m">576</span><span class="w"> </span><span class="n">atoms</span>
<span class="m">4</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="n">types</span>
<span class="m">1</span><span class="w"> </span><span class="n">bond</span><span class="w"> </span><span class="n">types</span>
<span class="m">1</span><span class="w"> </span><span class="n">angle</span><span class="w"> </span><span class="n">types</span>

<span class="m">2</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="n">bond</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">atom</span>
<span class="m">1</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="n">angle</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">atom</span>
<span class="m">2</span><span class="w"> </span><span class="n">extra</span><span class="w"> </span><span class="n">special</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">atom</span>

<span class="m">0.910777522101565</span><span class="w"> </span><span class="m">19.67480018949893</span><span class="w"> </span><span class="n">xlo</span><span class="w"> </span><span class="n">xhi</span>
<span class="m">2.1092682236518137</span><span class="w"> </span><span class="m">18.476309487947546</span><span class="w"> </span><span class="n">ylo</span><span class="w"> </span><span class="n">yhi</span>
<span class="o">-</span><span class="m">4.1701120819606885</span><span class="w"> </span><span class="m">24.75568979356097</span><span class="w"> </span><span class="n">zlo</span><span class="w"> </span><span class="n">zhi</span>

<span class="n">Masses</span>

<span class="m">1</span><span class="w"> </span><span class="m">28.0855</span>
<span class="m">2</span><span class="w"> </span><span class="m">15.9994</span>
<span class="m">3</span><span class="w"> </span><span class="m">15.9994</span>
<span class="m">4</span><span class="w"> </span><span class="m">1.008</span>

<span class="n">Atoms</span><span class="w"> </span><span class="c"># full</span>

<span class="nv">(...)</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Doing so, we anticipate that there will be 4 atoms types in
the simulations, with O and H of H2O having indexes 3 and 4,
respectively. There will also be 1 bond type and 1 angle
type. The extra bond, extra angle, and extra special lines
also need to be added for memory allocation.</p>
<p>We can continue to fill in the
<em>input.lammps</em> file, by adding the system definition:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">read_data</span><span class="w"> </span><span class="n">dilatedSiO.data</span>
<span class="k">molecule</span><span class="w"> </span><span class="n">h2omol</span><span class="w"> </span><span class="n">TIP4P2005.txt</span>
<span class="k">lattice</span><span class="w"> </span><span class="n">sc</span><span class="w"> </span><span class="m">3</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">box</span><span class="w"> </span><span class="n">mol</span><span class="w"> </span><span class="n">h2omol</span><span class="w"> </span><span class="m">45585</span>
<span class="k">lattice</span><span class="w"> </span><span class="n">none</span><span class="w"> </span><span class="m">1</span>

<span class="k">group </span><span class="nv nv-Identifier">SiO</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span>
<span class="k">group </span><span class="nv nv-Identifier">H2O</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>After reading the data file and defining the h2omol molecule
from the txt file, the <em>create_atoms</em> command is used to
include some water molecules in the system on a
simple cubic lattice. Not adding a molecule before starting the
GCMC steps usually lead to failure. Note that here,
most water molecules are overlapping with the silica. These
overlapping water molecules will be deleted before
starting the simulation.</p>
<p>Then, add the following settings to <em>Addingwater/input.lammps</em>:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">vashishta</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">Potential</span><span class="o">/</span><span class="n">SiO.1990.vashishta</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">NULL</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">0.0057</span><span class="w"> </span><span class="m">4.42</span><span class="w"> </span><span class="c"># epsilonSi = 0.00403, sigmaSi = 3.69</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">0.0043</span><span class="w"> </span><span class="m">3.12</span><span class="w"> </span><span class="c"># epsilonO = 0.0023, sigmaO = 3.091</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">0.008</span><span class="w"> </span><span class="m">3.1589</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">0.0</span>
<span class="k">bond_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0.9572</span>
<span class="k">angle_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">104.52</span>

<span class="k">variable </span><span class="nv nv-Identifier">oxygen</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="s">&quot;type==3&quot;</span>
<span class="k">group </span><span class="nv nv-Identifier">oxygen</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">var</span><span class="w"> </span><span class="n">oxygen</span>
<span class="k">variable </span><span class="nv nv-Identifier">nO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">count</span><span class="nv">(oxygen)</span>
<span class="k">fix </span><span class="nv nv-Identifier">myat1</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">time</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">v_nO</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">numbermolecule.dat</span>

<span class="k">fix </span><span class="nv nv-Identifier">shak</span><span class="w"> </span><span class="nv nv-Identifier">H2O</span><span class="w"> </span><span class="n">shake</span><span class="w"> </span><span class="m">1.0e-4</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">mol</span><span class="w"> </span><span class="n">h2omol</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>The force field Vashishta applies only to Si (type 1) and O of SiO2 (type 2),
and not to the O and H of H2O, thanks to the NULL
parameters used for atoms of types 3 and 4.</p>
<p>Pair coefficients for lj/cut/tip4p/long are
defined between O atoms, as well as between
O(SiO)-O(H2O) and Si(SiO)-O(H2O). Therefore, the fluid-solid
interactions will be set by Lennard Jones and Coulomb potential.</p>
<p>The number of oxygen atoms from water molecule (i.e. the number of molecule)
will be printed in the file <em>numbermolecule.dat</em>.</p>
<p>The shake algorithm is used to
maintain the shape of the water molecule over time. Some of
these features have been seen in previous tutorials.</p>
<p>Let us delete the overlapping water molecules, and print the
positions in a dump file:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in Addingwater/input.lammps</em></span><a class="headerlink" href="#id4" title="Link to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">delete_atoms</span><span class="w"> </span><span class="n">overlap</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="n">H2O</span><span class="w"> </span><span class="n">SiO</span><span class="w"> </span><span class="n">mol</span><span class="w"> </span><span class="n">yes</span>
<span class="k">dump </span><span class="nv nv-Identifier">dmp</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">dump.init.lammpstrj</span>
</pre></div>
</div>
</div>
</section>
<section id="gcmc-simulation">
<h3>GCMC simulation<a class="headerlink" href="#gcmc-simulation" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>Let us make a first equilibration step:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in Addingwater/input.lammps</em></span><a class="headerlink" href="#id5" title="Link to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">compute_modify </span><span class="nv nv-Identifier">thermo_temp</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">yes</span>
<span class="k">compute </span><span class="nv nv-Identifier">ctH2O</span><span class="w"> </span><span class="nv nv-Identifier">H2O</span><span class="w"> </span><span class="n">temp</span>
<span class="k">compute_modify </span><span class="nv nv-Identifier">ctH2O</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">yes</span>
<span class="k">fix </span><span class="nv nv-Identifier">mynvt1</span><span class="w"> </span><span class="nv nv-Identifier">H2O</span><span class="w"> </span><span class="n">nvt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">0.1</span>
<span class="k">fix_modify </span><span class="nv nv-Identifier">mynvt1</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">ctH2O</span>
<span class="k">compute </span><span class="nv nv-Identifier">ctSiO</span><span class="w"> </span><span class="nv nv-Identifier">SiO</span><span class="w"> </span><span class="n">temp</span>
<span class="k">fix </span><span class="nv nv-Identifier">mynvt2</span><span class="w"> </span><span class="nv nv-Identifier">SiO</span><span class="w"> </span><span class="n">nvt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">0.1</span>
<span class="k">fix_modify </span><span class="nv nv-Identifier">mynvt2</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">ctSiO</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.001</span>
<span class="k">thermo</span><span class="w"> </span><span class="m">1000</span>
<span class="k">run</span><span class="w"> </span><span class="m">5000</span>
</pre></div>
</div>
</div>
<div class="info admonition">
<p class="admonition-title">On thermostating groups instead of the entire system</p>
<p>Two different thermostats are used for SiO and for H2O, respectively. Using
separate thermostat is usually better when the system contains two separate species, such as one solid and one
liquid. It is particularly important to use two thermostats
here, because the number of water molecules will fluctuate with time.</p>
</div>
<div class="justify docutils container">
<p>The <em>compute_modify</em> â€˜dynamic yesâ€™ for water is used to specify that the
number of molecules is not constant.</p>
<p>Finally, let us use the fix gcmc and perform the grand
canonical Monte Carlo steps:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in Addingwater/input.lammps</em></span><a class="headerlink" href="#id6" title="Link to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">variable </span><span class="nv nv-Identifier">tfac</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="m">5.0</span><span class="o">/</span><span class="m">3.0</span>
<span class="k">variable </span><span class="nv nv-Identifier">xlo</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">xlo</span><span class="o">+</span><span class="m">0.1</span>
<span class="k">variable </span><span class="nv nv-Identifier">xhi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">xhi</span><span class="o">-</span><span class="m">0.1</span>
<span class="k">variable </span><span class="nv nv-Identifier">ylo</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">ylo</span><span class="o">+</span><span class="m">0.1</span>
<span class="k">variable </span><span class="nv nv-Identifier">yhi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">yhi</span><span class="o">-</span><span class="m">0.1</span>
<span class="k">variable </span><span class="nv nv-Identifier">zlo</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">zlo</span><span class="o">+</span><span class="m">0.1</span>
<span class="k">variable </span><span class="nv nv-Identifier">zhi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">zhi</span><span class="o">-</span><span class="m">0.1</span>
<span class="k">region </span><span class="nv nv-Identifier">system</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="nv">${xlo}</span><span class="w"> </span><span class="nv">${xhi}</span><span class="w"> </span><span class="nv">${ylo}</span><span class="w"> </span><span class="nv">${yhi}</span><span class="w"> </span><span class="nv">${zlo}</span><span class="w"> </span><span class="nv">${zhi}</span>
<span class="k">fix </span><span class="nv nv-Identifier">fgcmc</span><span class="w"> </span><span class="nv nv-Identifier">H2O</span><span class="w"> </span><span class="n">gcmc</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">65899</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="o">-</span><span class="m">0.5</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="n">mol</span><span class="w"> </span><span class="n">h2omol</span><span class="w"> </span><span class="n">tfac_insert</span><span class="w"> </span><span class="nv">${tfac}</span><span class="w"> </span><span class="k">group </span><span class="nv nv-Identifier">H2O</span><span class="w"> </span><span class="n">shake</span><span class="w"> </span><span class="n">shak</span><span class="w"> </span><span class="n">full_energy</span><span class="w"> </span><span class="n">pressure</span><span class="w"> </span><span class="m">10000</span><span class="w"> </span><span class="k">region </span><span class="nv nv-Identifier">system</span>
<span class="k">run</span><span class="w"> </span><span class="m">25000</span>
<span class="k">write_data </span><span class="nv nv-Identifier">SiOwithwater.data</span>
<span class="k">write_dump </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="n">dump.lammpstrj</span>
</pre></div>
</div>
</div>
<div class="info admonition">
<p class="admonition-title">Dirty fix</p>
<p>The region <em>system</em> was created to avoid the error â€œFix gcmc region extends outside simulation boxâ€
which seems to occur with some LAMMPS version.</p>
</div>
<div class="justify docutils container">
<p>The <em>tfac_insert</em> option ensures that the correct estimate is
made for the temperature of the inserted water molecules by
taking into account the internal degrees of freedom. Running
this simulation, you should see the number of molecule
increasing progressively. When using the pressure argument,
LAMMPS ignores the value of the chemical potential [here <span class="math notranslate nohighlight">\(\mu = -0.5\)</span> eV
which corresponds roughly to ambient conditions (i.e. RH approx 50%).]
The large pressure value of 10000 bars was chosen to ensure that
some successful insertions of molecules would occur during the
relatively short duration of the simulation.</p>
<p>When you run the simulation, make sure that some water molecules
remain in the system after the <em>delete_atoms</em> command. You can control
that either using the log file, or using the <em>numbermolecule.dat</em> data file.</p>
<p>Depending on your LAMMPS version, you may have to run LAMMPS
on a single cpu core, due to some restrictions of the fix gcmc.</p>
<p>You can see, by looking at the log file, that 280 molecules
were added by the <em>create_atoms</em> command (the exact number may differ):</p>
</div>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text"><em>from the log file</em></span><a class="headerlink" href="#id7" title="Link to this code">#</a></div>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>Created 840 atoms
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>You can also see that 258 molecules where immediately deleted,
leaving 24 water molecules (the exact number may differ):</p>
</div>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text"><em>from the log file</em></span><a class="headerlink" href="#id8" title="Link to this code">#</a></div>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>Deleted 774 atoms, new total = 642
Deleted 516 bonds, new total = 44
Deleted 258 angles, new total = 22
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>After just a few GCMC steps, you should see that the number of molecules increases with time.
When the crack is fully filled, the number of molecule reaches a plateau:</p>
</div>
<figure class="align-default">
<img alt="number of water molecules added by the LAMMPS gcmc" class="only-dark" src="../../_images/number_evolution-dark.png" />
</figure>
<figure class="align-default">
<img alt="number of water molecules added by the LAMMPS gcmc" class="only-light" src="../../_images/number_evolution-light.png" />
</figure>
<div class="justify docutils container">
<p>Note that the final number of molecules depends on the imposed pressure,
temperature, and on the interaction between water and silica (its hydrophilicity).</p>
</div>
<figure class="align-right">
<a class="only-dark reference internal image-reference" href="../../_images/solvated-dark.png"><img alt="silica block with water and crack" class="only-dark" src="../../_images/solvated-dark.png" style="height: 150px;" /></a>
</figure>
<figure class="align-right">
<a class="only-light reference internal image-reference" href="../../_images/solvated-light.png"><img alt="silica block with water and crack" class="only-light" src="../../_images/solvated-light.png" style="height: 150px;" /></a>
</figure>
<div class="justify docutils container">
<p>The figure on the side shows a snapshot of the final state, with the oxygen of the
water molecules represented in cyan.</p>
<p>Note that gcmc simulations of such dense phases are usually slow to converge due to the
very low probability of successfully inserting a molecule. Here, the short simulation
duration was made possible by the use of a huge pressure.</p>
</div>
<div class="info admonition">
<p class="admonition-title">Vizualising varying number of molecules</p>
<p>By default, VMD fails to properly render systems with varying number of atoms,
but Ovito does it well.</p>
</div>
</section>
</section>
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<div class="justify docutils container">
<div class="solution admonition">
<p class="admonition-title">Solutions</p>
<p>Register as a <a href="https://www.patreon.com/molecularsimulations" target="_blank">Patreon</a> for 1 euro/month
to access all the solutions.</p>
</div>
</div>
<section id="apply-gcmc-to-water-in-zif-8">
<h3>Apply GCMC to water in ZIF-8<a class="headerlink" href="#apply-gcmc-to-water-in-zif-8" title="Link to this heading">#</a></h3>
<figure class="align-right">
<a class="only-dark reference internal image-reference" href="../../_images/zif8-dark.png"><img alt="zif-8 with water" class="only-dark" src="../../_images/zif8-dark.png" style="height: 250px;" /></a>
</figure>
<figure class="align-right">
<a class="only-light reference internal image-reference" href="../../_images/zif8-light.png"><img alt="zif-8 with water" class="only-light" src="../../_images/zif8-light.png" style="height: 250px;" /></a>
</figure>
<div class="justify docutils container">
<p>Use the same protocole as the one implemented in this tutorial to add water
molecules to a Zif-8 nanoporous material. A snapshot of the system with a
few water molecules is presented on the right.</p>
<p>Download the initial Zif-8 <a href="../../../../../inputs/level3/water-adsorption-in-silica/Exercises/Zif-8/zif-8.data" target="_blank">structure</a>,
the <a href="../../../../../inputs/level3/water-adsorption-in-silica/Exercises/Zif-8/parm.lammps" target="_blank">parameters</a> file, and this
new <a href="../../../../../inputs/level3/water-adsorption-in-silica/Exercises/Zif-8/water.mol" target="_blank">water template</a>. The ZIF-8 structure is made of 7 atom types (C1, C2, C3, H2, H3, N, Zn), connected
by bonds, angles, dihedrals, and impropers. It uses the same <em>pair_style</em> as water,
so there is no need to use the <em>hybrid</em> functionality (see the hints below).</p>
<p>Note that, here, water occupies the atom types 1 and 2, instead of 3 and 4 in the case of SiO2.</p>
</div>
<div class="info admonition">
<p class="admonition-title">Hints</p>
<p>Use the following parameters to start your LAMMPS input file.</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">units</span><span class="w"> </span><span class="n">real</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">full</span>
<span class="k">boundary</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span>
<span class="k">bond_style</span><span class="w"> </span><span class="n">harmonic</span>
<span class="k">angle_style</span><span class="w"> </span><span class="n">harmonic</span>
<span class="k">dihedral_style</span><span class="w"> </span><span class="n">charmm</span>
<span class="k">improper_style</span><span class="w"> </span><span class="n">harmonic</span>

<span class="k">pair_style</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.105</span><span class="w"> </span><span class="m">14.0</span>
<span class="k">kspace_style</span><span class="w"> </span><span class="n">pppm</span><span class="o">/</span><span class="n">tip4p</span><span class="w"> </span><span class="m">1.0e-5</span>

<span class="k">special_bonds</span><span class="w"> </span><span class="n">lj</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">0.5</span><span class="w"> </span><span class="n">coul</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">0.833</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="free-energy-calculation.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Free energy calculation</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../level2/nanosheared-electrolyte.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Nanosheared electrolyte</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Water adsorption in silica</a><ul>
<li><a class="reference internal" href="#generation-of-the-silica-block">Generation of the silica block</a><ul>
<li><a class="reference internal" href="#vashishta-potential">Vashishta potential</a></li>
<li><a class="reference internal" href="#annealing-procedure">Annealing procedure</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cracking-the-silica">Cracking the silica</a></li>
<li><a class="reference internal" href="#adding-water">Adding water</a><ul>
<li><a class="reference internal" href="#using-hydrid-potentials">Using hydrid potentials</a></li>
<li><a class="reference internal" href="#gcmc-simulation">GCMC simulation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#exercises">Exercises</a><ul>
<li><a class="reference internal" href="#apply-gcmc-to-water-in-zif-8">Apply GCMC to water in ZIF-8</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>