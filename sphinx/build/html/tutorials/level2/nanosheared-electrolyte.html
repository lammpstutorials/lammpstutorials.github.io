<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-W1WGEC5GQ8"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-W1WGEC5GQ8');
    </script>
        <link href="../../_static/favicon-32x32.png" sizes="32x32" rel="icon" type="image/png"><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Water adsorption in silica" href="../level3/water-adsorption-in-silica.html" /><link rel="prev" title="Polymer in water" href="polymer-in-water.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Nanosheared electrolyte - </title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=3ceca25e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">    </div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">    </span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../miscellaneous/before-you-start.html">Before you start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../miscellaneous/site-walkthrough.html">Site walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../miscellaneous/contact-me.html">Contact me</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 0</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../level0/lennard-jones-fluid.html">Lennard Jones fluid</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../level1/breaking-a-carbon-nanotube.html">Pulling on a carbon nanotube</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 2</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="polymer-in-water.html">Polymer in water</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Nanosheared electrolyte</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 3</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../level3/water-adsorption-in-silica.html">Water adsorption in silica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../level3/free-energy-calculation.html">Free energy calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../level3/reactive-silicon-dioxide.html">Reactive silicon dioxide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extra content</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../non-tutorials/solutions.html">Solutions to the exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../miscellaneous/make-gorgeous-image.html">Make gorgeous image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../miscellaneous/use-gromacs-instead.html">Use GROMACS instead</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="nanosheared-electrolyte">
<span id="sheared-confined-label"></span><h1>Nanosheared electrolyte<a class="headerlink" href="#nanosheared-electrolyte" title="Link to this heading">#</a></h1>
<div class="hatnote docutils container">
<p>Aqueous NaCl solution sheared by two walls</p>
</div>
<figure class="align-right">
<a class="only-light reference internal image-reference" href="../../_images/nanoconfined-electrolyte-light.png"><img alt="Electrolyte nano-confined in a slit pore" class="only-light" src="../../_images/nanoconfined-electrolyte-light.png" style="height: 250px;" /></a>
</figure>
<figure class="align-right">
<a class="only-dark reference internal image-reference" href="../../_images/nanoconfined-electrolyte-dark.png"><img alt="Electrolyte nano-confined in a slit pore" class="only-dark" src="../../_images/nanoconfined-electrolyte-dark.png" style="height: 250px;" /></a>
</figure>
<div class="justify docutils container">
<p>The objective of this tutorial is to
simulate an electrolyte sheared by two walls. Some properties
of the sheared fluid, such as the time-averaged velocity profile
will be extracted.</p>
</div>
<div class="justify docutils container">
<p>This tutorial illustrates the important aspects of
combining a fluid and a solid in the same simulation.
Also, contrarily to the <a class="reference internal" href="polymer-in-water.html#all-atoms-label"><span class="std std-ref">Polymer in water</span></a> tutorial, a rigid
four points water model is used here.</p>
</div>
<p>If you are completely new to LAMMPS, I recommend you to follow this simpler tutorial first : <a class="reference internal" href="../level0/lennard-jones-fluid.html#lennard-jones-label"><span class="std std-ref">Lennard Jones fluid</span></a>.</p>
<div class="patreon admonition">
<p class="admonition-title">I provide personal assistance for LAMMPS projects</p>
<p>See the <a class="reference internal" href="../../miscellaneous/contact-me.html#contact-label"><span class="std std-ref">Contact me</span></a> page.</p>
</div>
<div class="version docutils container">
<p>This tutorial was tested with the <em>2Aug2023</em> LAMMPS version.</p>
</div>
<section id="system-generation">
<h2>System generation<a class="headerlink" href="#system-generation" title="Link to this heading">#</a></h2>
<div class="justify docutils container">
<p>Create a new folder called <em>SystemCreation/</em>. Within <em>SystemCreation/</em>,
open a blank file called <em>input.lammps</em>, and copy
the following lines into it:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># LAMMPS input file</span>

<span class="k">units</span><span class="w"> </span><span class="n">real</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">full</span>
<span class="k">bond_style</span><span class="w"> </span><span class="n">harmonic</span>
<span class="k">angle_style</span><span class="w"> </span><span class="n">harmonic</span>
<span class="k">pair_style</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.1546</span><span class="w"> </span><span class="m">12.0</span>
<span class="k">kspace_style</span><span class="w"> </span><span class="n">pppm</span><span class="o">/</span><span class="n">tip4p</span><span class="w"> </span><span class="m">1.0e-4</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>These lines are used to define the most basic parameters,
including the <em>atom</em>, <em>bond</em>, and <em>angle</em> styles, as well as
interaction potential (here Lennard Jones with cut-off and long
range Coulombic) and long range solver (here PPPM).</p>
</div>
<div class="justify docutils container">
<p>These lines are relatively similar to the
previous tutorial (<a class="reference internal" href="polymer-in-water.html#all-atoms-label"><span class="std std-ref">Polymer in water</span></a>),
with two major differences; the use of <em>lj/cut/tip4p/long</em>
and <em>pppm/tip4p</em>.
These two commands allow us to
model a four point water molecule without explicitly
defining the fourth massless atom <em>M</em>. The value of
<em>0.1546</em> corresponds to the <em>O-M</em> distance in Angstrom and is
given by the water model. Here, <a href="http://www.sklogwiki.org/SklogWiki/index.php/TIP4P/2005_model_of_water" target="_blank">TIP4P-2005</a> is used.</p>
</div>
<div class="info admonition">
<p class="admonition-title">About lj/cut/tip4p/long pair style</p>
<p>The lj/cut/tip4p/long pair style is similar to the conventional
Lennard Jones + Coulomb interaction, except that it is made specifically
for four point water model (tip4p). The atom of the water model
will be type 1 (O) and 2 (H). All the other atoms of the simulations
are treated <em>normally</em> with long range coulomb interaction.</p>
</div>
<div class="justify docutils container">
<p>Let us create the box by adding the following lines to <em>input.lammps</em>:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">lattice</span><span class="w"> </span><span class="n">fcc</span><span class="w"> </span><span class="m">4.04</span>
<span class="k">region </span><span class="nv nv-Identifier">box</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="o">-</span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="o">-</span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="o">-</span><span class="m">13</span><span class="w"> </span><span class="m">13</span>
<span class="k">create_box </span><span class="nv nv-Identifier">5</span><span class="w"> </span><span class="nv nv-Identifier">box</span><span class="w"> </span><span class="o">&amp;</span>
<span class="w">            </span><span class="n">bond</span><span class="o">/</span><span class="n">types</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;</span>
<span class="w">            </span><span class="n">angle</span><span class="o">/</span><span class="n">types</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;</span>
<span class="w">            </span><span class="n">extra</span><span class="o">/</span><span class="n">bond</span><span class="o">/</span><span class="n">per</span><span class="o">/</span><span class="n">atom</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">&amp;</span>
<span class="w">            </span><span class="n">extra</span><span class="o">/</span><span class="n">angle</span><span class="o">/</span><span class="n">per</span><span class="o">/</span><span class="n">atom</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;</span>
<span class="w">            </span><span class="n">extra</span><span class="o">/</span><span class="n">special</span><span class="o">/</span><span class="n">per</span><span class="o">/</span><span class="n">atom</span><span class="w"> </span><span class="m">2</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>The <em>lattice</em> command defines the unit
cell. Here, the face-centered cubic (fcc) lattice with a scale factor of
4.04 has been chosen for the future positioning of the atoms
of the walls.</p>
</div>
<div class="justify docutils container">
<p>The <em>region</em> command defines a geometric
region of space. By choosing <em>xlo=-4</em> and <em>xhi=4</em>, and
because we have previously chosen a lattice with scale
factor of 4.04, the region box extends from -16.16 Å to 16.16 Å.</p>
</div>
<div class="justify docutils container">
<p>The <em>create_box</em> command creates a simulation box with 5 types of atoms:the oxygen and hydrogen
of the water molecules, the two ions (<span class="math notranslate nohighlight">\(\text{Na}^+\)</span>,
<span class="math notranslate nohighlight">\(\text{Cl}^-\)</span>), and the
atom of the walls. The <em>create_box</em> command extends over 6 lines thanks to the
<span class="math notranslate nohighlight">\(\&amp;\)</span> character. The second and third lines are used to
indicate that the simulation contains 1 type of bond and 1
type of angle (both required by the water molecule). The parameters for
these bond and angle constraints will be given later. The
three last lines are for memory allocation.</p>
</div>
<div class="justify docutils container">
<p>Now, we can add atoms to the system. First, let us create two
sub-regions corresponding respectively to the two solid
walls, and create a larger region from the union of the two
regions. Then, let us create atoms of type 5 (the wall) within the two
regions. Add the following lines to <em>input.lammps</em>:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">region </span><span class="nv nv-Identifier">rbotwall</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="o">-</span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="o">-</span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="o">-</span><span class="m">12</span><span class="w"> </span><span class="o">-</span><span class="m">10</span>
<span class="k">region </span><span class="nv nv-Identifier">rtopwall</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="o">-</span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="o">-</span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">12</span>
<span class="k">region </span><span class="nv nv-Identifier">rwall</span><span class="w"> </span><span class="n">union</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="n">rbotwall</span><span class="w"> </span><span class="n">rtopwall</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="k">region </span><span class="nv nv-Identifier">rwall</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Atoms will be placed at the positions of the previously
defined lattice, thus forming fcc solids.</p>
</div>
<div class="justify docutils container">
<p>In order to add the water molecules, we first need to
download the <a href="../../../../../inputs/level2/nanosheared-electrolyte/TIP4P2005.txt" target="_blank">molecule template</a>
and place it next to <em>SystemCreation/</em>. The template contains all the
necessary information concerning the water molecule, such as
atom positions, bonds, and the angle.</p>
</div>
<div class="justify docutils container">
<p>Add the following lines to <em>input.lammps</em>:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">region </span><span class="nv nv-Identifier">rliquid</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="o">-</span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="o">-</span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="o">-</span><span class="m">9</span><span class="w"> </span><span class="m">9</span>
<span class="k">molecule</span><span class="w"> </span><span class="n">h2omol</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">TIP4P2005.txt</span>
<span class="k">lattice</span><span class="w"> </span><span class="n">sc</span><span class="w"> </span><span class="m">4.04</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="k">region </span><span class="nv nv-Identifier">rliquid</span><span class="w"> </span><span class="n">mol</span><span class="w"> </span><span class="n">h2omol</span><span class="w"> </span><span class="m">482793</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Withing the last four lines, a <em>region</em> named <em>rliquid</em> for depositing the water molecules is created based
on the last defined lattice, which is <em>fcc 4.04</em>.</p>
</div>
<div class="justify docutils container">
<p>The <em>molecule</em> command opens up the molecule template named
<em>TIP4P2005.txt</em>, and names the associated molecule <em>h2omol</em>.</p>
</div>
<div class="justify docutils container">
<p>A new simple cubic lattice is defined in order to place the water
molecules on it, with a distance of 4.04 Ångstroms between
each water molecule. Note that the new lattice replaces the
previous one, as LAMMPS reads a script from top to bottom.</p>
</div>
<div class="justify docutils container">
<p>The distance of 4.04 Ångstroms is larger than the typical
equilibrium distance between water molecules in a liquid,
but this will allow us to insert ions more safely (see below).</p>
</div>
<div class="justify docutils container">
<p>Molecules are created on the sc lattice by the <em>create_atoms</em> command. The
first parameter is ‘0’ because we use the atom id from the
<em>TIP4P2005.txt</em> file. The number <em>482793</em> is a seed that is
required by LAMMPS, it can be any positive integer.</p>
</div>
<div class="justify docutils container">
<p>Finally, let us create 20 ions (10 <span class="math notranslate nohighlight">\(\text{Na}^+\)</span> and 10 <span class="math notranslate nohighlight">\(\text{Cl}^-\)</span>)
in between the water molecules, by adding the following commands to <em>input.lammps</em>:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">create_atoms</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">52802</span><span class="w"> </span><span class="n">rliquid</span><span class="w"> </span><span class="n">overlap</span><span class="w"> </span><span class="m">0.3</span><span class="w"> </span><span class="n">maxtry</span><span class="w"> </span><span class="m">500</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">90182</span><span class="w"> </span><span class="n">rliquid</span><span class="w"> </span><span class="n">overlap</span><span class="w"> </span><span class="m">0.3</span><span class="w"> </span><span class="n">maxtry</span><span class="w"> </span><span class="m">500</span>
<span class="k">set</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">charge</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">set</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="n">charge</span><span class="w"> </span><span class="o">-</span><span class="m">1.0</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Each <em>create_atoms</em> command will add 10 ions at random positions
within the ‘rliquid’ region. Feel free to increase or decrease the salt
concentration by changing the number of desired ions. To keep the system charge neutral,
always insert the same number of
<span class="math notranslate nohighlight">\(\text{Na}^+\)</span> and <span class="math notranslate nohighlight">\(\text{Cl}^-\)</span>, unless of course there are other charges in the system.</p>
</div>
<div class="justify docutils container">
<p>The charges of the newly added ions are specified by the two <em>set</em> commands.</p>
</div>
<div class="justify docutils container">
<p>Before starting the simulation, we still need to define the parameters of the simulation: the mass
of the 5 atom types (O, H, <span class="math notranslate nohighlight">\(\text{Na}^+\)</span>, <span class="math notranslate nohighlight">\(\text{Cl}^-\)</span>, and wall), the
pairwise interaction parameters (here the parameters for the
Lennard-Jones potential), and the bond and angle parameters.
Copy the following line into input.lammps:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># settings</span>
<span class="k">include</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">PARM.lammps</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Create a new text file, call it <em>PARM.lammps</em>, and copy it
next to the <em>SystemCreation/</em> folder. Copy the following lines
into PARM.lammps:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># Parameter file</span>
<span class="k">mass</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">15.9994</span><span class="w"> </span><span class="c"># water</span>
<span class="k">mass</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1.008</span><span class="w"> </span><span class="c"># water</span>
<span class="k">mass</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">28.990</span><span class="w"> </span><span class="c"># ion</span>
<span class="k">mass</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">35.453</span><span class="w"> </span><span class="c"># ion</span>
<span class="k">mass</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">26.9815</span><span class="w"> </span><span class="c"># wall</span>

<span class="k">pair_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.185199</span><span class="w"> </span><span class="m">3.1589</span><span class="w"> </span><span class="c"># water</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="c"># water</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">0.04690</span><span class="w"> </span><span class="m">2.4299</span><span class="w"> </span><span class="c"># ion</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">0.1500</span><span class="w"> </span><span class="m">4.04470</span><span class="w"> </span><span class="c"># ion</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">11.697</span><span class="w"> </span><span class="m">2.574</span><span class="w"> </span><span class="c"># wall</span>

<span class="k">bond_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0.9572</span><span class="w"> </span><span class="c"># water</span>

<span class="k">angle_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">104.52</span><span class="w"> </span><span class="c"># water</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Each <em>mass</em> command assigns a mass in grams/mole to an atom type. Each
<em>pair_coeff</em> assigns respectively the depth of the LJ potential
(in Kcal/mole), and the distance (in Ångstrom) at which the
particle-particle potential energy is 0.</p>
</div>
<div class="info admonition">
<p class="admonition-title">About the parameters</p>
<p>The parameters for water
correspond to the TIP4P/2005 water model, and the parameters
for <span class="math notranslate nohighlight">\(\text{Na}^+\)</span> and <span class="math notranslate nohighlight">\(\text{Cl}^-\)</span>  are
taken from the CHARMM-27 force field.</p>
</div>
<div class="justify docutils container">
<p>As previously, only pairwise interaction between atoms of
identical type were assigned. By default, LAMMPS calculates
the pair coefficients for the interactions between atoms
of different types (i and j) by using geometrical
average: <span class="math notranslate nohighlight">\(\epsilon_{ij} = \epsilon_i + \epsilon_j)/2\)</span>,
<span class="math notranslate nohighlight">\(\sigma_{ij} = (\sigma_i + \sigma_j)/2.\)</span>
Other rules for cross coefficients can be set with the
<em>pair_modify</em> command, but for the sake of simplicity,
let us keep the default option here.</p>
</div>
<div class="justify docutils container">
<p>The <em>bond_coeff</em>, which is here used for the O-H bond of the water
molecule, sets both the energy of the harmonic
potential and the equilibrium distance in Ångstrom. The
value is <em>0</em> for the energy, because we are going to use a
rigid model for the water molecule. The shape of the
molecule will be preserved later by the <em>shake</em> algorithm.
Similarly, the angle coefficient here for the H-O-H angle
of the water molecule sets the energy of the harmonic
potential (also 0) and the equilibrium angle is in degree.</p>
</div>
<div class="justify docutils container">
<p>Finally, add the following lines to <em>input.lammps</em>:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">run</span><span class="w"> </span><span class="m">0</span>

<span class="k">write_data </span><span class="nv nv-Identifier">system.data</span>
<span class="k">write_dump </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="n">dump.lammpstrj</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>With <em>run 0</em>, the simulation will run for 0 step,
enough for creating the system and saving the final state.</p>
</div>
<div class="justify docutils container">
<p>The <em>write_data</em> finally creates a file named <em>system.data</em>
containing all the information required to restart the
simulation from the final configuration generated by this
input file.</p>
</div>
<div class="justify docutils container">
<p>The <em>write_dump</em> command prints the final
positions of the atoms, and can be opened with VMD
to visualize the system.</p>
</div>
<div class="justify docutils container">
<p>Run the <em>input.lammps</em> file using LAMMPS. From the <em>log</em> file, make
sure that atoms have been created (look for the lines <em>Created x atoms</em>), and
open the <em>dump.lammpstrj</em> file with VMD:</p>
</div>
<figure class="align-default">
<img alt="LAMMPS: electrolyte made of water and salt between walls" class="only-light" src="../../_images/systemcreation-light.png" />
</figure>
<figure class="align-default">
<img alt="LAMMPS: electrolyte made of water and salt between walls" class="only-dark" src="../../_images/systemcreation-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: The left panel is a side view of the system. Periodic images are represented in lighter
color. Water molecules are in red and white, <span class="math notranslate nohighlight">\(\text{Na}^+\)</span>
ions in purple, <span class="math notranslate nohighlight">\(\text{Cl}^-\)</span> ions in lime, and wall atoms in
gray. The right panel is the top view of the system. Note the absence of
atomic defect at the cell boundaries.</p>
</div>
<div class="justify docutils container">
<p>Always check that your system has been correctly created
by looking at the periodic images. Atomic defects often
occur at the boundary.</p>
</div>
</section>
<section id="energy-minimization">
<h2>Energy minimization<a class="headerlink" href="#energy-minimization" title="Link to this heading">#</a></h2>
<div class="info admonition">
<p class="admonition-title">Why is energy minimization necessary?</p>
<p>It is clear from the way the system has been created that
the atoms are not at equilibrium distances from each
others. Indeed, some of the ions added using the <em>create_atoms</em>
commands are too close to the water molecules.
If we were to start a molecular dynamics
simulation now (i.e. solve the equations of motion) with
a conventional timestep of 1 femto-seconds, the atoms
would exert huge forces on each others, accelerate
brutally, and the simulation would fail.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Dealing with overlapping atoms</p>
<p>MD simulations failing due to overlapping atoms are
extremely common, and I can almost guarantee that you
will face a similar issue at some point. If it occurs,
you can either</p>
<ul class="simple">
<li><p>delete the overlapping atoms using the <em>delete_atoms</em> command of LAMMPS, or</p></li>
<li><p>move the atoms to more reasonable distances before the simulation starts.</p></li>
</ul>
</div>
<div class="justify docutils container">
<p>Let us move the atoms and place them
in more energetically favorable positions before starting the simulation.
To perform the energy minimization with our system, let us
create a new folder named Minimization/, and create a new
input file named input.lammps in it. The first lines will be
very similar to the previous input file:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in Minimization/input.lammps</em></span><a class="headerlink" href="#id1" title="Link to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># Initialisation</span>
<span class="k">boundary</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span>
<span class="k">units</span><span class="w"> </span><span class="n">real</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">full</span>
<span class="k">bond_style</span><span class="w"> </span><span class="n">harmonic</span>
<span class="k">angle_style</span><span class="w"> </span><span class="n">harmonic</span>
<span class="k">pair_style</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.1546</span><span class="w"> </span><span class="m">12.0</span>
<span class="k">kspace_style</span><span class="w"> </span><span class="n">pppm</span><span class="o">/</span><span class="n">tip4p</span><span class="w"> </span><span class="m">1.0e-4</span>

<span class="c"># System definition</span>
<span class="k">read_data</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">SystemCreation</span><span class="o">/</span><span class="n">system.data</span>

<span class="c"># settings</span>
<span class="k">include</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">PARM.lammps</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>The only difference with the previous input is that, instead
of creating a new box and new atoms, we open the
previously created file <em>system.data</em> located in <em>SystemCreation/</em>.
<em>system.data</em> contains the definition of the simulation box and the positions of the atoms.</p>
<p>Next, let us create a group for the water:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in Minimization/input.lammps</em></span><a class="headerlink" href="#id2" title="Link to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">group </span><span class="nv nv-Identifier">gH2O</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>Creating groups will allow us to apply different dynamics and constraints to the
liquid and to the walls.</p>
<p>Let us also print the atoms positions in a dump file:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in Minimization/input.lammps</em></span><a class="headerlink" href="#id3" title="Link to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">dump </span><span class="nv nv-Identifier">mydmp</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">dump.lammpstrj</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>Now, we can include the most important commands for the
minimization:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">mynve</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nve</span><span class="o">/</span><span class="n">limit</span><span class="w"> </span><span class="m">0.1</span>
<span class="k">fix </span><span class="nv nv-Identifier">myber</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">temp</span><span class="o">/</span><span class="n">berendsen</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>The fix <em>nve/limit</em> performs constant NVE integration to
update positions and velocities of the atoms at each
timestep, but limit the maximum motion an atom can do at
every timestep. The temp/berendsen fix rescales the
velocities of the atoms every timestep in order to reset the
temperature.</p>
</div>
<div class="justify docutils container">
<p>Since we want to perform a minimization step, both initial
and final temperatures have been chosen equal to 1K. The
third parameter is the damping factor, in time units, which
determines how rapidly the temperature is relaxed. Such
damping factor of 1 fs would be too small for a regular
molecular dynamics simulation, but is acceptable for a
minimization step during which we just want the atoms to
move slightly from their initial positions.</p>
</div>
<div class="justify docutils container">
<p>If we were to run the simulation as it is, it would fail
because nothing maintains the shape of the water molecules
(and the bond and angle energies are equal to 0). Let us use
the shake algorithm in order to maintain the shape of the
molecules. In addition, let us add a fix <em>recenter</em> in order
to maintain the system centered in the middle of the box in
the <em>z</em> direction:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">myshk</span><span class="w"> </span><span class="nv nv-Identifier">gH2O</span><span class="w"> </span><span class="n">shake</span><span class="w"> </span><span class="m">1.0e-4</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="m">1</span>
<span class="k">fix </span><span class="nv nv-Identifier">myrct</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">recenter</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">INIT</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Fix recenter has no influence on the dynamics, but will keep the system in the
center of the box, which makes the visualization easier.</p>
<p>Finally, let us choose a small timestep (because we
anticipate that the atoms are initially too close to each
others) and run for 10000 steps:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in Minimization/input.lammps</em></span><a class="headerlink" href="#id4" title="Link to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">timestep</span><span class="w"> </span><span class="m">0.5</span>
<span class="k">thermo</span><span class="w"> </span><span class="m">50</span>
<span class="k">run</span><span class="w"> </span><span class="m">10000</span>
<span class="k">write_data </span><span class="nv nv-Identifier">system.data</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>When running the input.lammps file, you should see that the
total energy of the system decreases as expected (fifth
colum):</p>
</div>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>Step   Temp          E_pair         E_mol          TotEng         Press
    0   0             -99554.799      0             -99554.799     -1008.4767
50   3.492673      -107825.17      0             -107786.32     -19733.701
100   2.6260191     -108926.18      0             -108896.97     -20225.668
150   2.2025292     -109692.83      0             -109668.34     -20319.962
(...)
9800   1.0233163     -120975.23      0             -120963.85     -12590.345
9850   1.022532      -120988.11      0             -120976.74     -12582.803
9900   1.0222164     -121000.48      0             -120989.11     -12573.028
9950   1.0215887     -121012.78      0             -121001.42     -12562.843
10000   1.0206449     -121024.53      0             -121013.18     -12551.132
</pre></div>
</div>
<div class="justify docutils container">
<p>You can easily import log file into <em>Python</em> using the
<a href="https://pypi.org/project/lammps-logfile/" target="_blank">LAMMPS logfile</a> tool, and plot the thermodynamic quantities as a function
of the time:</p>
</div>
<figure class="align-default">
<img alt="Energy minimisation of the confined water and salt" class="only-light" src="../../_images/minimization-light.png" />
</figure>
<figure class="align-default" id="id5">
<img alt="Energy minimisation of the confined water and salt" class="only-dark" src="../../_images/minimization-dark.png" />
<figcaption>
<p><span class="caption-text">Energy as a function of time extracted from the log file using <em>Python</em> and
<em>lammps_logfile</em>.</span><a class="headerlink" href="#id5" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="justify docutils container">
<p>If you look at the trajectory using VMD, you will see some
of the atoms (the one that where initially in a problematic
position) slightly move from each others, as seen in <a href="https://youtu.be/JWGZnFN4TOo" target="_blank">this video</a>.</p>
</div>
</section>
<section id="system-equilibration">
<h2>System equilibration<a class="headerlink" href="#system-equilibration" title="Link to this heading">#</a></h2>
<div class="justify docutils container">
<p>Now, let us properly equilibrate the system by letting both
fluid and piston relax at ambient temperature.</p>
<p>Create a new folder called <em>Equilibration/</em>, create a new
input file in it, and add the following lines:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in Equilibration/input.lammps</em></span><a class="headerlink" href="#id6" title="Link to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># Initialisation</span>
<span class="k">boundary</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span>
<span class="k">units</span><span class="w"> </span><span class="n">real</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">full</span>
<span class="k">bond_style</span><span class="w"> </span><span class="n">harmonic</span>
<span class="k">angle_style</span><span class="w"> </span><span class="n">harmonic</span>
<span class="k">pair_style</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.1546</span><span class="w"> </span><span class="m">12.0</span>
<span class="k">kspace_style</span><span class="w"> </span><span class="n">pppm</span><span class="o">/</span><span class="n">tip4p</span><span class="w"> </span><span class="m">1.0e-4</span>

<span class="c"># System definition</span>
<span class="k">read_data</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">Minimization</span><span class="o">/</span><span class="n">system.data</span>

<span class="c"># Simulation settings</span>
<span class="k">include</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">PARM.lammps</span>

<span class="c"># Define groups</span>
<span class="k">group </span><span class="nv nv-Identifier">gH2O</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span>
<span class="k">group </span><span class="nv nv-Identifier">gNa</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">3</span>
<span class="k">group </span><span class="nv nv-Identifier">gCl</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">4</span>
<span class="k">group </span><span class="nv nv-Identifier">gliquid</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span>
<span class="k">group </span><span class="nv nv-Identifier">gwall</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">5</span>
<span class="k">region </span><span class="nv nv-Identifier">rtop</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">INF</span>
<span class="k">region </span><span class="nv nv-Identifier">rbot</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="m">0</span>
<span class="k">group </span><span class="nv nv-Identifier">gtop</span><span class="w"> </span><span class="k">region </span><span class="nv nv-Identifier">rtop</span>
<span class="k">group </span><span class="nv nv-Identifier">gbot</span><span class="w"> </span><span class="k">region </span><span class="nv nv-Identifier">rbot</span>
<span class="k">group </span><span class="nv nv-Identifier">gwalltop</span><span class="w"> </span><span class="n">intersect</span><span class="w"> </span><span class="n">gwall</span><span class="w"> </span><span class="n">gtop</span>
<span class="k">group </span><span class="nv nv-Identifier">gwallbot</span><span class="w"> </span><span class="n">intersect</span><span class="w"> </span><span class="n">gwall</span><span class="w"> </span><span class="n">gbot</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>Here, several groups have been defined in order to differentiate
between solid, liquid (salt+water), <span class="math notranslate nohighlight">\(\text{Na}^+\)</span>, etc. (although
not all of them are used). In addition, groups containing only the
top wall (gwalltop) and the bottom wall (gwallbot) have been
created using the intersect keyword: the intersection
between all the atom on the top part of the box (gtop) and
all the atom of type 5 (gwall) corresponds to the top wall.</p>
<p>Then, add the following lines for the visualisation :</p>
</div>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in Equilibration/input.lammps</em></span><a class="headerlink" href="#id7" title="Link to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># visualisation</span>
<span class="k">dump </span><span class="nv nv-Identifier">mydmp</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">dump.lammpstrj</span>
<span class="k">thermo</span><span class="w"> </span><span class="m">50</span>
<span class="k">variable </span><span class="nv nv-Identifier">walltopz</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">xcm</span><span class="nv">(gwalltop,z)</span>
<span class="k">variable </span><span class="nv nv-Identifier">wallbotz</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">xcm</span><span class="nv">(gwallbot,z)</span>
<span class="k">variable </span><span class="nv nv-Identifier">deltaz</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">v_walltopz</span><span class="o">-</span><span class="n">v_wallbotz</span>
<span class="k">fix </span><span class="nv nv-Identifier">myat1</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">time</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="n">v_deltaz</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">interwall_distance.dat</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>The two variables allow to extract the centers of mass of
the two walls, respectively, and the deltaz variable
calculates the difference between the two centers of mass.</p>
<p>Finally, add the end of the input:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in Equilibration/input.lammps</em></span><a class="headerlink" href="#id8" title="Link to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># Dynamics</span>
<span class="k">fix </span><span class="nv nv-Identifier">mynve</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nve</span>
<span class="k">compute </span><span class="nv nv-Identifier">tliq</span><span class="w"> </span><span class="nv nv-Identifier">gliquid</span><span class="w"> </span><span class="n">temp</span>
<span class="k">fix </span><span class="nv nv-Identifier">myber1</span><span class="w"> </span><span class="nv nv-Identifier">gliquid</span><span class="w"> </span><span class="n">temp</span><span class="o">/</span><span class="n">berendsen</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">100</span>
<span class="k">fix_modify </span><span class="nv nv-Identifier">myber1</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">tliq</span>
<span class="k">compute </span><span class="nv nv-Identifier">twall</span><span class="w"> </span><span class="nv nv-Identifier">gwall</span><span class="w"> </span><span class="n">temp</span>
<span class="k">fix </span><span class="nv nv-Identifier">myber2</span><span class="w"> </span><span class="nv nv-Identifier">gwall</span><span class="w"> </span><span class="n">temp</span><span class="o">/</span><span class="n">berendsen</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">100</span>
<span class="k">fix_modify </span><span class="nv nv-Identifier">myber2</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">twall</span>
<span class="k">fix </span><span class="nv nv-Identifier">myshk</span><span class="w"> </span><span class="nv nv-Identifier">gH2O</span><span class="w"> </span><span class="n">shake</span><span class="w"> </span><span class="m">1.0e-4</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="m">1</span>
<span class="k">fix </span><span class="nv nv-Identifier">myrct</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">recenter</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">INIT</span>

<span class="k">timestep</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">run</span><span class="w"> </span><span class="m">20000</span>
<span class="k">write_data </span><span class="nv nv-Identifier">system.data</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>The main differences with the previous step (minimize) are
the timestep of 1 fs instead of 0.5 fs, the thermostat that imposes a temperature of 300 K, for which the
fluid is expected to behave as a liquid, and the two thermostats are used instead of one:
one for the fluid, one for the solid (the use of <em>fix_modify</em> ensures
that the right temperature is used by the temp/berenden).</p>
</div>
<div class="justify docutils container">
<p>Run the input script. Note, I am running on 4 CPU cores using:</p>
</div>
<div class="highlight-bw notranslate"><div class="highlight"><pre><span></span>mpirun -np 4 lmp -in input.lammps
</pre></div>
</div>
<div class="justify docutils container">
<p>To complete the 20000 steps (20 ps), it takes about 6 minutes. The duration
may differ on your computer.</p>
<p>The distance between the two walls
reduces until it reaches an equilibrium value (see the data
printed by <em>fix myat1</em>):</p>
</div>
<figure class="align-default">
<img alt="Plot showing the distance between the walls as a function of time." class="only-light" src="../../_images/equilibration-light.png" />
</figure>
<figure class="align-default" id="id9">
<img alt="Plot showing the distance between the walls as a function of time." class="only-dark" src="../../_images/equilibration-dark.png" />
<figcaption>
<p><span class="caption-text">Distance between the walls as a function of time. After 10 ps, the
distance between the walls is very close to its final equilibrium value.</span><a class="headerlink" href="#id9" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="justify docutils container">
<p>Note that for actual reseach, it is recommended to run this equilibration step for longer times
to make sure that proper equilibration was reached. Here, since the slowest
process is the ionic diffusion, the equilibration
should be longer than the typical diffusion time of the ions over the
size of the pore (~3 nm), i.e. of the order of the nanosecond.</p>
</div>
</section>
<section id="imposed-shearing">
<h2>Imposed shearing<a class="headerlink" href="#imposed-shearing" title="Link to this heading">#</a></h2>
<div class="justify docutils container">
<p>From the equilibrated configuration, let us impose the
motion of the two walls in order to shear the electrolyte.
In a new folder called <em>Shearing/</em>,
create a new input that starts like the previous ones:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id10">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in Shearing/input.lammps</em></span><a class="headerlink" href="#id10" title="Link to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># Initialisation</span>
<span class="k">boundary</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="n">p</span>
<span class="k">units</span><span class="w"> </span><span class="n">real</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">full</span>
<span class="k">bond_style</span><span class="w"> </span><span class="n">harmonic</span>
<span class="k">angle_style</span><span class="w"> </span><span class="n">harmonic</span>
<span class="k">pair_style</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.1546</span><span class="w"> </span><span class="m">12.0</span>
<span class="k">kspace_style</span><span class="w"> </span><span class="n">pppm</span><span class="o">/</span><span class="n">tip4p</span><span class="w"> </span><span class="m">1.0e-4</span>

<span class="c"># System definition</span>
<span class="k">read_data</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">Equilibration</span><span class="o">/</span><span class="n">system.data</span>
<span class="k">change_box </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="n">final</span><span class="w"> </span><span class="o">-</span><span class="m">40</span><span class="w"> </span><span class="m">40</span>

<span class="c"># Simulation settings</span>
<span class="k">include</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">PARM.lammps</span>

<span class="c"># Groups</span>
<span class="k">group </span><span class="nv nv-Identifier">gH2O</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span>
<span class="k">group </span><span class="nv nv-Identifier">gNa</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">3</span>
<span class="k">group </span><span class="nv nv-Identifier">gCl</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">4</span>
<span class="k">group </span><span class="nv nv-Identifier">gliquid</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">4</span>
<span class="k">group </span><span class="nv nv-Identifier">gwall</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">5</span>
<span class="k">region </span><span class="nv nv-Identifier">rtop</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">INF</span>
<span class="k">region </span><span class="nv nv-Identifier">rbot</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="n">INF</span><span class="w"> </span><span class="m">0</span>
<span class="k">group </span><span class="nv nv-Identifier">gtop</span><span class="w"> </span><span class="k">region </span><span class="nv nv-Identifier">rtop</span>
<span class="k">group </span><span class="nv nv-Identifier">gbot</span><span class="w"> </span><span class="k">region </span><span class="nv nv-Identifier">rbot</span>
<span class="k">group </span><span class="nv nv-Identifier">gwalltop</span><span class="w"> </span><span class="n">intersect</span><span class="w"> </span><span class="n">gwall</span><span class="w"> </span><span class="n">gtop</span>
<span class="k">group </span><span class="nv nv-Identifier">gwallbot</span><span class="w"> </span><span class="n">intersect</span><span class="w"> </span><span class="n">gwall</span><span class="w"> </span><span class="n">gbot</span>

<span class="c"># Dynamics</span>
<span class="k">fix </span><span class="nv nv-Identifier">mynve</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nve</span>
<span class="k">compute </span><span class="nv nv-Identifier">tliq</span><span class="w"> </span><span class="nv nv-Identifier">gliquid</span><span class="w"> </span><span class="n">temp</span><span class="o">/</span><span class="n">partial</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span>
<span class="k">fix </span><span class="nv nv-Identifier">myber1</span><span class="w"> </span><span class="nv nv-Identifier">gliquid</span><span class="w"> </span><span class="n">temp</span><span class="o">/</span><span class="n">berendsen</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">100</span>
<span class="k">fix_modify </span><span class="nv nv-Identifier">myber1</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">tliq</span>
<span class="k">compute </span><span class="nv nv-Identifier">twall</span><span class="w"> </span><span class="nv nv-Identifier">gwall</span><span class="w"> </span><span class="n">temp</span><span class="o">/</span><span class="n">partial</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span>
<span class="k">fix </span><span class="nv nv-Identifier">myber2</span><span class="w"> </span><span class="nv nv-Identifier">gwall</span><span class="w"> </span><span class="n">temp</span><span class="o">/</span><span class="n">berendsen</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">100</span>
<span class="k">fix_modify </span><span class="nv nv-Identifier">myber2</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">twall</span>
<span class="k">fix </span><span class="nv nv-Identifier">myshk</span><span class="w"> </span><span class="nv nv-Identifier">gH2O</span><span class="w"> </span><span class="n">shake</span><span class="w"> </span><span class="m">1.0e-4</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="m">1</span>
<span class="k">fix </span><span class="nv nv-Identifier">myrct</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">recenter</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">INIT</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>The main difference with the previous <em>equilibration</em> step, so far, is
the use of temperature <em>compute</em> with <em>temp/partial 0 1 1</em> options.
This is meant to exclude the <em>x</em> coordinate from the thermalisation, which is
important since a large velocity will be imposed along <em>x</em>. Another difference is the
<em>change_box</em> command used to reduce the size of the box along <em>z</em> (otherwise there
is too much unecessary vacuum).</p>
<p>Then, let us impose the motion of the two walls:</p>
</div>
<div class="literal-block-wrapper docutils container" id="id11">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in Shearing/input.lammps</em></span><a class="headerlink" href="#id11" title="Link to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">mysf1</span><span class="w"> </span><span class="nv nv-Identifier">gwalltop</span><span class="w"> </span><span class="n">setforce</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">NULL</span>
<span class="k">fix </span><span class="nv nv-Identifier">mysf2</span><span class="w"> </span><span class="nv nv-Identifier">gwallbot</span><span class="w"> </span><span class="n">setforce</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">NULL</span>
<span class="k">velocity </span><span class="nv nv-Identifier">gwallbot</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="o">-</span><span class="m">20e-5</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">NULL</span>
<span class="k">velocity </span><span class="nv nv-Identifier">gwalltop</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="m">20e-5</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">NULL</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>The <em>setforce</em> commands cancel the forces on a group of atoms at
every timestep, so the atoms of the group do not
experience any force from the rest of the system. In absence of force
acting on those atoms, they will conserve their initial velocity.</p>
<p>The <em>velocity</em> commands act only once and impose
the velocity of the atoms of the groups <em>gwallbot</em> and <em>gwalltop</em>, respectively.</p>
<p>Finally, let us dump the atom positions, extract the
velocity profile using the ave/chunk command, extract the
force applied on the walls, and then run for 20 ps (feel free to increase the duration
for more accurate velocity profile):</p>
</div>
<div class="literal-block-wrapper docutils container" id="id12">
<div class="code-block-caption"><span class="caption-text"><em>to be copied in Shearing/input.lammps</em></span><a class="headerlink" href="#id12" title="Link to this code">#</a></div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># vizualisation</span>
<span class="k">dump </span><span class="nv nv-Identifier">mydmp</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="m">5000</span><span class="w"> </span><span class="n">dump.lammpstrj</span>
<span class="k">thermo</span><span class="w"> </span><span class="m">500</span>
<span class="k">thermo_modify</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">tliq</span>

<span class="k">compute </span><span class="nv nv-Identifier">cc1</span><span class="w"> </span><span class="nv nv-Identifier">gliquid</span><span class="w"> </span><span class="n">chunk</span><span class="o">/</span><span class="n">atom</span><span class="w"> </span><span class="n">bin</span><span class="o">/</span><span class="m">1</span><span class="n">d</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">fix </span><span class="nv nv-Identifier">myac1</span><span class="w"> </span><span class="nv nv-Identifier">gliquid</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">chunk</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">1500</span><span class="w"> </span><span class="m">20000</span><span class="w"> </span><span class="n">cc1</span><span class="w"> </span><span class="n">vx</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">vel.profile.dat</span>
<span class="k">compute </span><span class="nv nv-Identifier">cc2</span><span class="w"> </span><span class="nv nv-Identifier">gwall</span><span class="w"> </span><span class="n">chunk</span><span class="o">/</span><span class="n">atom</span><span class="w"> </span><span class="n">bin</span><span class="o">/</span><span class="m">1</span><span class="n">d</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">fix </span><span class="nv nv-Identifier">myac2</span><span class="w"> </span><span class="nv nv-Identifier">gwall</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">chunk</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">1500</span><span class="w"> </span><span class="m">20000</span><span class="w"> </span><span class="n">cc2</span><span class="w"> </span><span class="n">vx</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">vel.solid.dat</span>

<span class="k">fix </span><span class="nv nv-Identifier">myat1</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">time</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">f_mysf1[1]</span><span class="w"> </span><span class="n">f_mysf2[1]</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">forces.dat</span>

<span class="k">timestep</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">run</span><span class="w"> </span><span class="m">20000</span>
<span class="k">write_data </span><span class="nv nv-Identifier">system.data</span>
</pre></div>
</div>
</div>
<div class="justify docutils container">
<p>Note that a duration of 20 ps is too short to measure meaningfull quantities.
If you computer allows it, use 200 ps instead.</p>
<p>The averaged velocity profile (with a 200 ps run) is the following:</p>
</div>
<figure class="align-default">
<img alt="Velocity of the nanosheared fluid Video of sheared fluid" class="only-light" src="../../_images/shearing-light.png" />
</figure>
<figure class="align-default" id="id13">
<img alt="Velocity of the nanosheared fluid Video of sheared fluid" class="only-dark" src="../../_images/shearing-dark.png" />
<figcaption>
<p><span class="caption-text">Velocity profiles for both fluid (<span class="math notranslate nohighlight">\(-1.5 &lt; z &lt; 1.5\)</span> nm) and walls as a function
of the <em>z</em> distance.</span><a class="headerlink" href="#id13" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="justify docutils container">
<p>From the force applied by the fluid on the solid, one can
extract the stress within the fluid, which allows one to
measure its viscosity <span class="math notranslate nohighlight">\(\dot{\eta}\)</span>
according to <a href="https://pure.tudelft.nl/ws/portalfiles/portal/89280267/PhysRevFluids.6.034303.pdf" target="_blank">gravelle2021</a>:
<span class="math notranslate nohighlight">\(\eta = \tau / \dot{\gamma}\)</span> where <span class="math notranslate nohighlight">\(\tau\)</span>
is the stress applied by the fluid on the shearing wall, and
<span class="math notranslate nohighlight">\(\dot{\gamma}\)</span> the shear rate (which is imposed
here). Here the shear rate is approximatively 6.25e9
s-1, and using a surface area of 1e-17 m2, I
get a viscosity for the fluid equal to 2.25 mPa.s</p>
<p>The viscosity calculated at such high shear rate may
differ from the bulk value. In general, it is recommanded to use a lower
value for the shear rate. Note that for lower shear rate, the ratio noise-to-signal
is larger, and longer simulations must be performed.</p>
<p>Also note that the viscosity of a fluid next to a solid surface is
typically larger than in bulk due to interaction with the
walls. Therefore one expect the present simulation to return
a viscosity that is slightly larger than what would be measured with
the fluid alone.</p>
</div>
<p>You can access all the input scripts and data files that
are used in these tutorials from <a href="https://github.com/lammpstutorials/lammpstutorials.github.io/tree/version2.0/docs/inputs" target="_blank">the inputs folder</a> on Github.</p>
</section>
<section id="going-further-with-exercises">
<h2>Going further with exercises<a class="headerlink" href="#going-further-with-exercises" title="Link to this heading">#</a></h2>
<div class="solution admonition">
<p class="admonition-title">Solutions</p>
<p>Register as a <a href="https://www.patreon.com/molecularsimulations" target="_blank">Patreon</a> for 1 euro/month
to access all the solutions.</p>
</div>
<section id="density-profiles">
<h3>Density profiles<a class="headerlink" href="#density-profiles" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>Perform an equilibrium simulation, and extract both density
profiles and diffusion coefficients in all 3 directions of
space.</p>
<p>Hint: in general, data extraction can ne done either (1)
using the internal LAMMPS commands (e.g. variable/compute
+ fix ave/time), or (2) using a post-processing analysis
tool (e.g. Python).</p>
</div>
</section>
<section id="poiseuille-flow">
<h3>Poiseuille flow<a class="headerlink" href="#poiseuille-flow" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>Instead of inducing shearing using the walls, induce a flow
of the liquid in the direction tangential to the walls, and
extract the the velocity profile.</p>
<p>Advice: the forcing must be chosen with care. If too
large, the system will be strongly out-of-equilibrium. If
too small, no net velocity will be measured because of
the thermal noise.</p>
<p>Question: Is the velocity profile you obtain consistent with
Poiseuille’s predictions?</p>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../level3/water-adsorption-in-silica.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Water adsorption in silica</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="polymer-in-water.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Polymer in water</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Nanosheared electrolyte</a><ul>
<li><a class="reference internal" href="#system-generation">System generation</a></li>
<li><a class="reference internal" href="#energy-minimization">Energy minimization</a></li>
<li><a class="reference internal" href="#system-equilibration">System equilibration</a></li>
<li><a class="reference internal" href="#imposed-shearing">Imposed shearing</a></li>
<li><a class="reference internal" href="#going-further-with-exercises">Going further with exercises</a><ul>
<li><a class="reference internal" href="#density-profiles">Density profiles</a></li>
<li><a class="reference internal" href="#poiseuille-flow">Poiseuille flow</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>