<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="../_static/favicon-32x32.png" sizes="32x32" rel="icon" type="image/png"><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>Prepare and relax - </title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=b1e702db" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">    </div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">    </span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../non-tutorials/scope.html">Scope</a></li>
<li class="toctree-l1"><a class="reference internal" href="../non-tutorials/prerequisites.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../non-tutorials/contact.html">Contact</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial1/lennard-jones-fluid.html">Lennard-Jones fluid</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial2/breaking-a-carbon-nanotube.html">Pulling on a carbon nanotube</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial3/polymer-in-water.html">Polymer in water</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial4/nanosheared-electrolyte.html">Nanosheared electrolyte</a></li>
<li class="toctree-l1"><a class="reference internal" href="reactive-silicon-dioxide.html">Reactive silicon dioxide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial6/water-adsorption-in-silica.html">Water adsorption in silica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial7/free-energy-calculation.html">Free energy calculation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extra content</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../non-tutorials/solutions.html">Solutions to the exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../non-tutorials/glossary.html">LAMMPS Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../non-tutorials/bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../non-tutorials/using-lammps-gui.html">Using LAMMPS–GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../non-tutorials/running-lammps.html">Running LAMMPS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../non-tutorials/command-line.html">Command line</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/tutorial5/tutorial.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="prepare-and-relax">
<h1>Prepare and relax<a class="headerlink" href="#prepare-and-relax" title="Link to this heading">¶</a></h1>
<p>The first step is to relax the structure with ReaxFF, which which will be achieved using
molecular dynamics.  To ensure the system equilibrates properly, we will monitor certain
parameters over time, such as the system volume.</p>
<p>Create a folder if needed and
place the initial input file, <strong>relax.lmp</strong>, into it. Then, open the
file in a text editor of your choice, and copy the following into it:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">units</span><span class="w"> </span><span class="n">real</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">full</span>

<span class="k">read_data</span><span class="w"> </span><span class="n">silica.data</span>
</pre></div>
</div>
<div class="gui admonition">
<p class="admonition-title">If you are using LAMMPS-GUI</p>
<p>To begin this tutorial, select <code class="docutils literal notranslate"><span class="pre">Start</span> <span class="pre">Tutorial</span> <span class="pre">5</span></code> from the
<code class="docutils literal notranslate"><span class="pre">Tutorials</span></code> menu of LAMMPS–GUI and follow the instructions.
The editor should display the following content corresponding to <strong>relax.lmp</strong></p>
</div>
<p>So far, the input is very similar to what was seen in the previous tutorials.
Some basic parameters are defined (<code class="docutils literal notranslate"><span class="pre">units</span></code> and <code class="docutils literal notranslate"><span class="pre">atom_style</span></code>),
and a <strong>.data</strong> file is imported by the <code class="docutils literal notranslate"><span class="pre">read_data</span></code> command.</p>
<p>The initial topology given by <a href="../../../../../.dependencies/lammpstutorials-inputs/tutorial5/silica.data" target="_blank">silica.data</a>
is a small amorphous silica structure.  This structure was created using a force field called
Vashishta <span id="id1">[<a class="reference internal" href="../non-tutorials/bibliography.html#id49" title="P Vashishta, Rajiv K Kalia, José P Rino, and Ingvar Ebbsjö. Interaction potential for SiO2: a molecular-dynamics study of structural correlations. Physical Review B, 41(17):12197, 1990.">40</a>]</span>.  If you open the <strong>silica.data</strong>
file, you will find in the <code class="docutils literal notranslate"><span class="pre">Atoms</span></code> section that all silicon atoms have a
charge of <span class="math notranslate nohighlight">\(q = 1.1\,\text{e}\)</span>, and all oxygen atoms have a charge of <span class="math notranslate nohighlight">\(q = -0.55\,\text{e}\)</span>.</p>
<div class="non-title-info admonition">
<p class="admonition-title">Note</p>
<p>Assigning the same charge to all atoms of the same type is common with many
force fields, including the force fields used in the previous tutorials.  This
changes once ReaxFF is used: the charge of each atom will adjust to its local
environment.</p>
</div>
<p>Next, copy the following three crucial lines into the <strong>relax.lmp</strong> file:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">pair_style</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">safezone</span><span class="w"> </span><span class="m">3.0</span><span class="w"> </span><span class="n">mincap</span><span class="w"> </span><span class="m">150</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">reaxCHOFe.inc</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span>
<span class="k">fix </span><span class="nv nv-Identifier">myqeq</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">qeq</span><span class="o">/</span><span class="n">reaxff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">10.0</span><span class="w"> </span><span class="m">1.0e-6</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">maxiter</span><span class="w"> </span><span class="m">400</span>
</pre></div>
</div>
<p>In this case, the <code class="docutils literal notranslate"><span class="pre">pair_style</span> <span class="pre">reaxff</span></code> is used without a control file.  The
<code class="docutils literal notranslate"><span class="pre">safezone</span></code> and <code class="docutils literal notranslate"><span class="pre">mincap</span></code> keywords are added to prevent
allocation issues, which sometimes can trigger segmentation faults and
<code class="docutils literal notranslate"><span class="pre">bondchk</span></code> errors.  The <code class="docutils literal notranslate"><span class="pre">pair_coeff</span></code> command uses the <a href="../../../../../.dependencies/lammpstutorials-inputs/tutorial5/reaxCHOFe.inc" target="_blank">reaxCHOFe.inc</a>
file, which should have been downloaded during the tutorial set up.  Finally, the
<code class="docutils literal notranslate"><span class="pre">fix</span> <span class="pre">qeq/reaxff</span></code> is used to perform charge equilibration <span id="id2">[<a class="reference internal" href="../non-tutorials/bibliography.html#id24" title="Anthony K Rappe and William A Goddard III. Charge equilibration for molecular dynamics simulations. The Journal of Physical Chemistry, 95(8):3358–3363, 1991.">41</a>]</span>,
which occurs at every step.  The values 0.0 and 10.0 represent the
low and the high cutoffs, respectively, and <span class="math notranslate nohighlight">\(1.0 \text{e} -6\)</span> is the tolerance.
The <code class="docutils literal notranslate"><span class="pre">maxiter</span></code> sets an upper limit to the number of attempts to
equilibrate the charge.</p>
<p>Next, add the following commands to the <strong>relax.lmp</strong> file to track the
evolution of the charges during the simulation:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">group </span><span class="nv nv-Identifier">grpSi</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">Si</span>
<span class="k">group </span><span class="nv nv-Identifier">grpO</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">O</span>
<span class="k">variable </span><span class="nv nv-Identifier">qSi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpSi)</span><span class="o">/</span><span class="n">count</span><span class="nv">(grpSi)</span>
<span class="k">variable </span><span class="nv nv-Identifier">qO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpO)</span><span class="o">/</span><span class="n">count</span><span class="nv">(grpO)</span>
<span class="k">variable </span><span class="nv nv-Identifier">vq</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="n">q</span>
</pre></div>
</div>
<p>To print the averaged charges <code class="docutils literal notranslate"><span class="pre">qSi</span></code> and <code class="docutils literal notranslate"><span class="pre">qO</span></code> using the
<code class="docutils literal notranslate"><span class="pre">thermo_style</span></code> command, and create images of the system.  Add the
following lines to <strong>relax.lmp</strong>:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">thermo</span><span class="w"> </span><span class="m">100</span>
<span class="k">thermo_style</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">etotal</span><span class="w"> </span><span class="n">press</span><span class="w"> </span><span class="n">vol</span><span class="w"> </span><span class="n">v_qSi</span><span class="w"> </span><span class="n">v_qO</span>
<span class="k">dump </span><span class="nv nv-Identifier">viz</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="n">myimage</span><span class="o">-*</span><span class="n">.ppm</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">shiny</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="n">box</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="m">0.01</span><span class="w"> </span><span class="n">view</span><span class="w"> </span><span class="m">180</span><span class="w"> </span><span class="m">90</span><span class="w"> </span><span class="n">zoom</span><span class="w"> </span><span class="m">2.3</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="m">1200</span><span class="w"> </span><span class="m">500</span>
<span class="k">dump_modify </span><span class="nv nv-Identifier">viz</span><span class="w"> </span><span class="n">adiam</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="m">2.6</span><span class="w"> </span><span class="n">adiam</span><span class="w"> </span><span class="n">O</span><span class="w"> </span><span class="m">2.3</span><span class="w"> </span><span class="n">backcolor</span><span class="w"> </span><span class="n">white</span><span class="w"> </span><span class="n">amap</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="n">ca</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="n">royalblue</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">green</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="n">orangered</span>
</pre></div>
</div>
<p>Here, the atoms are colored by their charges <code class="docutils literal notranslate"><span class="pre">q</span></code>, ranging from royal blue
(when <span class="math notranslate nohighlight">\(q=-1\,\text{e}\)</span>) to orange-red (when <span class="math notranslate nohighlight">\(q=2\,\text{e}\)</span>).</p>
<figure class="align-default">
<img alt="Amorphous silica colored by charges using VMD" class="only-light" src="../_images/silicon-light.png" />
</figure>
<figure class="align-default">
<img alt="Amorphous silica colored by charges using VMD" class="only-dark" src="../_images/silicon-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Amorphous silicon oxide. The atoms are colored by their
charges.  Dangling oxygen groups appear in greenish, bulk Si atoms with a charge of
about <span class="math notranslate nohighlight">\(1.8~\text{e}\)</span>  appear in red/orange, and bulk O atoms with a charge of
about <span class="math notranslate nohighlight">\(-0.9 ~ \text{e}\)</span> appear in blue.</p>
</div>
<p>We can generate histograms of the charges for each atom type using
<code class="docutils literal notranslate"><span class="pre">fix</span> <span class="pre">ave/histo</span></code> commands:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">myhis1</span><span class="w"> </span><span class="nv nv-Identifier">grpSi</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">histo</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">500</span><span class="w"> </span><span class="m">5000</span><span class="w"> </span><span class="o">-</span><span class="m">1.5</span><span class="w"> </span><span class="m">2.5</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">v_vq</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">relax</span><span class="o">-</span><span class="n">Si.histo</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">vector</span>
<span class="k">fix </span><span class="nv nv-Identifier">myhis2</span><span class="w"> </span><span class="nv nv-Identifier">grpO</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">histo</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">500</span><span class="w"> </span><span class="m">5000</span><span class="w"> </span><span class="o">-</span><span class="m">1.5</span><span class="w"> </span><span class="m">2.5</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">v_vq</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">relax</span><span class="o">-</span><span class="n">O.histo</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">vector</span>
</pre></div>
</div>
<p>We can also use the <code class="docutils literal notranslate"><span class="pre">fix</span> <span class="pre">reaxff/species</span></code> to evaluate what species are
present within the simulation.  It will be useful later when the system is deformed,
and bonds are broken:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">myspec</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">reaxff</span><span class="o">/</span><span class="n">species</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="n">relax.species</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span>
</pre></div>
</div>
<p>Here, the information will be printed every 5 steps in a file called <strong>relax.species</strong>.
Let us perform a very short run using the anisotropic NPT command and relax the
density of the system:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">velocity </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">32028</span>
<span class="k">fix </span><span class="nv nv-Identifier">mynpt</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">npt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="n">aniso</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">1000</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.5</span>

<span class="k">run</span><span class="w"> </span><span class="m">5000</span>

<span class="k">write_data </span><span class="nv nv-Identifier">relax.data</span>
</pre></div>
</div>
<p>Run the <strong>relax.lmp</strong> file using LAMMPS.  As seen from <strong>relax.species</strong>,
only one species is detected, called <code class="docutils literal notranslate"><span class="pre">O384Si192</span></code>, representing the entire system.</p>
<p>As the simulation progresses, the charge of every atom fluctuates
because it is adjusting to the local environment of the atom.
It is also observed that the averaged charges for silicon and oxygen
atoms fluctuate significantly at the beginning of the simulation, corresponding
to a rapid change in the system volume, which causes interatomic distances to
shift quickly.  The atoms with the
most extreme charges are located at structural defects,
such as dangling oxygen groups.</p>
<figure class="align-default">
<img alt="Average charge per atom of the silicon" class="only-dark" src="../_images/SIO-charge-dm.png" />
</figure>
<figure class="align-default">
<img alt="Average charge per atom of the silicon" class="only-light" src="../_images/SIO-charge.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: a) Average charge per atom of the silicon, <span class="math notranslate nohighlight">\(q_\text{Si}\)</span>, atoms as
a function of time, <span class="math notranslate nohighlight">\(t\)</span>, during equilibration of the <span class="math notranslate nohighlight">\(\text{SiO}_2\)</span>
system.  b) Volume of the system, <span class="math notranslate nohighlight">\(V\)</span>, as a function of <span class="math notranslate nohighlight">\(t\)</span>.</p>
</div>
<figure class="align-default">
<img alt="Amorphous silica colored by charges using VMD" class="only-light" src="../_images/silicon-light.png" />
</figure>
<figure class="align-default">
<img alt="Amorphous silica colored by charges using VMD" class="only-dark" src="../_images/silicon-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: A slice of the amorphous silica, where atoms are colored by their charges.
Dangling oxygen groups appear in greenish, bulk Si atoms with a charge of about
<span class="math notranslate nohighlight">\(1.8~\text{e}\)</span>  appear in red/orange, and bulk O atoms with a charge of about
<span class="math notranslate nohighlight">\(-0.9~\text{e}\)</span> appear in blue.</p>
</div>
<p>Finally, the generated <strong>.histo</strong> files can be used to
plot the probability distributions, <span class="math notranslate nohighlight">\(P(q)\)</span>.</p>
<figure class="align-default">
<img alt="Average charge per atom of the silicon" class="only-dark" src="../_images/SIO-distribution-dm.png" />
</figure>
<figure class="align-default">
<img alt="Average charge per atom of the silicon" class="only-light" src="../_images/SIO-distribution.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: a) Probability distributions of charge of silicon (positive, blue) and oxygen
(negative, orange) atoms during the equilibration of the <span class="math notranslate nohighlight">\(\text{SiO}_2\)</span>
system.  b) Same probability distributions as in panel (a) after the deformation.</p>
</div>
<section id="deform-the-structure">
<h2>Deform the structure<a class="headerlink" href="#deform-the-structure" title="Link to this heading">¶</a></h2>
<p>Let us apply a deformation to the structure to force some <span class="math notranslate nohighlight">\(\text{Si}-\text{O}\)</span>
bonds to break (and eventually re-assemble).  Open the <strong>deform.lmp</strong>
file, which must contain the following lines:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">units</span><span class="w"> </span><span class="n">real</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">full</span>

<span class="k">read_data</span><span class="w"> </span><span class="n">relax.data</span>

<span class="k">pair_style</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">safezone</span><span class="w"> </span><span class="m">3.0</span><span class="w"> </span><span class="n">mincap</span><span class="w"> </span><span class="m">150</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">reaxCHOFe.inc</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span>
<span class="k">fix </span><span class="nv nv-Identifier">myqeq</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">qeq</span><span class="o">/</span><span class="n">reaxff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">10.0</span><span class="w"> </span><span class="m">1.0e-6</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">maxiter</span><span class="w"> </span><span class="m">400</span>

<span class="k">group </span><span class="nv nv-Identifier">grpSi</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">Si</span>
<span class="k">group </span><span class="nv nv-Identifier">grpO</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">O</span>
<span class="k">variable </span><span class="nv nv-Identifier">qSi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpSi)</span><span class="o">/</span><span class="n">count</span><span class="nv">(grpSi)</span>
<span class="k">variable </span><span class="nv nv-Identifier">qO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpO)</span><span class="o">/</span><span class="n">count</span><span class="nv">(grpO)</span>
<span class="k">variable </span><span class="nv nv-Identifier">vq</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="n">q</span>

<span class="k">thermo</span><span class="w"> </span><span class="m">200</span>
<span class="k">thermo_style</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">etotal</span><span class="w"> </span><span class="n">press</span><span class="w"> </span><span class="n">vol</span><span class="w"> </span><span class="n">v_qSi</span><span class="w"> </span><span class="n">v_qO</span>
<span class="k">dump </span><span class="nv nv-Identifier">viz</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="n">myimage</span><span class="o">-*</span><span class="n">.ppm</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">shiny</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="n">box</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="m">0.01</span><span class="w"> </span><span class="n">view</span><span class="w"> </span><span class="m">180</span><span class="w"> </span><span class="m">90</span><span class="w"> </span><span class="n">zoom</span><span class="w"> </span><span class="m">2.3</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="m">1200</span><span class="w"> </span><span class="m">500</span>
<span class="k">dump_modify </span><span class="nv nv-Identifier">viz</span><span class="w"> </span><span class="n">adiam</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="m">2.6</span><span class="w"> </span><span class="n">adiam</span><span class="w"> </span><span class="n">O</span><span class="w"> </span><span class="m">2.3</span><span class="w"> </span><span class="n">backcolor</span><span class="w"> </span><span class="n">white</span><span class="w"> </span><span class="n">amap</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="n">ca</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="n">royalblue</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">green</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="n">orangered</span>

<span class="k">fix </span><span class="nv nv-Identifier">myhis1</span><span class="w"> </span><span class="nv nv-Identifier">grpSi</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">histo</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">500</span><span class="w"> </span><span class="m">5000</span><span class="w"> </span><span class="o">-</span><span class="m">1.5</span><span class="w"> </span><span class="m">2.5</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">v_vq</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">deform</span><span class="o">-</span><span class="n">Si.histo</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">vector</span>
<span class="k">fix </span><span class="nv nv-Identifier">myhis2</span><span class="w"> </span><span class="nv nv-Identifier">grpO</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">histo</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">500</span><span class="w"> </span><span class="m">5000</span><span class="w"> </span><span class="o">-</span><span class="m">1.5</span><span class="w"> </span><span class="m">2.5</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">v_vq</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">deform</span><span class="o">-</span><span class="n">O.histo</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">vector</span>
<span class="k">fix </span><span class="nv nv-Identifier">myspec</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">reaxff</span><span class="o">/</span><span class="n">species</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="n">deform.species</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span>
</pre></div>
</div>
<p>The only difference with the previous <strong>relax.lmp</strong> file is the path to
the <strong>relax.data</strong> file.</p>
<p>Next, let us use <code class="docutils literal notranslate"><span class="pre">fix</span> <span class="pre">nvt</span></code> instead of <code class="docutils literal notranslate"><span class="pre">fix</span> <span class="pre">npt</span></code> to apply a
Nosé-Hoover thermostat without a barostat:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">mynvt</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nvt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">100</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.5</span>
</pre></div>
</div>
<p>Here, no barostat is used because the change in the box volume will be imposed
by the <code class="docutils literal notranslate"><span class="pre">fix</span> <span class="pre">deform</span></code>.</p>
<p>Let us run for 5000 steps without deformation, then apply the <code class="docutils literal notranslate"><span class="pre">fix</span> <span class="pre">deform</span></code>
to progressively elongate the box along the <span class="math notranslate nohighlight">\(x\)</span>-axis during 25000 steps.  Add
the following line to <strong>deform.lmp</strong>:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">run</span><span class="w"> </span><span class="m">5000</span>

<span class="k">fix </span><span class="nv nv-Identifier">mydef</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">deform</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">erate</span><span class="w"> </span><span class="m">5e-5</span>

<span class="k">run</span><span class="w"> </span><span class="m">25000</span>

<span class="k">write_data </span><span class="nv nv-Identifier">deform.data</span>
</pre></div>
</div>
<p>Run the <strong>deform.lmp</strong> file using LAMMPS.  During the deformation, the charge
values progressively evolve until the structure eventually breaks down.  After the
structure breaks down, the charges equilibrate near new average values that differ
from the initial averages.  The difference
between the initial and the final charges can be explained by the presence of
defects, as well as new solid/vacuum interfaces, and the fact that surface atoms
typically have different charges compared to bulk atoms.
You can also see a sharp increase in temperature during the rupture of
the material.</p>
<figure class="align-default">
<img alt="Evolution of the pressure and distance for the elecrolyte" class="only-dark" src="../_images/deformed-charge-dm.png" />
</figure>
<figure class="align-default">
<img alt="Evolution of the pressure and distance for the elecrolyte" class="only-light" src="../_images/deformed-charge.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: a) Average charge per atom of the silicon, <span class="math notranslate nohighlight">\(q_\text{Si}\)</span>, atoms as
a function of time, <span class="math notranslate nohighlight">\(t\)</span>, during deformation of the <span class="math notranslate nohighlight">\(\text{SiO}_2\)</span> system.
The break down of the
silica structure occurs near <span class="math notranslate nohighlight">\(t = 11\)</span> ps.  b) Temperature, <span class="math notranslate nohighlight">\(T\)</span>, of the
system as a function of <span class="math notranslate nohighlight">\(t\)</span>.</p>
</div>
<p>You can examine the charge distribution after deformation, as well as during
deformation.  As expected, the final
charge distribution slightly differs from the previously calculated one.  If
no new species were formed during the simulation, the <strong>deform.species</strong> file
should look like this:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c">#  Timestep   No_Moles   No_Specs  O384Si192</span>
<span class="w">        </span><span class="m">5</span><span class="w">            </span><span class="m">1</span><span class="w">          </span><span class="m">1</span><span class="w">          </span><span class="m">1</span>
<span class="nv">(...)</span>
<span class="c">#  Timestep   No_Moles   No_Specs  O384Si192</span>
<span class="w">    </span><span class="m">30000</span><span class="w">            </span><span class="m">1</span><span class="w">          </span><span class="m">1</span><span class="w">          </span><span class="m">1</span>
</pre></div>
</div>
<p>Sometimes, <span class="math notranslate nohighlight">\(\text{O}_2\)</span> molecules are formed during the deformation.  If this occurs,
a new column <code class="docutils literal notranslate"><span class="pre">O2</span></code> appears in the <strong>deform.species</strong> file.</p>
</section>
<section id="decorate-the-surface">
<h2>Decorate the surface<a class="headerlink" href="#decorate-the-surface" title="Link to this heading">¶</a></h2>
<p>Under ambient conditions, some of the surface <span class="math notranslate nohighlight">\(\text{SiO}_2\)</span> atoms become chemically
passivated by forming covalent bonds with hydrogen (H) atoms <span id="id3">[<a class="reference internal" href="../non-tutorials/bibliography.html#id15" title="Marialore Sulpizi, Marie-Pierre Gaigeot, and Michiel Sprik. The silica–water interface: how the silanols determine the surface acidity and modulate the water properties. Journal of chemical theory and computation, 8(3):1037–1047, 2012.">42</a>]</span>.
We will add hydrogen atoms randomly to the cracked silica and observe how the
system evolves.  To do so, we first need to modify the previously generated data
file <strong>deform.data</strong> and make space for a third atom type.
Copy <strong>deform.data</strong>, name the copy <strong>deform-mod.data</strong>, and modify the
first lines of <strong>deform-mod.data</strong> as follows:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="m">576</span><span class="w"> </span><span class="n">atoms</span>
<span class="m">3</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="n">types</span>

<span class="nv">(...)</span>

<span class="n">Atom</span><span class="w"> </span><span class="n">Type</span><span class="w"> </span><span class="n">Labels</span>

<span class="m">1</span><span class="w"> </span><span class="n">Si</span>
<span class="m">2</span><span class="w"> </span><span class="n">O</span>
<span class="m">3</span><span class="w"> </span><span class="n">H</span>

<span class="n">Masses</span>

<span class="n">Si</span><span class="w"> </span><span class="m">28.0855</span>
<span class="n">O</span><span class="w"> </span><span class="m">15.999</span>
<span class="n">H</span><span class="w"> </span><span class="m">1.008</span>

<span class="nv">(...)</span>
</pre></div>
</div>
<p>Open the <strong>decorate.lmp</strong> file, which must contain the following lines:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">units</span><span class="w"> </span><span class="n">real</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">full</span>

<span class="k">read_data</span><span class="w"> </span><span class="n">deform</span><span class="o">-</span><span class="n">mod.data</span>
<span class="k">displace_atoms </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="o">-</span><span class="m">12</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="c"># optional</span>

<span class="k">pair_style</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">safezone</span><span class="w"> </span><span class="m">3.0</span><span class="w"> </span><span class="n">mincap</span><span class="w"> </span><span class="m">150</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">reaxCHOFe.inc</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span><span class="w"> </span><span class="n">H</span>
<span class="k">fix </span><span class="nv nv-Identifier">myqeq</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">qeq</span><span class="o">/</span><span class="n">reaxff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">10.0</span><span class="w"> </span><span class="m">1.0e-6</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">maxiter</span><span class="w"> </span><span class="m">400</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">displace_atoms</span></code> command is used to move the center of the
crack near the center of the box.  This step is optional but makes for a nicer
visualization.  A different value for the shift may be needed in
your case, depending on the location of the crack.  A difference with the previous
input is that three atom types are specified in the <code class="docutils literal notranslate"><span class="pre">pair_coeff</span></code> command, i.e.
<code class="docutils literal notranslate"><span class="pre">Si</span> <span class="pre">O</span> <span class="pre">H</span></code>.</p>
<p>Then, let us adapt some familiar commands to measure the charges of all three
types of atoms, and output the charge values into log files:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">group </span><span class="nv nv-Identifier">grpSi</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">Si</span>
<span class="k">group </span><span class="nv nv-Identifier">grpO</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">O</span>
<span class="k">group </span><span class="nv nv-Identifier">grpH</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">H</span>
<span class="k">variable </span><span class="nv nv-Identifier">qSi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpSi)</span><span class="o">/</span><span class="n">count</span><span class="nv">(grpSi)</span>
<span class="k">variable </span><span class="nv nv-Identifier">qO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpO)</span><span class="o">/</span><span class="n">count</span><span class="nv">(grpO)</span>
<span class="k">variable </span><span class="nv nv-Identifier">qH</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpH)</span><span class="o">/</span><span class="nv">(count(grpH)+1e-10)</span>

<span class="k">thermo</span><span class="w"> </span><span class="m">5</span>
<span class="k">thermo_style</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">etotal</span><span class="w"> </span><span class="n">press</span><span class="w"> </span><span class="n">v_qSi</span><span class="w"> </span><span class="n">v_qO</span><span class="w"> </span><span class="n">v_qH</span>

<span class="k">dump </span><span class="nv nv-Identifier">viz</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">image</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="n">myimage</span><span class="o">-*</span><span class="n">.ppm</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">shiny</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="n">box</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="m">0.01</span><span class="w"> </span><span class="n">view</span><span class="w"> </span><span class="m">180</span><span class="w"> </span><span class="m">90</span><span class="w"> </span><span class="n">zoom</span><span class="w"> </span><span class="m">2.3</span><span class="w"> </span><span class="n">size</span><span class="w"> </span><span class="m">1200</span><span class="w"> </span><span class="m">500</span>
<span class="k">dump_modify </span><span class="nv nv-Identifier">viz</span><span class="w"> </span><span class="n">adiam</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="m">2.6</span><span class="w"> </span><span class="n">adiam</span><span class="w"> </span><span class="n">O</span><span class="w"> </span><span class="m">2.3</span><span class="w"> </span><span class="n">adiam</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="n">backcolor</span><span class="w"> </span><span class="n">white</span><span class="w"> </span><span class="n">amap</span><span class="w"> </span><span class="o">-</span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="n">ca</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">min</span><span class="w"> </span><span class="n">royalblue</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">green</span><span class="w"> </span><span class="n">max</span><span class="w"> </span><span class="n">orangered</span>

<span class="k">fix </span><span class="nv nv-Identifier">myspec</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">reaxff</span><span class="o">/</span><span class="n">species</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="n">decorate.species</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span><span class="w"> </span><span class="n">H</span>
</pre></div>
</div>
<p>Here, the <span class="math notranslate nohighlight">\(+1 \mathrm{e}{-10}\)</span> was added to the denominator of the <code class="docutils literal notranslate"><span class="pre">variable</span> <span class="pre">qH</span></code>
to avoid dividing by 0 at the beginning of the simulation.  Finally, let us
create a loop with 10 steps, and create two hydrogen atoms at random locations at
every step:</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">mynvt</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nvt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">100</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.5</span>

<span class="k">label </span><span class="sc">loop</span>
<span class="k">variable </span><span class="nv nv-Identifier">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="m">10</span>

<span class="k">variable </span><span class="nv nv-Identifier">seed</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="m">35672</span><span class="o">+</span><span class="nv">${a}</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="nv">${seed}</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">overlap</span><span class="w"> </span><span class="m">2.6</span><span class="w"> </span><span class="n">maxtry</span><span class="w"> </span><span class="m">50</span>

<span class="k">run</span><span class="w"> </span><span class="m">2000</span>

<span class="k">next </span><span class="nv nv-Identifier">a</span>
<span class="k">jump </span><span class="sc">SELF</span><span class="w"> </span><span class="n">loop</span>
</pre></div>
</div>
<p>Run the simulation with LAMMPS.  When the simulation is over,
it can be seen from the <strong>decorate.species</strong> file that
all the created hydrogen atoms reacted with the <span class="math notranslate nohighlight">\(\text{SiO}_{2}\)</span> structure to
form surface groups (such as hydroxyl (-OH) groups).</p>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="nv">(...)</span>
<span class="c"># Timestep   No_Moles No_Specs H20O384Si192</span>
<span class="m">20000</span><span class="w">      </span><span class="m">1</span><span class="w">        </span><span class="m">1</span><span class="w">        </span><span class="m">1</span>
</pre></div>
</div>
<p>At the end of the simulation, hydroxyl (-OH) groups can be seen at the interfaces.</p>
<figure class="align-default">
<img alt="Cracked silicon oxide after the addition of hydrogen atoms simulated using LAMMPS molecular dynamics" class="only-dark" src="../_images/decorated-dark.png" />
</figure>
<figure class="align-default">
<img alt="Cracked silicon oxide after the addition of hydrogen atoms simulated using LAMMPS molecular dynamics" class="only-light" src="../_images/decorated-light.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Cracked silicon oxide after the addition of hydrogen atoms.
The atoms are colored by their charges, with the newly added hydrogen atoms appearing as small
greenish spheres.</p>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Prepare and relax</a><ul>
<li><a class="reference internal" href="#deform-the-structure">Deform the structure</a></li>
<li><a class="reference internal" href="#decorate-the-surface">Decorate the surface</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>