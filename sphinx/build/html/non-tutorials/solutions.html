<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-W1WGEC5GQ8"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-W1WGEC5GQ8');
    </script>
        <link href="../_static/favicon-32x32.png" sizes="32x32" rel="icon" type="image/png"><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="VMD tutorial" href="../tutorials/vmd/vmd-tutorial.html" /><link rel="prev" title="Free energy calculation" href="../tutorials/level3/free-energy-calculation.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Solutions to the exercises - </title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=3ceca25e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">    </div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">    </span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="before-you-start.html">Before you start</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact-me.html">Contact me</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/level1/lennard-jones-fluid.html">Lennard-Jones fluid</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/level1/breaking-a-carbon-nanotube.html">Pulling on a carbon nanotube</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/level2/polymer-in-water.html">Polymer in water</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/level2/nanosheared-electrolyte.html">Nanosheared electrolyte</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 3</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/level3/reactive-silicon-dioxide.html">Reactive silicon dioxide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/level3/water-adsorption-in-silica.html">Water adsorption in silica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/level3/free-energy-calculation.html">Free energy calculation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extra content</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Solutions to the exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/vmd/vmd-tutorial.html">VMD tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../miscellaneous/use-gromacs-instead.html">Use GROMACS instead</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="solutions-to-the-exercises">
<span id="solutions-label"></span><h1>Solutions to the exercises<a class="headerlink" href="#solutions-to-the-exercises" title="Link to this heading">#</a></h1>
<section id="lennard-jones-fluid">
<h2>Lennard Jones fluid<a class="headerlink" href="#lennard-jones-fluid" title="Link to this heading">#</a></h2>
<section id="fix-a-broken-input">
<h3>Fix a broken input<a class="headerlink" href="#fix-a-broken-input" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>You can download the working <a href="../../../../inputs/level1/lennard-jones-fluid/exercises/broken/input.lammps" target="_blank">input</a> I wrote.</p>
</div>
<div class="justify docutils container">
<p>The trick to make the simulation starts without error
is to reduce the initial <em>timestep</em> value as well as
the imposed <em>temperature</em>.</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">mylgv</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">langevin</span><span class="w"> </span><span class="m">0.001</span><span class="w"> </span><span class="m">0.001</span><span class="w"> </span><span class="m">0.001</span><span class="w"> </span><span class="m">1530917</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.0001</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Note that in order to make sure that the temperature of the particles
quickly reaches a reasonable value, the <em>damping</em> parameter
of the <em>fix Langevin</em> was also reduced.</p>
</div>
<div class="justify docutils container">
<p>With these commands, you should see that after the first
<em>run</em> finishes, the energy of the system
has reduced. Thus, a second <em>run</em>
with the original <em>timestep</em> and <em>Langevin</em> parameters
can start without issue.</p>
</div>
<div class="justify docutils container">
<p>In some cases, more than two consecutive <em>run</em> can
be the solution:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">mylgv</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">langevin</span><span class="w"> </span><span class="m">0.0001</span><span class="w"> </span><span class="m">0.0001</span><span class="w"> </span><span class="m">0.001</span><span class="w"> </span><span class="m">1530917</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.0001</span>
<span class="k">run</span><span class="w"> </span><span class="m">10000</span>

<span class="k">timestep</span><span class="w"> </span><span class="m">0.001</span>
<span class="k">run</span><span class="w"> </span><span class="m">10000</span>

<span class="k">timestep</span><span class="w"> </span><span class="m">0.01</span>
<span class="k">run</span><span class="w"> </span><span class="m">10000</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Use trial and error to determine the best approach for
a given system.</p>
</div>
</section>
<section id="create-a-demixed-dense-phase">
<h3>Create a demixed dense phase<a class="headerlink" href="#create-a-demixed-dense-phase" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>You can download the <a href="../../../../inputs/level1/lennard-jones-fluid/exercises/demixion/input.lammps" target="_blank">input</a> I wrote. Note that
I use a large number of particles: 8000 for each type. Then,
the key to create a demixing phase is to play with the Lennard-Jones
parameters:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">pair_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5.0</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5.0</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0.05</span><span class="w"> </span><span class="m">1.0</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>First, notice that both particle types have the same <span class="math notranslate nohighlight">\(\sigma\)</span> value of 1.0
so that both particles have the same diameter. Second, note the large energy parameter <span class="math notranslate nohighlight">\(\epsilon = 5.0\)</span>
for self interaction (i.e.) interaction between particles of same type, and the low
energy parameter <span class="math notranslate nohighlight">\(\epsilon = 0.05\)</span> for interaction between particles of different types.</p>
</div>
<div class="justify docutils container">
<p>Finally, for adjusting the box volume and create a liquid looking phase, the
pressure was imposed by replacing <em>fix nve</em> by <em>fix nph</em>:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">mynph</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nph</span><span class="w"> </span><span class="n">iso</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">1.0</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>With <em>fix nph</em> and a pressure of 1, LAMMPS adjusts the box dimension until the
pressure is close to 1, which is require reducing the initial box dimensions.</p>
</div>
</section>
<section id="create-dumbbell-molecules">
<h3>Create dumbbell molecules<a class="headerlink" href="#create-dumbbell-molecules" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>You can download the <a href="../../../../inputs/level1/lennard-jones-fluid/exercises/dumbbell/input.lammps" target="_blank">input</a> I wrote. The first important
change is to choose an <em>atom_style</em> that allows for bond creation, and
to specify the <em>bond_style</em>:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">atom_style</span><span class="w"> </span><span class="n">molecular</span>
<span class="k">bond_style</span><span class="w"> </span><span class="n">harmonic</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>When creating the box, it is important to make space in the memory for
the bonds:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">create_box </span><span class="nv nv-Identifier">2</span><span class="w"> </span><span class="nv nv-Identifier">simulation_box</span><span class="w"> </span><span class="n">bond</span><span class="o">/</span><span class="n">types</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="n">extra</span><span class="o">/</span><span class="n">bond</span><span class="o">/</span><span class="n">per</span><span class="o">/</span><span class="n">atom</span><span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Then, import the <em>molecule templates</em>, and use these templates
when creating the atoms:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">molecule</span><span class="w"> </span><span class="n">dumbell1</span><span class="w"> </span><span class="n">dumbell1.mol</span>
<span class="k">molecule</span><span class="w"> </span><span class="n">dumbell2</span><span class="w"> </span><span class="n">dumbell2.mol</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">750</span><span class="w"> </span><span class="m">341341</span><span class="w"> </span><span class="n">simulation_box</span><span class="w"> </span><span class="n">mol</span><span class="w"> </span><span class="n">dumbell1</span><span class="w"> </span><span class="m">8766</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">678865</span><span class="w"> </span><span class="n">simulation_box</span><span class="w"> </span><span class="n">mol</span><span class="w"> </span><span class="n">dumbell2</span><span class="w"> </span><span class="m">8751</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>You can download the molecule templates for <a href="../../../../inputs/level1/lennard-jones-fluid/exercises/dumbbell/dumbell1.mol" target="_blank">type-1</a>
and <a href="../../../../inputs/level1/lennard-jones-fluid/exercises/dumbbell/dumbell2.mol" target="_blank">type-2</a>. Finally, some parameters for the two
types of bonds, namely their rigidity and equilibrium lengths is specified:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">bond_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">0.5</span>
<span class="k">bond_coeff</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1.5</span>
</pre></div>
</div>
</section>
</section>
<section id="pulling-on-a-carbon-nanotube">
<h2>Pulling on a carbon nanotube<a class="headerlink" href="#pulling-on-a-carbon-nanotube" title="Link to this heading">#</a></h2>
<section id="plot-the-strain-stress-curves">
<h3>Plot the strain-stress curves<a class="headerlink" href="#plot-the-strain-stress-curves" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>You can download the <a href="../../../../inputs/level1/breaking-a-carbon-nanotube/exercises/stress-strain/breakable-bonds/input.lammps" target="_blank">input</a>
and <a href="../../../../inputs/level1/breaking-a-carbon-nanotube/exercises/stress-strain/unbreakable-bonds/input.lammps" target="_blank">input</a> I wrote.</p>
</div>
<div class="justify docutils container">
<p>The main difficulty here is to calculate the stress. Here,
the stress is calculated as the force divided by the
surface area of the CNT. Note that the surface area
of a CNT is not a well defined quantity. I choose to
define the area as the perimeter of the CNT multiplied by the
effective width of the carbon atoms.</p>
</div>
<div class="justify docutils container">
<p>Be careful with units, as the force is either in kCal/mol
or eV, depending of the unit system, respectively <em>real</em> or <em>metal</em>.</p>
</div>
</section>
<section id="deform-a-cnt-membrane">
<h3>Deform a CNT membrane<a class="headerlink" href="#deform-a-cnt-membrane" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>You can download the <a href="../../../../inputs/level1/breaking-a-carbon-nanotube/exercises/membrane/input.lammps" target="_blank">input</a> I wrote.
The CNT can be replicated using the <em>replicate</em> command.
Then, it is important to change the box to triclinic:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">change_box </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">triclinic</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Before deforming the system using:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">muyef</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">deform</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">xy</span><span class="w"> </span><span class="n">erate</span><span class="w"> </span><span class="m">5e-5</span>
</pre></div>
</div>
</section>
</section>
<section id="polymer-in-water">
<h2>Polymer in water<a class="headerlink" href="#polymer-in-water" title="Link to this heading">#</a></h2>
<section id="extract-radial-distribution-function">
<h3>Extract radial distribution function<a class="headerlink" href="#extract-radial-distribution-function" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>You can download the <a href="../../../../inputs/level2/polymer-in-water/exercises/radial-distribution-function/input.lammps" target="_blank">input</a> file I wrote. I use
the <em>compute rdf</em> command of LAMMPS. I define two different <em>compute</em>,
one for the H2O-H2O RDF, and another one for the H2O-PEG RDF:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># H2O (type 1) - H2O (type 1)</span>
<span class="k">compute </span><span class="nv nv-Identifier">myRDF_H2O_H2O</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">rdf</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="m">10</span>
<span class="k">fix </span><span class="nv nv-Identifier">myat1</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">time</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20000</span><span class="w"> </span><span class="m">200000</span><span class="w"> </span><span class="n">c_myRDF_H2O_H2O[</span><span class="o">*</span><span class="n">]</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">H2O</span><span class="o">-</span><span class="n">H2O.dat</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">vector</span>

<span class="c"># PEG (type 3, 4, and 6) - H2O (type 1)</span>
<span class="k">compute </span><span class="nv nv-Identifier">myRDF_PEG_H2O</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">rdf</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="m">10</span>
<span class="k">fix </span><span class="nv nv-Identifier">myat2</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">time</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20000</span><span class="w"> </span><span class="m">200000</span><span class="w"> </span><span class="n">c_myRDF_PEG_H2O[</span><span class="o">*</span><span class="n">]</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">PEG</span><span class="o">-</span><span class="n">H2O.dat</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">vector</span>
</pre></div>
</div>
</section>
<section id="add-salt-to-the-mixture">
<h3>Add salt to the mixture<a class="headerlink" href="#add-salt-to-the-mixture" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>You can download the <a href="../../../../inputs/level2/polymer-in-water/exercises/salt/input.lammps" target="_blank">input</a>,
<a href="../../../../inputs/level2/polymer-in-water/exercises/salt/mix-with-salt.data" target="_blank">data</a>,
and <a href="../../../../inputs/level2/polymer-in-water/exercises/salt/PARM-with-salt.lammps" target="_blank">parm</a> files I wrote. It is important to
make space for the salt by modifying the data file as follow:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="nv">(...)</span>
<span class="m">9</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="n">types</span>
<span class="nv">(...)</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Additional <em>mass</em> and <em>pair_coeff</em> lines
must be added to the parm file (be careful to use the
appropriate units):</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="nv">(...)</span>
<span class="k">mass</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">22.98</span><span class="w"> </span><span class="c"># Na</span>
<span class="k">mass</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="m">35.453</span><span class="w"> </span><span class="c"># Cl</span>
<span class="nv">(...)</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">0.04690</span><span class="w"> </span><span class="m">2.43</span><span class="w"> </span><span class="c"># Na</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="m">0.1500</span><span class="w"> </span><span class="m">4.045</span>
<span class="nv">(...)</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Finally, here I choose to add the ions using two separate
<em>create_atoms</em> commands with a very small <em>overlap</em>
values, followed by an energy minimization.</p>
</div>
</section>
</section>
<section id="nanosheared-electrolyte">
<h2>Nanosheared electrolyte<a class="headerlink" href="#nanosheared-electrolyte" title="Link to this heading">#</a></h2>
<section id="make-a-hydrophobic-nanopore">
<h3>Make a hydrophobic nanopore<a class="headerlink" href="#make-a-hydrophobic-nanopore" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>By default, the walls are very hydrophilic due to the
<em>pair_coeff</em> that are in use:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">pair_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.185199</span><span class="w"> </span><span class="m">3.1589</span><span class="w"> </span><span class="c"># water</span>
<span class="nv">(...)</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">11.697</span><span class="w"> </span><span class="m">2.574</span><span class="w"> </span><span class="c"># wall</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>LAMMPS calculate the cross-coefficient between water and wall
using geometric average, so
<span class="math notranslate nohighlight">\(\epsilon_\text{1-5} = (0.185199+11.697)/2 = 5.941\,\text{kcal/mol}\)</span> and
<span class="math notranslate nohighlight">\(\sigma_\text{1-5} = (3.1589+2.574)/2 = 2.866\,\text{Å}\)</span>.</p>
</div>
<div class="justify docutils container">
<p>The value <span class="math notranslate nohighlight">\(\epsilon_\text{1-5} = 5.941\,\text{kcal/mol}\)</span> is extremely high
(compare to the water-water energy <span class="math notranslate nohighlight">\(\epsilon_\text{1-1} = 0.185199\,\text{kcal/mol}\)</span>),
which is the reason for the extremely hydrophilic surfaces.</p>
</div>
<div class="justify docutils container">
<p>The walls can be made more hydrophobic by reducing the
LJ energy of interaction <span class="math notranslate nohighlight">\(\epsilon_\text{1-5}\)</span>.
This can be done by writing a new line for the <em>pair_coeff</em> between
atoms of type 1 (water oxygen) and wall (type 5):</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">pair_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">0.0059411</span><span class="w"> </span><span class="m">2.86645</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Here I choose to reduce <span class="math notranslate nohighlight">\(\epsilon_\text{1-5}\)</span> by a factor of 1000,
which makes it lower than the water-water energy <span class="math notranslate nohighlight">\(\epsilon_\text{1-1}\)</span>,
thus making the walls more hydrophobic.</p>
</div>
<figure class="align-default">
<img alt="hydrophobic vs hydrophilic pores : density profiles" class="only-light" src="../_images/hydrophobic-pore-light.png" />
</figure>
<figure class="align-default">
<img alt="hydrophobic vs hydrophilic pores : density profiles" class="only-dark" src="../_images/hydrophobic-pore-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Density profile for the water along the <em>z</em> axis
comparing the original hydrophilic pore with the hydrophobic pore
with <span class="math notranslate nohighlight">\(\epsilon_\text{1-5} = 0.005941\,\text{kcal/mol}\)</span>.</p>
</div>
</section>
<section id="induce-a-poiseuille-flow">
<h3>Induce a Poiseuille flow<a class="headerlink" href="#induce-a-poiseuille-flow" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>Here the <em>input</em> script written during the last part <em>Imposed shearing</em> of the
tutorial is adapted so that, instead of a shearing induced by the relative motion of the walls,
the fluid motion is generated by an additional force applied to both water molecules and ions.</p>
</div>
<div class="justify docutils container">
<p>To do so, here are the most important commands used to properly
thermalize the system:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">mynve</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nve</span>
<span class="k">compute </span><span class="nv nv-Identifier">tliq</span><span class="w"> </span><span class="nv nv-Identifier">fluid</span><span class="w"> </span><span class="n">temp</span><span class="o">/</span><span class="n">partial</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span>
<span class="k">fix </span><span class="nv nv-Identifier">myber1</span><span class="w"> </span><span class="nv nv-Identifier">fluid</span><span class="w"> </span><span class="n">temp</span><span class="o">/</span><span class="n">berendsen</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">100</span>
<span class="k">fix_modify </span><span class="nv nv-Identifier">myber1</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">tliq</span>
<span class="k">compute </span><span class="nv nv-Identifier">twall</span><span class="w"> </span><span class="nv nv-Identifier">wall</span><span class="w"> </span><span class="n">temp</span>
<span class="k">fix </span><span class="nv nv-Identifier">myber2</span><span class="w"> </span><span class="nv nv-Identifier">wall</span><span class="w"> </span><span class="n">temp</span><span class="o">/</span><span class="n">berendsen</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">100</span>
<span class="k">fix_modify </span><span class="nv nv-Identifier">myber2</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">twall</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Here, since walls wont move, they can be thermalized in all
3 directions and there is
no need for recentering. Instead, one can keep the walls
in place by adding springs to every atom:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">myspring</span><span class="w"> </span><span class="nv nv-Identifier">wall</span><span class="w"> </span><span class="n">spring</span><span class="o">/</span><span class="n">self</span><span class="w"> </span><span class="m">10.0</span><span class="w"> </span><span class="n">xyz</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Finally, let us apply a force to the fluid group along the <span class="math notranslate nohighlight">\(x\)</span>
direction:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">myadf</span><span class="w"> </span><span class="nv nv-Identifier">fluid</span><span class="w"> </span><span class="n">addforce</span><span class="w"> </span><span class="m">3e-2</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">0.0</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>The choice of a force equal to <span class="math notranslate nohighlight">\(f = 0.03\,\text{kcal/mol/Å}\)</span>
is discussed below.</p>
</div>
<div class="justify docutils container">
<p>One can have a look at the velocity profiles. The fluid shows the characteristic
parabolic shape of Poiseuille flow in the case of a non-slip solid surface.
To obtain smooth looking data, I ran the simulation for a total duration of <span class="math notranslate nohighlight">\(1\,\text{ns}\)</span>.
To lower the duration of the computation, don’t hesitate to
use a shorter duration like <span class="math notranslate nohighlight">\(100\,\text{ps}\)</span>.</p>
</div>
<figure class="align-default">
<img alt="Velocity of the fluid forming a Poiseuille flow" class="only-light" src="../_images/shearing-poiseuille-light.png" />
</figure>
<figure class="align-default">
<img alt="Velocity of the fluid forming a Poiseuille flow" class="only-dark" src="../_images/shearing-poiseuille-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Velocity profiles of the water molecules along the <em>z</em> axis (disks).
The line is the Poiseuille equation.</p>
</div>
<div class="justify docutils container">
<p>The fitting of the velocity profile was made using the following Poiseuille equation,</p>
</div>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[v = - \alpha \dfrac{f \rho}{\eta} \left( \dfrac{z^2}{2} - \dfrac{h^2}{8} \right),\]</div>
</div>
<div class="justify docutils container">
<p>which can be derived from the Stokes equation <span class="math notranslate nohighlight">\(\eta \nabla \textbf{v} = - \textbf{f} \rho\)</span>
where <span class="math notranslate nohighlight">\(f\)</span> is the applied force,
<span class="math notranslate nohighlight">\(\rho\)</span> is the fluid density,
<span class="math notranslate nohighlight">\(\eta\)</span> is the fluid viscosity, and
<span class="math notranslate nohighlight">\(h = 1.2\,\text{nm}\)</span> is the pore size.
A small correction <span class="math notranslate nohighlight">\(\alpha = 0.78\)</span> was used. This correction
compensates the fact that using bulk density and bulk viscosity is obviously
no correct in such nanoconfined pore. More subtle corrections could be applied
by correcting both density and viscosity based on independent measurement, but this is
beyond the scope of the present exercise.</p>
</div>
<div class="justify docutils container">
<p><strong>Choosing the right force</strong></p>
</div>
<div class="justify docutils container">
<p>The first and most important technical difficulty of any
out-of-equilibrium simulation is to choose the value of the forcing <span class="math notranslate nohighlight">\(f\)</span>.
If the forcing is too large, the system may not be in a linear response regime,
meaning that the results are forcing-dependent (and likely quite meaningless). If
the forcing is too small, the motion of the system will be difficult to measure
due to the low signal-to-noise ratio.</p>
</div>
<div class="justify docutils container">
<p>In the present case, one can perform a calibration by running several simulations
with different force values <span class="math notranslate nohighlight">\(f\)</span>, and then by plotting the velocity of
the center of mass <span class="math notranslate nohighlight">\(v_\text{cm}\)</span> of the fluid as a function of the force.
Here, I present the results I have obtained by performing the simulations with
different values of the forcing. <span class="math notranslate nohighlight">\(v_\text{cm}\)</span> can be extracted by adding the following command
to the <em>input</em>:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">variable </span><span class="nv nv-Identifier">vcm_fluid</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">vcm</span><span class="nv">(fluid,x)</span>
<span class="k">fix </span><span class="nv nv-Identifier">myat1</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">time</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">1000</span><span class="w"> </span><span class="n">v_vcm_fluid</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">vcm_fluid.dat</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>The results  show that as long as the force is lower
than about <span class="math notranslate nohighlight">\(0.04\,\text{kcal/mol/Å}\)</span>, there is reasonable linearity
between force and fluid velocity.</p>
</div>
<figure class="align-default">
<img alt="Velocity of the fluid under imposed force (POISEUILLE FLOW)" class="only-light" src="../_images/calibration-force-light.png" />
</figure>
<figure class="align-default">
<img alt="Velocity of the fluid under imposed force (POISEUILLE FLOW)" class="only-dark" src="../_images/calibration-force-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Ratio between the velocity of the center of mass <span class="math notranslate nohighlight">\(v_\text{cm}\)</span> of the fluid
and the forcing <span class="math notranslate nohighlight">\(f\)</span> as a function of the forcing</p>
</div>
</section>
</section>
<section id="water-adsorption-in-silica">
<h2>Water adsorption in silica<a class="headerlink" href="#water-adsorption-in-silica" title="Link to this heading">#</a></h2>
<section id="mixture-adsorption">
<h3>Mixture adsorption<a class="headerlink" href="#mixture-adsorption" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>You can download the <a href="../../../../inputs/level3/water-adsorption-in-silica/Exercises/MixtureH2OCO2/input.lammps" target="_blank">input</a> for the combine water and CO2
adsorption.
One of the first step is to create both type of molecules
before starting the GCMC:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">molecule</span><span class="w"> </span><span class="n">h2omol</span><span class="w"> </span><span class="n">H2O.mol</span>
<span class="k">molecule</span><span class="w"> </span><span class="n">co2mol</span><span class="w"> </span><span class="n">CO2.mol</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">456415</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">mol</span><span class="w"> </span><span class="n">h2omol</span><span class="w"> </span><span class="m">454756</span><span class="w"> </span><span class="n">overlap</span><span class="w"> </span><span class="m">2.0</span><span class="w"> </span><span class="n">maxtry</span><span class="w"> </span><span class="m">50</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">373823</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">mol</span><span class="w"> </span><span class="n">co2mol</span><span class="w"> </span><span class="m">989812</span><span class="w"> </span><span class="n">overlap</span><span class="w"> </span><span class="m">2.0</span><span class="w"> </span><span class="n">maxtry</span><span class="w"> </span><span class="m">50</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>One must be careful to properly write the parameters of the system,
with all the proper cross coefficients:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">vashishta</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">..</span><span class="o">/</span><span class="n">Potential</span><span class="o">/</span><span class="n">SiO.1990.vashishta</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">NULL</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">0.0057</span><span class="w"> </span><span class="m">4.42</span><span class="w"> </span><span class="c"># epsilonSi = 0.00403, sigmaSi = 3.69</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">0.01096</span><span class="w"> </span><span class="m">3.158</span><span class="w"> </span><span class="c"># epsilonSi = 0.00403, sigmaSi = 3.69</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">0.007315</span><span class="w"> </span><span class="m">3.2507</span><span class="w"> </span><span class="c"># epsilonSi = 0.00403, sigmaSi = 3.69</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">0.0043</span><span class="w"> </span><span class="m">3.12</span><span class="w"> </span><span class="c"># epsilonO = 0.0023, sigmaO = 3.091</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">0.0101</span><span class="w"> </span><span class="m">2.858</span><span class="w"> </span><span class="c"># epsilonO = 0.0023, sigmaO = 3.091</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">0.0065</span><span class="w"> </span><span class="m">2.9512</span><span class="w"> </span><span class="c"># epsilonO = 0.0023, sigmaO = 3.091</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">0.008</span><span class="w"> </span><span class="m">3.1589</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">0.01295</span><span class="w"> </span><span class="m">2.8924</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">0.0093</span><span class="w"> </span><span class="m">2.985</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">0.0</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">0.0179</span><span class="w"> </span><span class="m">2.625854</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="n">lj</span><span class="o">/</span><span class="n">cut</span><span class="o">/</span><span class="n">tip4p</span><span class="o">/</span><span class="n">long</span><span class="w"> </span><span class="m">0.0106</span><span class="w"> </span><span class="m">2.8114421</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Here, I choose to thermalize all species separately:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">compute </span><span class="nv nv-Identifier">ctH2O</span><span class="w"> </span><span class="nv nv-Identifier">H2O</span><span class="w"> </span><span class="n">temp</span>
<span class="k">compute_modify </span><span class="nv nv-Identifier">ctH2O</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">yes</span>
<span class="k">fix </span><span class="nv nv-Identifier">mynvt1</span><span class="w"> </span><span class="nv nv-Identifier">H2O</span><span class="w"> </span><span class="n">nvt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">0.1</span>
<span class="k">fix_modify </span><span class="nv nv-Identifier">mynvt1</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">ctH2O</span>

<span class="k">compute </span><span class="nv nv-Identifier">ctCO2</span><span class="w"> </span><span class="nv nv-Identifier">CO2</span><span class="w"> </span><span class="n">temp</span>
<span class="k">compute_modify </span><span class="nv nv-Identifier">ctCO2</span><span class="w"> </span><span class="n">dynamic</span><span class="w"> </span><span class="n">yes</span>
<span class="k">fix </span><span class="nv nv-Identifier">mynvt2</span><span class="w"> </span><span class="nv nv-Identifier">CO2</span><span class="w"> </span><span class="n">nvt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">0.1</span>
<span class="k">fix_modify </span><span class="nv nv-Identifier">mynvt2</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">ctCO2</span>

<span class="k">compute </span><span class="nv nv-Identifier">ctSiO</span><span class="w"> </span><span class="nv nv-Identifier">SiO</span><span class="w"> </span><span class="n">temp</span>
<span class="k">fix </span><span class="nv nv-Identifier">mynvt3</span><span class="w"> </span><span class="nv nv-Identifier">SiO</span><span class="w"> </span><span class="n">nvt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">0.1</span>
<span class="k">fix_modify </span><span class="nv nv-Identifier">mynvt3</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">ctSiO</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Finally, adsorption is made with two separates <em>fix gcmc</em> commands
placed in a loop:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">label </span><span class="sc">loop</span>
<span class="k">variable </span><span class="nv nv-Identifier">a</span><span class="w"> </span><span class="n">loop</span><span class="w"> </span><span class="m">30</span>

<span class="k">fix </span><span class="nv nv-Identifier">fgcmc_H2O</span><span class="w"> </span><span class="nv nv-Identifier">H2O</span><span class="w"> </span><span class="n">gcmc</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">65899</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="o">-</span><span class="m">0.5</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="n">mol</span><span class="w"> </span><span class="n">h2omol</span><span class="w"> </span><span class="n">tfac_insert</span><span class="w"> </span><span class="nv">${tfac}</span><span class="w"> </span><span class="k">group </span><span class="nv nv-Identifier">H2O</span><span class="w"> </span><span class="n">shake</span><span class="w"> </span><span class="n">shak</span><span class="w"> </span><span class="n">full_energy</span><span class="w"> </span><span class="n">pressure</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="k">region </span><span class="nv nv-Identifier">system</span>
<span class="k">run</span><span class="w"> </span><span class="m">500</span>
<span class="k">unfix </span><span class="nv nv-Identifier">fgcmc_H2O</span>

<span class="k">fix </span><span class="nv nv-Identifier">fgcmc_CO2</span><span class="w"> </span><span class="nv nv-Identifier">CO2</span><span class="w"> </span><span class="n">gcmc</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">87787</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="o">-</span><span class="m">0.5</span><span class="w"> </span><span class="m">0.1</span><span class="w"> </span><span class="n">mol</span><span class="w"> </span><span class="n">co2mol</span><span class="w"> </span><span class="n">tfac_insert</span><span class="w"> </span><span class="nv">${tfac}</span><span class="w"> </span><span class="k">group </span><span class="nv nv-Identifier">CO2</span><span class="w"> </span><span class="n">full_energy</span><span class="w"> </span><span class="n">pressure</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="k">region </span><span class="nv nv-Identifier">system</span>
<span class="k">run</span><span class="w"> </span><span class="m">500</span>
<span class="k">unfix </span><span class="nv nv-Identifier">fgcmc_CO2</span>

<span class="k">next </span><span class="nv nv-Identifier">a</span>
<span class="k">jump </span><span class="sc">SELF</span><span class="w"> </span><span class="n">loop</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Here I choose to apply the first <em>fix gcmc</em> for the <span class="math notranslate nohighlight">\(\text{H}_2\text{O}\)</span> for 500 steps,
then unfix it before starting the second <em>fix gcmc</em> for the <span class="math notranslate nohighlight">\(\text{CO}_2\)</span> for 500 steps as well.
Then, thanks to the <em>jump</em>, these two fixes are applied successively 30 times each, allowing for the
progressive adsorption of both species.</p>
</div>
</section>
<section id="adsorb-water-in-zif-8-nanopores">
<h3>Adsorb water in ZIF-8 nanopores<a class="headerlink" href="#adsorb-water-in-zif-8-nanopores" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>You can download the <a href="../../../../inputs/level3/water-adsorption-in-silica/Exercises/Zif-8/input.lammps" target="_blank">input</a> for the water adsorption in Zif-8,
which you have to place in the same folder as the <em>zif-8.data</em>,
<em>parm.lammps</em>,
and <em>water.mol</em> files.</p>
</div>
<div class="justify docutils container">
<p>Apart from the parameters and topology, the <em>input</em> is
quite similar to the one developped in the case of the crack
silica.</p>
</div>
<div class="justify docutils container">
<p>You should observe an increase of the number of molecule with time.
Run much longer simulation if you want to saturate the porous material
with water.</p>
</div>
<figure class="align-default">
<img alt="Water molecule in Zif material with GCMC in LAMMPS" class="only-light" src="../_images/number_evolution_zif-light.png" />
</figure>
<figure class="align-default">
<img alt="Water molecule in Zif material with GCMC in LAMMPS" class="only-dark" src="../_images/number_evolution_zif-dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Number of water molecule in Zif-8 during the first <span class="math notranslate nohighlight">\(10\,ps\)</span>.</p>
</div>
</section>
</section>
<section id="free-energy-calculation">
<h2>Free energy calculation<a class="headerlink" href="#free-energy-calculation" title="Link to this heading">#</a></h2>
<section id="the-binary-fluid-that-wont-mix">
<h3>The binary fluid that wont mix<a class="headerlink" href="#the-binary-fluid-that-wont-mix" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>You can download the <a href="../../../../inputs/level3/free-energy-calculation/Exercises/BinaryFluid/input.lammps" target="_blank">input</a> here.</p>
</div>
<div class="justify docutils container">
<p>The solution chosen here was to create two groups (<em>t1</em> and <em>t2</em>)
and apply the two potentials <em>U1</em> and <em>U2</em> to each group, respectively.</p>
</div>
<div class="justify docutils container">
<p>To to so, two separate <em>fix addforce</em> are used:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">group </span><span class="nv nv-Identifier">t1</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">1</span>
<span class="k">variable </span><span class="nv nv-Identifier">U1</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="nv">${U0}</span><span class="o">*</span><span class="n">atan</span><span class="nv">((x+${x0})/${dlt})</span><span class="o">-</span><span class="nv">${U0}</span><span class="o">*</span><span class="n">atan</span><span class="nv">((x-${x0})/${dlt})</span>
<span class="k">variable </span><span class="nv nv-Identifier">F1</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="nv">${U0}</span><span class="o">/</span><span class="nv">((x-${x0})^2/${dlt}^2+1)</span><span class="o">/</span><span class="nv">${dlt}</span><span class="o">-</span><span class="nv">${U0}</span><span class="o">/</span><span class="nv">((x+${x0})^2/${dlt}^2+1)</span><span class="o">/</span><span class="nv">${dlt}</span>
<span class="k">fix </span><span class="nv nv-Identifier">myadf1</span><span class="w"> </span><span class="nv nv-Identifier">t1</span><span class="w"> </span><span class="n">addforce</span><span class="w"> </span><span class="n">v_F1</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="n">energy</span><span class="w"> </span><span class="n">v_U1</span>
<span class="k">fix_modify </span><span class="nv nv-Identifier">myadf1</span><span class="w"> </span><span class="n">energy</span><span class="w"> </span><span class="n">yes</span>

<span class="k">group </span><span class="nv nv-Identifier">t2</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">2</span>
<span class="k">variable </span><span class="nv nv-Identifier">U2</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="o">-</span><span class="nv">${U0}</span><span class="o">*</span><span class="n">atan</span><span class="nv">((x+${x0})/${dlt})</span><span class="o">+</span><span class="nv">${U0}</span><span class="o">*</span><span class="n">atan</span><span class="nv">((x-${x0})/${dlt})</span>
<span class="k">variable </span><span class="nv nv-Identifier">F2</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="o">-</span><span class="nv">${U0}</span><span class="o">/</span><span class="nv">((x-${x0})^2/${dlt}^2+1)</span><span class="o">/</span><span class="nv">${dlt}</span><span class="o">+</span><span class="nv">${U0}</span><span class="o">/</span><span class="nv">((x+${x0})^2/${dlt}^2+1)</span><span class="o">/</span><span class="nv">${dlt}</span>
<span class="k">fix </span><span class="nv nv-Identifier">myadf2</span><span class="w"> </span><span class="nv nv-Identifier">t2</span><span class="w"> </span><span class="n">addforce</span><span class="w"> </span><span class="n">v_F2</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="n">energy</span><span class="w"> </span><span class="n">v_U2</span>
<span class="k">fix_modify </span><span class="nv nv-Identifier">myadf2</span><span class="w"> </span><span class="n">energy</span><span class="w"> </span><span class="n">yes</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>60 particles of each type are created, with both types having
the exact same properties:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">mass</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="m">39.95</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nv">${epsilon}</span><span class="w"> </span><span class="nv">${sigma}</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Feel free to insert some size or mass asymmetry in the mixture, and test how/if
it impacts the final potential.</p>
</div>
</section>
<section id="particles-under-convection">
<h3>Particles under convection<a class="headerlink" href="#particles-under-convection" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>Add a forcing to all the particles using:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">myconv</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">addforce</span><span class="w"> </span><span class="m">2e-6</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>It is crutial to choose a forcing that is not <em>too large</em>, or the simulation may crash.
A forcing that is <em>too weak</em> wont have any effect on the PMF.</p>
</div>
<div class="justify docutils container">
<p>One can see from the result that the measured potential
is tilted, which is a consequence of the additional force that makes it easier for
the particles to cross the potential in one of the direction. The barrer is also
reduced compared to the case in absence of additional forcing.</p>
</div>
</section>
<section id="surface-adsorption-of-a-molecule">
<h3>Surface adsorption of a molecule<a class="headerlink" href="#surface-adsorption-of-a-molecule" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>You can download the <a href="../../../../inputs/level3/free-energy-calculation/Exercises/MoleculeAdsorption/input.lammps" target="_blank">input</a> here.</p>
</div>
</section>
</section>
<section id="reactive-silicon-dioxide">
<h2>Reactive silicon dioxide<a class="headerlink" href="#reactive-silicon-dioxide" title="Link to this heading">#</a></h2>
<section id="add-o2-molecules">
<h3>Add O2 molecules<a class="headerlink" href="#add-o2-molecules" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>In a separate folder, create a new input file,
and copy the same first lines as previously in it
(just adapt the path to <em>silica-deformed.data</em> accordingly):</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">units</span><span class="w"> </span><span class="n">real</span>
<span class="k">atom_style</span><span class="w"> </span><span class="n">full</span>

<span class="k">read_data</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">..</span><span class="o">/</span><span class="n">Deform</span><span class="o">/</span><span class="n">silica</span><span class="o">-</span><span class="n">deformed.data</span>

<span class="k">mass</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">28.0855</span><span class="w"> </span><span class="c"># Si</span>
<span class="k">mass</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">15.999</span><span class="w"> </span><span class="c"># O</span>

<span class="k">pair_style</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">safezone</span><span class="w"> </span><span class="m">3.0</span><span class="w"> </span><span class="n">mincap</span><span class="w"> </span><span class="m">150</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">RelaxSilica</span><span class="o">/</span><span class="n">reaxCHOFe.ff</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span>
<span class="k">fix </span><span class="nv nv-Identifier">myqeq</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">qeq</span><span class="o">/</span><span class="n">reaxff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">10.0</span><span class="w"> </span><span class="m">1.0e-6</span><span class="w"> </span><span class="n">reaxff</span><span class="w"> </span><span class="n">maxiter</span><span class="w"> </span><span class="m">400</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Optionally, let us shift the structure to recenter it in the box. The best value
for the shift may be different in your case. This step is not necessary, but the
recentered system looks better.</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">displace_atoms </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">move</span><span class="w"> </span><span class="o">-</span><span class="m">13</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">units</span><span class="w"> </span><span class="n">box</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Then, let us import the molecule template <em>O2.mol</em> and create 10 molecules.
The overlap and maxtry keywords allow us to prevent overlapping
between the atoms:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">molecule</span><span class="w"> </span><span class="n">O2mol</span><span class="w"> </span><span class="n">O2.mol</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">456415</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">mol</span><span class="w"> </span><span class="n">O2mol</span><span class="w"> </span><span class="m">454756</span><span class="w"> </span><span class="n">overlap</span><span class="w"> </span><span class="m">3.0</span><span class="w"> </span><span class="n">maxtry</span><span class="w"> </span><span class="m">50</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>The value of 3 Angstroms for the minimum interatomic overlapping is
very safe for the present system. Smaller values may lead to molecules being
too close from each others.</p>
</div>
<div class="justify docutils container">
<p>Finally, let us minimize the energy of the system, and run for <span class="math notranslate nohighlight">\(10\,\text{ps}\)</span>:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">minimize</span><span class="w"> </span><span class="m">1.0e-4</span><span class="w"> </span><span class="m">1.0e-6</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="m">1000</span>
<span class="k">reset_timestep</span><span class="w"> </span><span class="m">0</span>

<span class="k">group </span><span class="nv nv-Identifier">grpSi</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">1</span>
<span class="k">group </span><span class="nv nv-Identifier">grpO</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="m">2</span>
<span class="k">variable </span><span class="nv nv-Identifier">totqSi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpSi)</span>
<span class="k">variable </span><span class="nv nv-Identifier">totqO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">charge</span><span class="nv">(grpO)</span>
<span class="k">variable </span><span class="nv nv-Identifier">nSi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">count</span><span class="nv">(grpSi)</span>
<span class="k">variable </span><span class="nv nv-Identifier">nO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">count</span><span class="nv">(grpO)</span>
<span class="k">variable </span><span class="nv nv-Identifier">qSi</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">v_totqSi</span><span class="o">/</span><span class="nv">${nSi}</span>
<span class="k">variable </span><span class="nv nv-Identifier">qO</span><span class="w"> </span><span class="n">equal</span><span class="w"> </span><span class="n">v_totqO</span><span class="o">/</span><span class="nv">${nO}</span>

<span class="k">dump </span><span class="nv nv-Identifier">dmp</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="m">100</span><span class="w"> </span><span class="n">dump.lammpstrj</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="n">z</span>
<span class="k">thermo</span><span class="w"> </span><span class="m">5</span>
<span class="k">thermo_style</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">step</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">etotal</span><span class="w"> </span><span class="n">press</span><span class="w"> </span><span class="n">vol</span><span class="w"> </span><span class="n">v_qSi</span><span class="w"> </span><span class="n">v_qO</span>
<span class="k">fix </span><span class="nv nv-Identifier">myspec</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">reaxff</span><span class="o">/</span><span class="n">species</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="n">species.log</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span>

<span class="k">fix </span><span class="nv nv-Identifier">mynvt</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nvt</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">300.0</span><span class="w"> </span><span class="m">100</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.5</span>

<span class="k">run</span><span class="w"> </span><span class="m">20000</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>You can vizualise the <span class="math notranslate nohighlight">\(\text{O}_2\)</span> molecules with VMD, or have a look at the
<em>species.log</em> file:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c">#  Timestep    No_Moles    No_Specs   Si192O384          O2</span>
<span class="w">          </span><span class="m">5</span><span class="w">          </span><span class="m">11</span><span class="w">           </span><span class="m">2</span><span class="w">           </span><span class="m">1</span><span class="w">          </span><span class="m">10</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>One can see that some reactions occur in the system, and
that eventually some of
the <span class="math notranslate nohighlight">\(\text{O}_2\)</span> molecules react and reabsorb on the
main structure:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c">#  Timestep    No_Moles    No_Specs   Si192O388          O2</span>
<span class="w">      </span><span class="m">20000</span><span class="w">           </span><span class="m">9</span><span class="w">           </span><span class="m">2</span><span class="w">           </span><span class="m">1</span><span class="w">           </span><span class="m">8</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="Silicon oxide with additional O2 molecules" class="only-light" src="../_images/O2_light.png" />
</figure>
<figure class="align-default">
<img alt="Silicon oxide with additional O2 molecules" class="only-dark" src="../_images/O2_dark.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Deformed structure with some <span class="math notranslate nohighlight">\(\text{O}_2\)</span> molecules</p>
</div>
</section>
<section id="decorate-dandling-oxygens">
<h3>Decorate dandling oxygens<a class="headerlink" href="#decorate-dandling-oxygens" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>Space must be made for the hydrogen atoms. Modify the <em>silica-deformed.data</em> file
so that it starts with:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="m">576</span><span class="w"> </span><span class="n">atoms</span>
<span class="m">3</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="n">types</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Also add the mass of the hydrogen:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="n">Masses</span>

<span class="m">1</span><span class="w"> </span><span class="m">28.0855</span>
<span class="m">2</span><span class="w"> </span><span class="m">15.999</span>
<span class="m">3</span><span class="w"> </span><span class="m">1.008</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>It is also important to change the <em>pair_coeff</em>:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">pair_coeff</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">..</span><span class="o">/</span><span class="n">..</span><span class="o">/</span><span class="n">RelaxSilica</span><span class="o">/</span><span class="n">reaxCHOFe.ff</span><span class="w"> </span><span class="n">Si</span><span class="w"> </span><span class="n">O</span><span class="w"> </span><span class="n">H</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>One can create randomly a few hydrogen atoms:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">create_atoms</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">456415</span><span class="w"> </span><span class="n">NULL</span><span class="w"> </span><span class="n">overlap</span><span class="w"> </span><span class="m">3.0</span><span class="w"> </span><span class="n">maxtry</span><span class="w"> </span><span class="m">50</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Equilibrate the system, you should see the hydrogen atoms
progressively decorating the surface of the SiO2 structure:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c">#  Timestep    No_Moles    No_Specs    Si192O384        H</span>
<span class="w">          </span><span class="m">5</span><span class="w">          </span><span class="m">11</span><span class="w">           </span><span class="m">2</span><span class="w">            </span><span class="m">1</span><span class="w">       </span><span class="m">10</span>
<span class="nv">(...)</span>
<span class="c">#  Timestep    No_Moles    No_Specs Si192O384H10</span>
<span class="w">       </span><span class="m">5000</span><span class="w">           </span><span class="m">1</span><span class="w">           </span><span class="m">1</span><span class="w">            </span><span class="m">1</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="Silicon oxide decorated with hydrogens" class="only-light" src="../_images/exercice-light.png" />
</figure>
<figure class="align-default">
<img alt="Silicon oxide decorated with hydrogens" class="only-dark" src="../_images/exercice-light.png" />
</figure>
<div class="figurelegend docutils container">
<p>Figure: Hydrogen atoms are in white, oxygen in red, and silicon in yellow.</p>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../tutorials/vmd/vmd-tutorial.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">VMD tutorial</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../tutorials/level3/free-energy-calculation.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Free energy calculation</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Solutions to the exercises</a><ul>
<li><a class="reference internal" href="#lennard-jones-fluid">Lennard Jones fluid</a><ul>
<li><a class="reference internal" href="#fix-a-broken-input">Fix a broken input</a></li>
<li><a class="reference internal" href="#create-a-demixed-dense-phase">Create a demixed dense phase</a></li>
<li><a class="reference internal" href="#create-dumbbell-molecules">Create dumbbell molecules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pulling-on-a-carbon-nanotube">Pulling on a carbon nanotube</a><ul>
<li><a class="reference internal" href="#plot-the-strain-stress-curves">Plot the strain-stress curves</a></li>
<li><a class="reference internal" href="#deform-a-cnt-membrane">Deform a CNT membrane</a></li>
</ul>
</li>
<li><a class="reference internal" href="#polymer-in-water">Polymer in water</a><ul>
<li><a class="reference internal" href="#extract-radial-distribution-function">Extract radial distribution function</a></li>
<li><a class="reference internal" href="#add-salt-to-the-mixture">Add salt to the mixture</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nanosheared-electrolyte">Nanosheared electrolyte</a><ul>
<li><a class="reference internal" href="#make-a-hydrophobic-nanopore">Make a hydrophobic nanopore</a></li>
<li><a class="reference internal" href="#induce-a-poiseuille-flow">Induce a Poiseuille flow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#water-adsorption-in-silica">Water adsorption in silica</a><ul>
<li><a class="reference internal" href="#mixture-adsorption">Mixture adsorption</a></li>
<li><a class="reference internal" href="#adsorb-water-in-zif-8-nanopores">Adsorb water in ZIF-8 nanopores</a></li>
</ul>
</li>
<li><a class="reference internal" href="#free-energy-calculation">Free energy calculation</a><ul>
<li><a class="reference internal" href="#the-binary-fluid-that-wont-mix">The binary fluid that wont mix</a></li>
<li><a class="reference internal" href="#particles-under-convection">Particles under convection</a></li>
<li><a class="reference internal" href="#surface-adsorption-of-a-molecule">Surface adsorption of a molecule</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reactive-silicon-dioxide">Reactive silicon dioxide</a><ul>
<li><a class="reference internal" href="#add-o2-molecules">Add O2 molecules</a></li>
<li><a class="reference internal" href="#decorate-dandling-oxygens">Decorate dandling oxygens</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>