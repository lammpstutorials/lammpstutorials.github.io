<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-W1WGEC5GQ8"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-W1WGEC5GQ8');
    </script>
        <link href="../_static/favicon-32x32.png" sizes="32x32" rel="icon" type="image/png"><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Make gorgeous image" href="../miscellaneous/make-gorgeous-image.html" /><link rel="prev" title="Reactive silicon dioxide" href="../tutorials/level3/reactive-silicon-dioxide.html" />

    <!-- Generated with Sphinx 7.2.6 and Furo 2023.09.10 -->
        <title>Solutions to the exercises - </title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=3ceca25e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">    </div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">    </span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../miscellaneous/before-you-start.html">Before you start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../miscellaneous/site-walkthrough.html">Site walkthrough</a></li>
<li class="toctree-l1"><a class="reference internal" href="../miscellaneous/contact-me.html">Contact me</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 0</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/level0/lennard-jones-fluid.html">Lennard Jones fluid</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 1</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/level1/breaking-a-carbon-nanotube.html">Pulling on a carbon nanotube</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 2</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/level2/polymer-in-water.html">Polymer in water</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/level2/nanosheared-electrolyte.html">Nanosheared electrolyte</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Level 3</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/level3/water-adsorption-in-silica.html">Water adsorption in silica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/level3/free-energy-calculation.html">Free energy calculation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/level3/reactive-silicon-dioxide.html">Reactive silicon dioxide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extra content</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Solutions to the exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../miscellaneous/make-gorgeous-image.html">Make gorgeous image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../miscellaneous/use-gromacs-instead.html">Use GROMACS instead</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="solutions-to-the-exercises">
<span id="solutions-label"></span><h1>Solutions to the exercises<a class="headerlink" href="#solutions-to-the-exercises" title="Link to this heading">#</a></h1>
<section id="lennard-jones-fluid">
<h2>Lennard Jones fluid<a class="headerlink" href="#lennard-jones-fluid" title="Link to this heading">#</a></h2>
<section id="fix-a-broken-input">
<h3>Fix a broken input<a class="headerlink" href="#fix-a-broken-input" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>You can download the <a href="../../../../inputs/level0/lennard-jones-fluid/exercises/broken/input.lammps" target="_blank">input</a> I wrote.
The key to make the simulation starts, is to initially
reduce the <em>timestep</em>, as well as the imposed <em>temperature</em>.
Note that in order to make sure that the temperature of the particles
quickly reaches a low value before the simulation crashes, I also reduced
the <em>damping</em> parameter of the <em>Langevin</em> command:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">mylgv</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">langevin</span><span class="w"> </span><span class="m">0.001</span><span class="w"> </span><span class="m">0.001</span><span class="w"> </span><span class="m">0.001</span><span class="w"> </span><span class="m">1530917</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.0001</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Then, after the first <em>run</em> finishes, the energy of the system
has reduced due to the motion of the atoms, and a second <em>run</em>
with the original <em>timestep</em> and <em>Langevin</em> parameters can start
without issue.</p>
</div>
<div class="justify docutils container">
<p>In some case, several consecutive steps can be necessary:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">mylgv</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">langevin</span><span class="w"> </span><span class="m">0.0001</span><span class="w"> </span><span class="m">0.0001</span><span class="w"> </span><span class="m">0.001</span><span class="w"> </span><span class="m">1530917</span>
<span class="k">timestep</span><span class="w"> </span><span class="m">0.0001</span>
<span class="k">run</span><span class="w"> </span><span class="m">10000</span>

<span class="k">timestep</span><span class="w"> </span><span class="m">0.001</span>
<span class="k">run</span><span class="w"> </span><span class="m">10000</span>

<span class="k">timestep</span><span class="w"> </span><span class="m">0.01</span>
<span class="k">run</span><span class="w"> </span><span class="m">10000</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Use trial and error to determine the best approach for
a given system.</p>
</div>
</section>
<section id="create-a-demixed-dense-phase">
<h3>Create a demixed dense phase<a class="headerlink" href="#create-a-demixed-dense-phase" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>You can download the <a href="../../../../inputs/level0/lennard-jones-fluid/exercises/demixion/input.lammps" target="_blank">input</a> I wrote. Note that
I use a large number of particles: 8000 for each type. Then,
the key to create a demixing phase is to play with the Lennard-Jones
parameters:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">pair_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5.0</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5.0</span><span class="w"> </span><span class="m">1.0</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">0.05</span><span class="w"> </span><span class="m">1.0</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>First, notice that both particle types have the same <span class="math notranslate nohighlight">\(\sigma\)</span> value of 1.0
so that both particles have the same diameter. Second, note the large energy parameter <span class="math notranslate nohighlight">\(\epsilon = 5.0\)</span>
for self interaction (i.e.) interaction between particles of same type, and the low
energy parameter <span class="math notranslate nohighlight">\(\epsilon = 0.05\)</span> for interaction between particles of different types.</p>
</div>
<div class="justify docutils container">
<p>Finally, for adjusting the box volume and create a liquid looking phase, the
pressure was imposed by replacing <em>fix nve</em> by <em>fix nph</em>:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">mynph</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nph</span><span class="w"> </span><span class="n">iso</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">1.0</span><span class="w"> </span><span class="m">1.0</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>With <em>fix nph</em> and a pressure of 1, LAMMPS adjusts the box dimension until the
pressure is close to 1, which is require reducing the initial box dimensions.</p>
</div>
</section>
<section id="create-dumbbell-molecules">
<h3>Create dumbbell molecules<a class="headerlink" href="#create-dumbbell-molecules" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>You can download the <a href="../../../../inputs/level0/lennard-jones-fluid/exercises/dumbbell/input.lammps" target="_blank">input</a> I wrote. The first important
change is to choose an <em>atom_style</em> that allows for bond creation, and
to specify the <em>bond_style</em>:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">atom_style</span><span class="w"> </span><span class="n">molecular</span>
<span class="k">bond_style</span><span class="w"> </span><span class="n">harmonic</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>When creating the box, it is important to make space in the memory for
the bonds:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">create_box </span><span class="nv nv-Identifier">2</span><span class="w"> </span><span class="nv nv-Identifier">simulation_box</span><span class="w"> </span><span class="n">bond</span><span class="o">/</span><span class="n">types</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="n">extra</span><span class="o">/</span><span class="n">bond</span><span class="o">/</span><span class="n">per</span><span class="o">/</span><span class="n">atom</span><span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Then, import the <em>molecule templates</em>, and use these templates
when creating the atoms:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">molecule</span><span class="w"> </span><span class="n">dumbell1</span><span class="w"> </span><span class="n">dumbell1.mol</span>
<span class="k">molecule</span><span class="w"> </span><span class="n">dumbell2</span><span class="w"> </span><span class="n">dumbell2.mol</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">750</span><span class="w"> </span><span class="m">341341</span><span class="w"> </span><span class="n">simulation_box</span><span class="w"> </span><span class="n">mol</span><span class="w"> </span><span class="n">dumbell1</span><span class="w"> </span><span class="m">8766</span>
<span class="k">create_atoms</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">random</span><span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="m">678865</span><span class="w"> </span><span class="n">simulation_box</span><span class="w"> </span><span class="n">mol</span><span class="w"> </span><span class="n">dumbell2</span><span class="w"> </span><span class="m">8751</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>You can download the molecule templates for <a href="../../../../inputs/level0/lennard-jones-fluid/exercises/dumbbell/dumbell1.mol" target="_blank">type-1</a>
and <a href="../../../../inputs/level0/lennard-jones-fluid/exercises/dumbbell/dumbell2.mol" target="_blank">type-2</a>. Finally, some parameters for the two
types of bonds, namely their rigidity and equilibrium lengths is specified:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">bond_coeff</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">0.5</span>
<span class="k">bond_coeff</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="m">5</span><span class="w"> </span><span class="m">1.5</span>
</pre></div>
</div>
</section>
</section>
<section id="pulling-on-a-carbon-nanotube">
<h2>Pulling on a carbon nanotube<a class="headerlink" href="#pulling-on-a-carbon-nanotube" title="Link to this heading">#</a></h2>
<section id="plot-the-strain-stress-curves">
<h3>Plot the strain-stress curves<a class="headerlink" href="#plot-the-strain-stress-curves" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>You can download the <a href="../../../../inputs/level1/breaking-a-carbon-nanotube/exercises/stress-strain/breakable-bonds/input.lammps" target="_blank">input</a>
and <a href="../../../../inputs/level1/breaking-a-carbon-nanotube/exercises/stress-strain/unbreakable-bonds/input.lammps" target="_blank">input</a> I wrote.</p>
</div>
<div class="justify docutils container">
<p>The main difficulty here is to calculate the stress. Here,
the stress is calculated as the force divided by the
surface area of the CNT. Note that the surface area
of a CNT is not a well defined quantity. I choose to
define the area as the perimeter of the CNT multiplied by the
effective width of the carbon atoms.</p>
</div>
<div class="justify docutils container">
<p>Be careful with units, as the force is either in kCal/mol
or eV, depending of the unit system, respectively <em>real</em> or <em>metal</em>.</p>
</div>
</section>
<section id="deform-a-cnt-membrane">
<h3>Deform a CNT membrane<a class="headerlink" href="#deform-a-cnt-membrane" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>You can download the <a href="../../../../inputs/level1/breaking-a-carbon-nanotube/exercises/membrane/input.lammps" target="_blank">input</a> I wrote.
The CNT can be replicated using the <em>replicate</em> command.
Then, it is important to change the box to triclinic:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">change_box </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">triclinic</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Before deforming the system using:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">muyef</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">deform</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">xy</span><span class="w"> </span><span class="n">erate</span><span class="w"> </span><span class="m">5e-5</span>
</pre></div>
</div>
</section>
</section>
<section id="polymer-in-water">
<h2>Polymer in water<a class="headerlink" href="#polymer-in-water" title="Link to this heading">#</a></h2>
<section id="extract-radial-distribution-function">
<h3>Extract radial distribution function<a class="headerlink" href="#extract-radial-distribution-function" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>You can download the <a href="../../../../inputs/level2/polymer-in-water/exercises/radial-distribution-function/input.lammps" target="_blank">input</a> file I wrote. I use
the <em>compute rdf</em> command of LAMMPS. I define two different <em>compute</em>,
one for the H2O-H2O RDF, and another one for the H2O-PEG RDF:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="c"># H2O (type 1) - H2O (type 1)</span>
<span class="k">compute </span><span class="nv nv-Identifier">myRDF_H2O_H2O</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">rdf</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="m">10</span>
<span class="k">fix </span><span class="nv nv-Identifier">myat1</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">time</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20000</span><span class="w"> </span><span class="m">200000</span><span class="w"> </span><span class="n">c_myRDF_H2O_H2O[</span><span class="o">*</span><span class="n">]</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">H2O</span><span class="o">-</span><span class="n">H2O.dat</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">vector</span>

<span class="c"># PEG (type 3, 4, and 6) - H2O (type 1)</span>
<span class="k">compute </span><span class="nv nv-Identifier">myRDF_PEG_H2O</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">rdf</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">4</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">cutoff</span><span class="w"> </span><span class="m">10</span>
<span class="k">fix </span><span class="nv nv-Identifier">myat2</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">ave</span><span class="o">/</span><span class="n">time</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">20000</span><span class="w"> </span><span class="m">200000</span><span class="w"> </span><span class="n">c_myRDF_PEG_H2O[</span><span class="o">*</span><span class="n">]</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="n">PEG</span><span class="o">-</span><span class="n">H2O.dat</span><span class="w"> </span><span class="n">mode</span><span class="w"> </span><span class="n">vector</span>
</pre></div>
</div>
</section>
<section id="add-salt-to-the-mixture">
<h3>Add salt to the mixture<a class="headerlink" href="#add-salt-to-the-mixture" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>You can download the <a href="../../../../inputs/level2/polymer-in-water/exercises/salt/input.lammps" target="_blank">input</a>,
<a href="../../../../inputs/level2/polymer-in-water/exercises/salt/mix-with-salt.data" target="_blank">data</a>,
and <a href="../../../../inputs/level2/polymer-in-water/exercises/salt/PARM-with-salt.lammps" target="_blank">parm</a> files I wrote. It is important to
make space for the salt by modifying the data file as follow:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="nv">(...)</span>
<span class="m">9</span><span class="w"> </span><span class="n">atom</span><span class="w"> </span><span class="n">types</span>
<span class="nv">(...)</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Additional <em>mass</em> and <em>pair_coeff</em> lines
must be added to the parm file (be careful to use the
appropriate units):</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="nv">(...)</span>
<span class="k">mass</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">22.98</span><span class="w"> </span><span class="c"># Na</span>
<span class="k">mass</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="m">35.453</span><span class="w"> </span><span class="c"># Cl</span>
<span class="nv">(...)</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="m">0.04690</span><span class="w"> </span><span class="m">2.43</span><span class="w"> </span><span class="c"># Na</span>
<span class="k">pair_coeff</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="m">9</span><span class="w"> </span><span class="m">0.1500</span><span class="w"> </span><span class="m">4.045</span>
<span class="nv">(...)</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Finally, here I choose to add the ions using two separate
<em>create_atoms</em> commands with a very small <em>overlap</em>
values, followed by an energy minimization.</p>
</div>
</section>
</section>
<section id="nanosheared-electrolyte">
<h2>Nanosheared electrolyte<a class="headerlink" href="#nanosheared-electrolyte" title="Link to this heading">#</a></h2>
<section id="induce-a-poiseuille-flow">
<h3>Induce a Poiseuille flow<a class="headerlink" href="#induce-a-poiseuille-flow" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>On important aspect of out-of-equilibrium simulations is that
the forcing must be chosen with care. If too
large, the system will be strongly out-of-equilibrium. If
too small, no net velocity will be measured because of
the thermal noise.</p>
</div>
<div class="justify docutils container">
<p>For the dynamics of the system, I use:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">mynve</span><span class="w"> </span><span class="nv nv-Identifier">all</span><span class="w"> </span><span class="n">nve</span>
<span class="k">compute </span><span class="nv nv-Identifier">tliq</span><span class="w"> </span><span class="nv nv-Identifier">gliquid</span><span class="w"> </span><span class="n">temp</span><span class="o">/</span><span class="n">partial</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="c"># ignore the x direction during thermalisation</span>
<span class="k">fix </span><span class="nv nv-Identifier">myber1</span><span class="w"> </span><span class="nv nv-Identifier">gliquid</span><span class="w"> </span><span class="n">temp</span><span class="o">/</span><span class="n">berendsen</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">100</span>
<span class="k">fix_modify </span><span class="nv nv-Identifier">myber1</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">tliq</span>
<span class="k">compute </span><span class="nv nv-Identifier">twall</span><span class="w"> </span><span class="nv nv-Identifier">gwall</span><span class="w"> </span><span class="n">temp</span>
<span class="k">fix </span><span class="nv nv-Identifier">myber2</span><span class="w"> </span><span class="nv nv-Identifier">gwall</span><span class="w"> </span><span class="n">temp</span><span class="o">/</span><span class="n">berendsen</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">300</span><span class="w"> </span><span class="m">100</span>
<span class="k">fix_modify </span><span class="nv nv-Identifier">myber2</span><span class="w"> </span><span class="n">temp</span><span class="w"> </span><span class="n">twall</span>
<span class="k">fix </span><span class="nv nv-Identifier">myshk</span><span class="w"> </span><span class="nv nv-Identifier">gH2O</span><span class="w"> </span><span class="n">shake</span><span class="w"> </span><span class="m">1.0e-4</span><span class="w"> </span><span class="m">200</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="m">1</span>
<span class="k">fix </span><span class="nv nv-Identifier">myspring1</span><span class="w"> </span><span class="nv nv-Identifier">gwalltop</span><span class="w"> </span><span class="n">spring</span><span class="o">/</span><span class="n">self</span><span class="w"> </span><span class="m">10.0</span><span class="w"> </span><span class="n">xyz</span><span class="w"> </span><span class="c"># maintain top wall in place</span>
<span class="k">fix </span><span class="nv nv-Identifier">myspring2</span><span class="w"> </span><span class="nv nv-Identifier">gwallbot</span><span class="w"> </span><span class="n">spring</span><span class="o">/</span><span class="n">self</span><span class="w"> </span><span class="m">10.0</span><span class="w"> </span><span class="n">xyz</span><span class="w"> </span><span class="c"># maintain bottom wall in place</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Note that here, walls wont move and they can be thermalized in all 3 directions.
Also, there is no need for recentering as the walls are fixed here.
To add the force to the fluid:</p>
</div>
<div class="highlight-lammps notranslate"><div class="highlight"><pre><span></span><span class="k">fix </span><span class="nv nv-Identifier">myadf</span><span class="w"> </span><span class="nv nv-Identifier">gliquid</span><span class="w"> </span><span class="n">addforce</span><span class="w"> </span><span class="m">1e-3</span><span class="w"> </span><span class="m">0.0</span><span class="w"> </span><span class="m">0.0</span>
</pre></div>
</div>
<div class="justify docutils container">
<p>Here, the force value of <span class="math notranslate nohighlight">\(0.001\,\text{kcal/mol/A}\)</span> is a reasonable choice
that has been calibrated previously. To calibrate it, you can test
several values for the force, and eventually choose a value that
small enough so that the linear response remains
valid, and large enough so that you can differentiate
the signal from the noise.</p>
</div>
</section>
<section id="coming-soon">
<h3>Coming soon<a class="headerlink" href="#coming-soon" title="Link to this heading">#</a></h3>
<div class="justify docutils container">
<p>This page is currently being written, all solutions will appear here eventually.</p>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../miscellaneous/make-gorgeous-image.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Make gorgeous image</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../tutorials/level3/reactive-silicon-dioxide.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Reactive silicon dioxide</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Solutions to the exercises</a><ul>
<li><a class="reference internal" href="#lennard-jones-fluid">Lennard Jones fluid</a><ul>
<li><a class="reference internal" href="#fix-a-broken-input">Fix a broken input</a></li>
<li><a class="reference internal" href="#create-a-demixed-dense-phase">Create a demixed dense phase</a></li>
<li><a class="reference internal" href="#create-dumbbell-molecules">Create dumbbell molecules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pulling-on-a-carbon-nanotube">Pulling on a carbon nanotube</a><ul>
<li><a class="reference internal" href="#plot-the-strain-stress-curves">Plot the strain-stress curves</a></li>
<li><a class="reference internal" href="#deform-a-cnt-membrane">Deform a CNT membrane</a></li>
</ul>
</li>
<li><a class="reference internal" href="#polymer-in-water">Polymer in water</a><ul>
<li><a class="reference internal" href="#extract-radial-distribution-function">Extract radial distribution function</a></li>
<li><a class="reference internal" href="#add-salt-to-the-mixture">Add salt to the mixture</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nanosheared-electrolyte">Nanosheared electrolyte</a><ul>
<li><a class="reference internal" href="#induce-a-poiseuille-flow">Induce a Poiseuille flow</a></li>
<li><a class="reference internal" href="#coming-soon">Coming soon</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>